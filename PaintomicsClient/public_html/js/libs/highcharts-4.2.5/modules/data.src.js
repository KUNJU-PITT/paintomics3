/**
 * @license Highcharts JS v4.2.5 (2016-05-06)
 * Data module
 *
 * (c) 2012-2016 Torstein Honsi
 *
 * License: www.highcharts.com/license
 */
(function(factory){if(typeof module==="object"&&module.exports){module.exports=factory}else{factory(Highcharts)}})(function(Highcharts){var win=Highcharts.win,doc=win.document,each=Highcharts.each,pick=Highcharts.pick,inArray=Highcharts.inArray,isNumber=Highcharts.isNumber,splat=Highcharts.splat,SeriesBuilder;var Data=function(dataOptions,chartOptions){this.init(dataOptions,chartOptions)};Highcharts.extend(Data.prototype,{init:function(options,chartOptions){this.options=options;this.chartOptions=chartOptions;this.columns=options.columns||this.rowsToColumns(options.rows)||[];this.firstRowAsNames=pick(options.firstRowAsNames,true);this.decimalRegex=options.decimalPoint&&new RegExp("^(-?[0-9]+)"+options.decimalPoint+"([0-9]+)$");this.rawColumns=[];if(this.columns.length){this.dataFound()}else{this.parseCSV();this.parseTable();this.parseGoogleSpreadsheet()}},getColumnDistribution:function(){var chartOptions=this.chartOptions,options=this.options,xColumns=[],getValueCount=function(type){return(Highcharts.seriesTypes[type||"line"].prototype.pointArrayMap||[0]).length},getPointArrayMap=function(type){return Highcharts.seriesTypes[type||"line"].prototype.pointArrayMap},globalType=chartOptions&&chartOptions.chart&&chartOptions.chart.type,individualCounts=[],seriesBuilders=[],seriesIndex=0,i;each(chartOptions&&chartOptions.series||[],function(series){individualCounts.push(getValueCount(series.type||globalType))});each(options&&options.seriesMapping||[],function(mapping){xColumns.push(mapping.x||0)});if(xColumns.length===0){xColumns.push(0)}each(options&&options.seriesMapping||[],function(mapping){var builder=new SeriesBuilder,name,numberOfValueColumnsNeeded=individualCounts[seriesIndex]||getValueCount(globalType),seriesArr=chartOptions&&chartOptions.series||[],series=seriesArr[seriesIndex]||{},pointArrayMap=getPointArrayMap(series.type||globalType)||["y"];builder.addColumnReader(mapping.x,"x");for(name in mapping){if(mapping.hasOwnProperty(name)&&name!=="x"){builder.addColumnReader(mapping[name],name)}}for(i=0;i<numberOfValueColumnsNeeded;i++){if(!builder.hasReader(pointArrayMap[i])){builder.addColumnReader(undefined,pointArrayMap[i])}}seriesBuilders.push(builder);seriesIndex++});var globalPointArrayMap=getPointArrayMap(globalType);if(globalPointArrayMap===undefined){globalPointArrayMap=["y"]}this.valueCount={global:getValueCount(globalType),xColumns:xColumns,individual:individualCounts,seriesBuilders:seriesBuilders,globalPointArrayMap:globalPointArrayMap}},dataFound:function(){if(this.options.switchRowsAndColumns){this.columns=this.rowsToColumns(this.columns)}this.getColumnDistribution();this.parseTypes();if(this.parsed()!==false){this.complete()}},parseCSV:function(){var self=this,options=this.options,csv=options.csv,columns=this.columns,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE,itemDelimiter,lines,activeRowNo=0;if(csv){lines=csv.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(options.lineDelimiter||"\n");itemDelimiter=options.itemDelimiter||(csv.indexOf("\t")!==-1?"\t":",");each(lines,function(line,rowNo){var trimmed=self.trim(line),isComment=trimmed.indexOf("#")===0,isBlank=trimmed==="",items;if(rowNo>=startRow&&rowNo<=endRow&&!isComment&&!isBlank){items=line.split(itemDelimiter);each(items,function(item,colNo){if(colNo>=startColumn&&colNo<=endColumn){if(!columns[colNo-startColumn]){columns[colNo-startColumn]=[]}columns[colNo-startColumn][activeRowNo]=item}});activeRowNo+=1}});this.dataFound()}},parseTable:function(){var options=this.options,table=options.table,columns=this.columns,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE;if(table){if(typeof table==="string"){table=doc.getElementById(table)}each(table.getElementsByTagName("tr"),function(tr,rowNo){if(rowNo>=startRow&&rowNo<=endRow){each(tr.children,function(item,colNo){if((item.tagName==="TD"||item.tagName==="TH")&&colNo>=startColumn&&colNo<=endColumn){if(!columns[colNo-startColumn]){columns[colNo-startColumn]=[]}columns[colNo-startColumn][rowNo-startRow]=item.innerHTML}})}});this.dataFound()}},parseGoogleSpreadsheet:function(){var self=this,options=this.options,googleSpreadsheetKey=options.googleSpreadsheetKey,columns=this.columns,startRow=options.startRow||0,endRow=options.endRow||Number.MAX_VALUE,startColumn=options.startColumn||0,endColumn=options.endColumn||Number.MAX_VALUE,gr,gc;if(googleSpreadsheetKey){jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+googleSpreadsheetKey+"/"+(options.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:options.error,success:function(json){var cells=json.feed.entry,cell,cellCount=cells.length,colCount=0,rowCount=0,i;for(i=0;i<cellCount;i++){cell=cells[i];colCount=Math.max(colCount,cell.gs$cell.col);rowCount=Math.max(rowCount,cell.gs$cell.row)}for(i=0;i<colCount;i++){if(i>=startColumn&&i<=endColumn){columns[i-startColumn]=[];columns[i-startColumn].length=Math.min(rowCount,endRow-startRow)}}for(i=0;i<cellCount;i++){cell=cells[i];gr=cell.gs$cell.row-1;gc=cell.gs$cell.col-1;if(gc>=startColumn&&gc<=endColumn&&gr>=startRow&&gr<=endRow){columns[gc-startColumn][gr-startRow]=cell.content.$t}}self.dataFound()}})}},trim:function(str,inside){if(typeof str==="string"){str=str.replace(/^\s+|\s+$/g,"");if(inside&&/^[0-9\s]+$/.test(str)){str=str.replace(/\s/g,"")}if(this.decimalRegex){str=str.replace(this.decimalRegex,"$1.$2")}}return str},parseTypes:function(){var columns=this.columns,col=columns.length;while(col--){this.parseColumn(columns[col],col)}},parseColumn:function(column,col){var rawColumns=this.rawColumns,columns=this.columns,row=column.length,val,floatVal,trimVal,trimInsideVal,firstRowAsNames=this.firstRowAsNames,isXColumn=inArray(col,this.valueCount.xColumns)!==-1,dateVal,backup=[],diff,chartOptions=this.chartOptions,descending,columnTypes=this.options.columnTypes||[],columnType=columnTypes[col],forceCategory=isXColumn&&(chartOptions&&chartOptions.xAxis&&splat(chartOptions.xAxis)[0].type==="category"||columnType==="string");if(!rawColumns[col]){rawColumns[col]=[]}while(row--){val=backup[row]||column[row];trimVal=this.trim(val);trimInsideVal=this.trim(val,true);floatVal=parseFloat(trimInsideVal);if(rawColumns[col][row]===undefined){rawColumns[col][row]=trimVal}if(forceCategory||row===0&&firstRowAsNames){column[row]=trimVal}else if(+trimInsideVal===floatVal){column[row]=floatVal;if(floatVal>365*24*3600*1e3&&columnType!=="float"){column.isDatetime=true}else{column.isNumeric=true}if(column[row+1]!==undefined){descending=floatVal>column[row+1]}}else{dateVal=this.parseDate(val);if(isXColumn&&isNumber(dateVal)&&columnType!=="float"){backup[row]=val;column[row]=dateVal;column.isDatetime=true;if(column[row+1]!==undefined){diff=dateVal>column[row+1];if(diff!==descending&&descending!==undefined){if(this.alternativeFormat){this.dateFormat=this.alternativeFormat;row=column.length;this.alternativeFormat=this.dateFormats[this.dateFormat].alternative}else{column.unsorted=true}}descending=diff}}else{column[row]=trimVal===""?null:trimVal;if(row!==0&&(column.isDatetime||column.isNumeric)){column.mixed=true}}}}if(isXColumn&&column.mixed){columns[col]=rawColumns[col]}if(isXColumn&&descending&&this.options.sort){for(col=0;col<columns.length;col++){columns[col].reverse();if(firstRowAsNames){columns[col].unshift(columns[col].pop())}}}},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(match){return Date.UTC(+match[1],match[2]-1,+match[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(match){return Date.UTC(+match[3],match[2]-1,+match[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(match){return Date.UTC(+match[3],match[1]-1,+match[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(match){return Date.UTC(+match[3]+2e3,match[2]-1,+match[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(match){return Date.UTC(+match[3]+2e3,match[1]-1,+match[2])}}},parseDate:function(val){var parseDate=this.options.parseDate,ret,key,format,dateFormat=this.options.dateFormat||this.dateFormat,match;if(parseDate){ret=parseDate(val)}else if(typeof val==="string"){if(!dateFormat){for(key in this.dateFormats){format=this.dateFormats[key];match=val.match(format.regex);if(match){this.dateFormat=dateFormat=key;this.alternativeFormat=format.alternative;ret=format.parser(match);break}}}else{format=this.dateFormats[dateFormat];match=val.match(format.regex);if(match){ret=format.parser(match)}}if(!match){match=Date.parse(val);if(typeof match==="object"&&match!==null&&match.getTime){ret=match.getTime()-match.getTimezoneOffset()*6e4}else if(isNumber(match)){ret=match-new Date(match).getTimezoneOffset()*6e4}}}return ret},rowsToColumns:function(rows){var row,rowsLength,col,colsLength,columns;if(rows){columns=[];rowsLength=rows.length;for(row=0;row<rowsLength;row++){colsLength=rows[row].length;for(col=0;col<colsLength;col++){if(!columns[col]){columns[col]=[]}columns[col][row]=rows[row][col]}}}return columns},parsed:function(){if(this.options.parsed){return this.options.parsed.call(this,this.columns)}},getFreeIndexes:function(numberOfColumns,seriesBuilders){var s,i,freeIndexes=[],freeIndexValues=[],referencedIndexes;for(i=0;i<numberOfColumns;i=i+1){freeIndexes.push(true)}for(s=0;s<seriesBuilders.length;s=s+1){referencedIndexes=seriesBuilders[s].getReferencedColumnIndexes();for(i=0;i<referencedIndexes.length;i=i+1){freeIndexes[referencedIndexes[i]]=false}}for(i=0;i<freeIndexes.length;i=i+1){if(freeIndexes[i]){freeIndexValues.push(i)}}return freeIndexValues},complete:function(){var columns=this.columns,xColumns=[],type,options=this.options,series,data,i,j,r,seriesIndex,chartOptions,allSeriesBuilders=[],builder,freeIndexes,typeCol,index;xColumns.length=columns.length;if(options.complete||options.afterComplete){for(i=0;i<columns.length;i++){if(this.firstRowAsNames){columns[i].name=columns[i].shift()}}series=[];freeIndexes=this.getFreeIndexes(columns.length,this.valueCount.seriesBuilders);for(seriesIndex=0;seriesIndex<this.valueCount.seriesBuilders.length;seriesIndex++){builder=this.valueCount.seriesBuilders[seriesIndex];if(builder.populateColumns(freeIndexes)){allSeriesBuilders.push(builder)}}while(freeIndexes.length>0){builder=new SeriesBuilder;builder.addColumnReader(0,"x");index=inArray(0,freeIndexes);if(index!==-1){freeIndexes.splice(index,1)}for(i=0;i<this.valueCount.global;i++){builder.addColumnReader(undefined,this.valueCount.globalPointArrayMap[i])}if(builder.populateColumns(freeIndexes)){allSeriesBuilders.push(builder)}}if(allSeriesBuilders.length>0&&allSeriesBuilders[0].readers.length>0){typeCol=columns[allSeriesBuilders[0].readers[0].columnIndex];if(typeCol!==undefined){if(typeCol.isDatetime){type="datetime"}else if(!typeCol.isNumeric){type="category"}}}if(type==="category"){for(seriesIndex=0;seriesIndex<allSeriesBuilders.length;seriesIndex++){builder=allSeriesBuilders[seriesIndex];for(r=0;r<builder.readers.length;r++){if(builder.readers[r].configName==="x"){builder.readers[r].configName="name"}}}}for(seriesIndex=0;seriesIndex<allSeriesBuilders.length;seriesIndex++){builder=allSeriesBuilders[seriesIndex];data=[];for(j=0;j<columns[0].length;j++){data[j]=builder.read(columns,j)}series[seriesIndex]={data:data};if(builder.name){series[seriesIndex].name=builder.name}if(type==="category"){series[seriesIndex].turboThreshold=0}}chartOptions={series:series};if(type){chartOptions.xAxis={type:type}}if(options.complete){options.complete(chartOptions)}if(options.afterComplete){options.afterComplete(chartOptions)}}}});Highcharts.Data=Data;Highcharts.data=function(options,chartOptions){return new Data(options,chartOptions)};Highcharts.wrap(Highcharts.Chart.prototype,"init",function(proceed,userOptions,callback){var chart=this;if(userOptions&&userOptions.data){Highcharts.data(Highcharts.extend(userOptions.data,{afterComplete:function(dataOptions){var i,series;if(userOptions.hasOwnProperty("series")){if(typeof userOptions.series==="object"){i=Math.max(userOptions.series.length,dataOptions.series.length);while(i--){series=userOptions.series[i]||{};userOptions.series[i]=Highcharts.merge(series,dataOptions.series[i])}}else{delete userOptions.series}}userOptions=Highcharts.merge(dataOptions,userOptions);proceed.call(chart,userOptions,callback)}}),userOptions)}else{proceed.call(chart,userOptions,callback)}});SeriesBuilder=function(){this.readers=[];this.pointIsArray=true};SeriesBuilder.prototype.populateColumns=function(freeIndexes){var builder=this,enoughColumns=true;each(builder.readers,function(reader){if(reader.columnIndex===undefined){reader.columnIndex=freeIndexes.shift()}});each(builder.readers,function(reader){if(reader.columnIndex===undefined){enoughColumns=false}});return enoughColumns};SeriesBuilder.prototype.read=function(columns,rowIndex){var builder=this,pointIsArray=builder.pointIsArray,point=pointIsArray?[]:{},columnIndexes;each(builder.readers,function(reader){var value=columns[reader.columnIndex][rowIndex];if(pointIsArray){point.push(value)}else{point[reader.configName]=value}});if(this.name===undefined&&builder.readers.length>=2){columnIndexes=builder.getReferencedColumnIndexes();if(columnIndexes.length>=2){columnIndexes.shift();columnIndexes.sort();this.name=columns[columnIndexes.shift()].name}}return point};SeriesBuilder.prototype.addColumnReader=function(columnIndex,configName){this.readers.push({columnIndex:columnIndex,configName:configName});if(!(configName==="x"||configName==="y"||configName===undefined)){this.pointIsArray=false}};SeriesBuilder.prototype.getReferencedColumnIndexes=function(){var i,referencedColumnIndexes=[],columnReader;for(i=0;i<this.readers.length;i=i+1){columnReader=this.readers[i];if(columnReader.columnIndex!==undefined){referencedColumnIndexes.push(columnReader.columnIndex)}}return referencedColumnIndexes};SeriesBuilder.prototype.hasReader=function(configName){var i,columnReader;for(i=0;i<this.readers.length;i=i+1){columnReader=this.readers[i];if(columnReader.configName===configName){return true}}}});