Ext.define("Ext.panel.Panel",{extend:"Ext.panel.AbstractPanel",requires:["Ext.panel.Header","Ext.fx.Anim","Ext.util.KeyMap","Ext.panel.DD","Ext.XTemplate","Ext.layout.component.Dock","Ext.util.Memento"],alias:"widget.panel",alternateClassName:"Ext.Panel",collapsedCls:"collapsed",animCollapse:Ext.enableFx,minButtonWidth:75,collapsed:false,collapseFirst:true,hideCollapseTool:false,titleCollapse:undefined,floatable:true,collapsible:undefined,closable:false,closeAction:"destroy",placeholderCollapseHideMode:Ext.Element.VISIBILITY,preventHeader:false,header:undefined,headerPosition:"top",frame:false,frameHeader:true,manageHeight:true,constrain:false,constrainHeader:false,initComponent:function(){var me=this;me.addEvents("beforeclose","close","beforeexpand","beforecollapse","expand","collapse","titlechange","iconchange","iconclschange","glyphchange","float","unfloat");if(me.collapsible){this.addStateEvents(["expand","collapse"])}if(me.unstyled){me.setUI("plain")}if(me.frame){me.setUI(me.ui+"-framed")}me.bridgeToolbars();me.callParent();me.collapseDirection=me.collapseDirection||me.headerPosition||Ext.Component.DIRECTION_TOP;me.hiddenOnCollapse=new Ext.dom.CompositeElement},beforeDestroy:function(){var me=this;Ext.destroy(me.placeholder,me.ghostPanel,me.dd);me.callParent()},initAria:function(){this.callParent();this.initHeaderAria()},getFocusEl:function(){return this.el},initHeaderAria:function(){var me=this,el=me.el,header=me.header;if(el&&header){el.dom.setAttribute("aria-labelledby",header.titleCmp.id)}},getHeader:function(){return this.header},setTitle:function(newTitle){var me=this,oldTitle=me.title,header=me.header,reExpander=me.reExpander,placeholder=me.placeholder;me.title=newTitle;if(header){if(header.isHeader){header.setTitle(newTitle)}else{header.title=newTitle}}else if(me.rendered){me.updateHeader()}if(reExpander){reExpander.setTitle(newTitle)}if(placeholder&&placeholder.setTitle){placeholder.setTitle(newTitle)}me.fireEvent("titlechange",me,newTitle,oldTitle)},setIconCls:function(newIconCls){var me=this,oldIconCls=me.iconCls,header=me.header,placeholder=me.placeholder;me.iconCls=newIconCls;if(header){if(header.isHeader){header.setIconCls(newIconCls)}else{header.iconCls=newIconCls}}else{me.updateHeader()}if(placeholder&&placeholder.setIconCls){placeholder.setIconCls(newIconCls)}me.fireEvent("iconclschange",me,newIconCls,oldIconCls)},setIcon:function(newIcon){var me=this,oldIcon=me.icon,header=me.header,placeholder=me.placeholder;me.icon=newIcon;if(header){if(header.isHeader){header.setIcon(newIcon)}else{header.icon=newIcon}}else{me.updateHeader()}if(placeholder&&placeholder.setIcon){placeholder.setIcon(newIcon)}me.fireEvent("iconchange",me,newIcon,oldIcon)},setGlyph:function(newGlyph){var me=this,oldGlyph=me.glyph,header=me.header,placeholder=me.placeholder;me.glyph=newGlyph;if(header){if(header.isHeader){header.setGlyph(newGlyph)}else{header.glyph=newGlyph}}else{me.updateHeader()}if(placeholder&&placeholder.setGlyph){placeholder.setIcon(newGlyph)}me.fireEvent("glyphchange",me,newGlyph,oldGlyph)},bridgeToolbars:function(){var me=this,docked=[],fbar,fbarDefaults,minButtonWidth=me.minButtonWidth;function initToolbar(toolbar,pos,useButtonAlign){if(Ext.isArray(toolbar)){toolbar={xtype:"toolbar",items:toolbar}}else if(!toolbar.xtype){toolbar.xtype="toolbar"}toolbar.dock=pos;if(pos=="left"||pos=="right"){toolbar.vertical=true}if(useButtonAlign){toolbar.layout=Ext.applyIf(toolbar.layout||{},{pack:{left:"start",center:"center"}[me.buttonAlign]||"end"})}return toolbar}if(me.tbar){docked.push(initToolbar(me.tbar,"top"));me.tbar=null}if(me.bbar){docked.push(initToolbar(me.bbar,"bottom"));me.bbar=null}if(me.buttons){me.fbar=me.buttons;me.buttons=null}if(me.fbar){fbar=initToolbar(me.fbar,"bottom",true);fbar.ui="footer";if(minButtonWidth){fbarDefaults=fbar.defaults;fbar.defaults=function(config){var defaults=fbarDefaults||{};if((!config.xtype||config.xtype==="button"||config.isComponent&&config.isXType("button"))&&!("minWidth"in defaults)){defaults=Ext.apply({minWidth:minButtonWidth},defaults)}return defaults}}docked.push(fbar);me.fbar=null}if(me.lbar){docked.push(initToolbar(me.lbar,"left"));me.lbar=null}if(me.rbar){docked.push(initToolbar(me.rbar,"right"));me.rbar=null}if(me.dockedItems){if(!Ext.isArray(me.dockedItems)){me.dockedItems=[me.dockedItems]}me.dockedItems=me.dockedItems.concat(docked)}else{me.dockedItems=docked}},isPlaceHolderCollapse:function(){return this.collapseMode=="placeholder"},onBoxReady:function(){this.callParent();if(this.collapsed){this.setHiddenDocked()}},beforeRender:function(){var me=this,wasCollapsed;me.callParent();me.initTools();if(!(me.preventHeader||me.header===false)){me.updateHeader()}if(me.collapsed){if(me.isPlaceHolderCollapse()){if(!me.hidden){me.setHiddenState(true);me.preventCollapseFire=true;me.placeholderCollapse();delete me.preventCollapseFire;wasCollapsed=me.collapsed;me.collapsed=false}}else{me.beginCollapse();me.addClsWithUI(me.collapsedCls)}}if(wasCollapsed){me.collapsed=wasCollapsed}},initTools:function(){var me=this,tools=me.tools,i,tool;me.tools=[];for(i=tools&&tools.length;i;){--i;me.tools[i]=tool=tools[i];tool.toolOwner=me}if(me.collapsible&&!(me.hideCollapseTool||me.header===false||me.preventHeader)){me.collapseDirection=me.collapseDirection||me.headerPosition||"top";me.collapseTool=me.expandTool=Ext.widget({xtype:"tool",handler:me.toggleCollapse,scope:me});me.updateCollapseTool();if(me.collapseFirst){me.tools.unshift(me.collapseTool)}}me.addTools();if(me.closable){me.addClsWithUI("closable");me.addTool(Ext.widget({xtype:"tool",type:"close",handler:Ext.Function.bind(me.close,me,[])}))}if(me.collapseTool&&!me.collapseFirst){me.addTool(me.collapseTool)}},addTools:Ext.emptyFn,updateCollapseTool:function(){var me=this,collapseTool=me.collapseTool;if(collapseTool){if(me.collapsed&&!me.isPlaceHolderCollapse()){collapseTool.setType("expand-"+me.getOppositeDirection(me.collapseDirection))}else{collapseTool.setType("collapse-"+me.collapseDirection)}}},close:function(){if(this.fireEvent("beforeclose",this)!==false){this.doClose()}},doClose:function(){this.fireEvent("close",this);this[this.closeAction]()},updateHeader:function(force){var me=this,header=me.header,title=me.title,tools=me.tools,icon=me.icon||me.iconCls,vertical=me.headerPosition==="left"||me.headerPosition==="right";if(Ext.isObject(header)||header!==false&&(force||(title||icon)||tools&&tools.length||me.collapsible&&!me.titleCollapse)){if(header&&header.isHeader){header.show()}else{header=me.header=Ext.widget(Ext.apply({xtype:"header",title:title,titleAlign:me.titleAlign,orientation:vertical?"vertical":"horizontal",dock:me.headerPosition||"top",textCls:me.headerTextCls,iconCls:me.iconCls,icon:me.icon,glyph:me.glyph,baseCls:me.baseCls+"-header",tools:tools,ui:me.ui,id:me.id+"_header",overCls:me.headerOverCls,indicateDrag:me.draggable,frame:(me.frame||me.alwaysFramed)&&me.frameHeader,ignoreParentFrame:me.frame||me.overlapHeader,ignoreBorderManagement:me.frame||me.ignoreHeaderBorderManagement,ownerCt:me,listeners:me.collapsible&&me.titleCollapse?{click:me.toggleCollapse,scope:me}:null},me.header));me.addDocked(header,0)}me.initHeaderAria()}else if(header){header.hide()}},setUI:function(ui){var me=this;me.callParent(arguments);if(me.header&&me.header.rendered){me.header.setUI(ui)}},getDefaultContentTarget:function(){return this.body},getTargetEl:function(){var me=this;return me.body||me.protoBody||me.frameBody||me.el},isVisible:function(deep){var me=this;if(me.collapsed&&me.placeholder){return me.placeholder.isVisible(deep)}return me.callParent(arguments)},onHide:function(){var me=this;if(me.collapsed&&me.placeholder){me.placeholder.hide()}else{me.callParent(arguments)}},onShow:function(){var me=this;if(me.collapsed&&me.isPlaceHolderCollapse()){me.setHiddenState(true);me.placeholderCollapse()}else{me.callParent(arguments)}},onRemoved:function(destroying){var me=this;if(me.placeholder&&!destroying){me.ownerCt.remove(me.placeholder,false)}me.callParent(arguments)},addTool:function(tools){if(!Ext.isArray(tools)){tools=[tools]}var me=this,header=me.header,t,tLen=tools.length,tool;for(t=0;t<tLen;t++){tool=tools[t];tool.toolOwner=me;if(header&&header.isHeader){header.addTool(tool)}else{me.tools.push(tool)}}me.updateHeader()},getOppositeDirection:function(d){var c=Ext.Component;switch(d){case c.DIRECTION_TOP:return c.DIRECTION_BOTTOM;case c.DIRECTION_RIGHT:return c.DIRECTION_LEFT;case c.DIRECTION_BOTTOM:return c.DIRECTION_TOP;case c.DIRECTION_LEFT:return c.DIRECTION_RIGHT}},getWidthAuthority:function(){if(this.collapsed&&this.collapsedHorizontal()){return 1}return this.callParent()},getHeightAuthority:function(){if(this.collapsed&&this.collapsedVertical()){return 1}return this.callParent()},collapsedHorizontal:function(){var dir=this.getCollapsed();return dir==="left"||dir==="right"},collapsedVertical:function(){var dir=this.getCollapsed();return dir==="top"||dir==="bottom"},restoreDimension:function(){var dir=this.collapseDirection;return dir==="top"||dir==="bottom"?"height":"width"},getCollapsed:function(){var me=this;if(me.collapsed===true){return me.collapseDirection}return me.collapsed},getState:function(){var me=this,state=me.callParent(),memento;state=me.addPropertyToState(state,"collapsed");if(me.collapsed){memento=me.collapseMemento;memento=memento&&memento.data;if(me.collapsedVertical()){if(state){delete state.height}if(memento){state=me.addPropertyToState(state,"height",memento.height)}}else{if(state){delete state.width}if(memento){state=me.addPropertyToState(state,"width",memento.width)}}}return state},findReExpander:function(direction){var me=this,c=Ext.Component,dockedItems=me.dockedItems.items,dockedItemCount=dockedItems.length,comp,i;if(me.collapseMode==="mini"){return}switch(direction){case c.DIRECTION_TOP:case c.DIRECTION_BOTTOM:for(i=0;i<dockedItemCount;i++){comp=dockedItems[i];if(!comp.hidden){if(comp.isHeader&&(!comp.dock||comp.dock==="top"||comp.dock==="bottom")){return comp}}}break;case c.DIRECTION_LEFT:case c.DIRECTION_RIGHT:for(i=0;i<dockedItemCount;i++){comp=dockedItems[i];if(!comp.hidden){if(comp.isHeader&&(comp.dock==="left"||comp.dock==="right")){return comp}}}break;default:throw"Panel#findReExpander must be passed a valid collapseDirection"}},getReExpander:function(direction){var me=this,collapseDir=direction||me.collapseDirection,reExpander=me.reExpander||me.findReExpander(collapseDir);me.expandDirection=me.getOppositeDirection(collapseDir);if(!reExpander){me.reExpander=reExpander=me.createReExpander(collapseDir,{dock:collapseDir,cls:Ext.baseCSSPrefix+"docked "+me.baseCls+"-"+me.ui+"-collapsed",isCollapsedExpander:true});me.dockedItems.insert(0,reExpander)}return reExpander},createReExpander:function(direction,defaults){var me=this,isLeft=direction==="left",isRight=direction==="right",isVertical=isLeft||isRight,result=Ext.apply({hideMode:"offsets",title:me.title||"&#160;",titleAlign:me.titleAlign,orientation:isVertical?"vertical":"horizontal",textCls:me.headerTextCls,icon:me.icon,iconCls:me.iconCls,glyph:me.glyph,baseCls:me.self.prototype.baseCls+"-header",ui:me.ui,frame:me.frame&&me.frameHeader,ignoreParentFrame:me.frame||me.overlapHeader,indicateDrag:me.draggable,collapseImmune:true,ownerCt:me.ownerCt,ownerLayout:me.componentLayout,margin:me.margin},defaults);if(me.collapseMode==="mini"){if(isVertical){result.width=1}else{result.height=1}}if(!me.hideCollapseTool){if(isLeft||isRight&&me.isPlaceHolderCollapse()){result.titlePosition=1}result.tools=[{xtype:"tool",type:"expand-"+me.getOppositeDirection(direction),uiCls:["top"],handler:me.toggleCollapse,scope:me}]}result=new Ext.panel.Header(result);result.addClsWithUI(me.getHeaderCollapsedClasses(result));return result},getHeaderCollapsedClasses:function(header){var me=this,collapsedCls=me.collapsedCls,collapsedClasses;collapsedClasses=[collapsedCls,collapsedCls+"-"+header.getDockName()];if(me.border&&(!me.frame||me.frame&&Ext.supports.CSS3BorderRadius)){collapsedClasses.push(collapsedCls+"-border-"+header.getDockName())}return collapsedClasses},beginCollapse:function(){var me=this,lastBox=me.lastBox,rendered=me.rendered,collapseMemento=me.collapseMemento||(me.collapseMemento=new Ext.util.Memento(me)),sizeModel=me.getSizeModel(),header=me.header,reExpander;collapseMemento.capture(["height","minHeight","width","minWidth"]);if(lastBox){collapseMemento.capture(me.restoreDimension(),lastBox,"last.")}if(me.collapsedVertical()){if(sizeModel.width.shrinkWrap){me.width=rendered?me.getWidth():me.width||me.minWidth||100}delete me.height;me.minHeight=0}else if(me.collapsedHorizontal()){if(sizeModel.height.shrinkWrap){me.height=rendered?me.getHeight():me.height||me.minHeight||100}delete me.width;me.minWidth=0}if(me.ownerCt){me.ownerCt.getLayout().beginCollapse(me)}if(!me.isPlaceHolderCollapse()&&header!==false){if(header===(reExpander=me.getReExpander())){header.collapseImmune=true;header.getHierarchyState().collapseImmune=true;header.addClsWithUI(me.getHeaderCollapsedClasses(header));if(header.rendered){header.updateFrame()}}else if(reExpander.el){reExpander.el.show();reExpander.hidden=false}}if(me.resizer){me.resizer.disable()}},beginExpand:function(){var me=this,lastBox=me.lastBox,collapseMemento=me.collapseMemento,restoreDimension=this.restoreDimension(),header=me.header,reExpander;if(collapseMemento){collapseMemento.restore(["minHeight","minWidth",restoreDimension]);if(lastBox){collapseMemento.restore(restoreDimension,true,lastBox,"last.")}}if(me.ownerCt){me.ownerCt.getLayout().beginExpand(me)}if(!me.isPlaceHolderCollapse()&&header!==false){if(header===(reExpander=me.getReExpander())){delete header.collapseImmune;delete header.getHierarchyState().collapseImmune;header.removeClsWithUI(me.getHeaderCollapsedClasses(header));if(header.rendered){header.expanding=true;header.updateFrame();delete header.expanding}}else{reExpander.hidden=true;reExpander.el.hide()}}if(me.resizer){me.resizer.enable()}},collapse:function(direction,animate){var me=this,collapseDir=direction||me.collapseDirection,ownerCt=me.ownerCt;if(me.isCollapsingOrExpanding){return me}if(arguments.length<2){animate=me.animCollapse}if(me.collapsed||me.fireEvent("beforecollapse",me,direction,animate)===false){return me}if(ownerCt&&me.isPlaceHolderCollapse()){return me.placeholderCollapse(direction,animate)}me.collapsed=collapseDir;me.beginCollapse();me.getHierarchyState().collapsed=true;me.fireHierarchyEvent("collapse");return me.doCollapseExpand(1,animate)},doCollapseExpand:function(flags,animate){var me=this,originalAnimCollapse=me.animCollapse,ownerLayout=me.ownerLayout;me.animCollapse=animate;me.isCollapsingOrExpanding=flags;if(animate){me.addCls(Ext.baseCSSPrefix+"animating-size")}if(ownerLayout&&!animate){ownerLayout.onContentChange(me)}else{me.updateLayout({isRoot:true})}me.animCollapse=originalAnimCollapse;return me},afterCollapse:function(animated){var me=this,ownerLayout=me.ownerLayout;me.isCollapsingOrExpanding=0;me.updateCollapseTool();if(animated){me.removeCls(Ext.baseCSSPrefix+"animating-size")}if(ownerLayout&&animated){ownerLayout.onContentChange(me)}me.setHiddenDocked();me.fireEvent("collapse",me)},setHiddenDocked:function(){var me=this,toHide=me.hiddenOnCollapse,items=me.getDockedItems(),len=items.length,i=0,item,reExpander;if(me.header!==false){reExpander=me.getReExpander()}toHide.add(me.body);for(;i<len;i++){item=items[i];if(item&&item!==reExpander&&item.el){toHide.add(item.el)}}toHide.setStyle("visibility","hidden")},restoreHiddenDocked:function(){var toShow=this.hiddenOnCollapse;toShow.setStyle("visibility","");toShow.clear()},getPlaceholder:function(direction){var me=this,collapseDir=direction||me.collapseDirection,listeners=null,placeholder=me.placeholder,floatable=me.floatable,titleCollapse=me.titleCollapse;if(!placeholder){if(floatable||me.collapsible&&titleCollapse){listeners={click:{fn:!titleCollapse&&floatable?me.floatCollapsedPanel:me.toggleCollapse,element:"el",scope:me}}}me.placeholder=placeholder=Ext.widget(me.createReExpander(collapseDir,{id:me.id+"-placeholder",listeners:listeners}))}if(!placeholder.placeholderFor){if(!placeholder.isComponent){me.placeholder=placeholder=me.lookupComponent(placeholder)}Ext.applyIf(placeholder,{margins:me.margins,placeholderFor:me});placeholder.addCls([Ext.baseCSSPrefix+"region-collapsed-placeholder",Ext.baseCSSPrefix+"region-collapsed-"+collapseDir+"-placeholder",me.collapsedCls])}return placeholder},placeholderCollapse:function(direction,animate){var me=this,ownerCt=me.ownerCt,collapseDir=direction||me.collapseDirection,floatCls=Ext.baseCSSPrefix+"border-region-slide-in",placeholder=me.getPlaceholder(collapseDir),slideInDirection;me.isCollapsingOrExpanding=1;me.setHiddenState(true);me.collapsed=collapseDir;if(placeholder.rendered){if(placeholder.el.dom.parentNode!==me.el.dom.parentNode){me.el.dom.parentNode.insertBefore(placeholder.el.dom,me.el.dom)}placeholder.hidden=false;placeholder.el.show();ownerCt.updateLayout()}else{ownerCt.insert(ownerCt.items.indexOf(me),placeholder)}if(me.rendered){me.el.setVisibilityMode(me.placeholderCollapseHideMode);if(animate){me.el.addCls(floatCls);placeholder.el.hide();slideInDirection=me.convertCollapseDir(collapseDir);me.el.slideOut(slideInDirection,{preserveScroll:true,duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls);placeholder.el.show().setStyle("display","none").slideIn(slideInDirection,{easing:"linear",duration:100,listeners:{afteranimate:function(){placeholder.focus();me.isCollapsingOrExpanding=0;me.fireEvent("collapse",me)}}})}}})}else{me.el.hide();me.isCollapsingOrExpanding=0;me.fireEvent("collapse",me)}}else{me.isCollapsingOrExpanding=0;if(!me.preventCollapseFire){me.fireEvent("collapse",me)}}return me},floatCollapsedPanel:function(){var me=this,placeholder=me.placeholder,ps=placeholder.getSize(),myBox,floatCls=Ext.baseCSSPrefix+"border-region-slide-in",collapsed=me.collapsed,layoutOwner=me.ownerCt||me,slideDirection;if(me.isSliding){return}if(me.el.hasCls(floatCls)){me.slideOutFloatedPanel();return}me.isSliding=true;placeholder.el.hide();placeholder.hidden=true;me.el.show();me.setHiddenState(false);me.collapsed=false;layoutOwner.updateLayout();myBox=me.getBox(false,true);placeholder.el.show();placeholder.hidden=false;me.el.hide();me.setHiddenState(true);me.collapsed=collapsed;layoutOwner.updateLayout();me.slideOutTask=me.slideOutTask||new Ext.util.DelayedTask(me.slideOutFloatedPanel,me);placeholder.el.on("mouseleave",me.onMouseLeaveFloated,me);me.el.on("mouseleave",me.onMouseLeaveFloated,me);placeholder.el.on("mouseenter",me.onMouseEnterFloated,me);me.el.on("mouseenter",me.onMouseEnterFloated,me);me.el.addCls(floatCls);me.floated=true;if(me.collapseTool){me.collapseTool.el.hide()}switch(me.collapsed){case"top":me.setLocalXY(myBox.x,myBox.y+ps.height-1);break;case"right":me.setLocalXY(myBox.x-ps.width+1,myBox.y);break;case"bottom":me.setLocalXY(myBox.x,myBox.y-ps.height+1);break;case"left":me.setLocalXY(myBox.x+ps.width-1,myBox.y);break}slideDirection=me.convertCollapseDir(me.collapsed);me.floatedFromCollapse=me.collapsed;me.collapsed=false;me.setHiddenState(false);me.el.slideIn(slideDirection,{preserveScroll:true,duration:Ext.Number.from(me.animCollapse,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.isSliding=false;me.fireEvent("float",me)}}})},onMouseLeaveFloated:function(e){this.slideOutTask.delay(500)},onMouseEnterFloated:function(e){this.slideOutTask.cancel()},isLayoutRoot:function(){if(this.floatedFromCollapse){return true}return this.callParent()},slideOutFloatedPanel:function(){var me=this,compEl=this.el,collapseDirection;if(me.isSliding||me.isDestroyed){return}me.isSliding=true;me.floated=false;me.slideOutFloatedPanelBegin();if(typeof me.collapsed=="string"){collapseDirection=me.convertCollapseDir(me.collapsed)}compEl.slideOut(collapseDirection,{preserveScroll:true,duration:Ext.Number.from(me.animCollapse,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.slideOutFloatedPanelEnd();me.el.removeCls(Ext.baseCSSPrefix+"border-region-slide-in")}}})},slideOutFloatedPanelBegin:function(){var me=this,placeholderEl=me.placeholder.el,el=me.el;me.collapsed=me.floatedFromCollapse;me.setHiddenState(true);me.floatedFromCollapse=null;placeholderEl.un("mouseleave",me.onMouseLeaveFloated,me);el.un("mouseleave",me.onMouseLeaveFloated,me);placeholderEl.un("mouseenter",me.onMouseEnterFloated,me);el.un("mouseenter",me.onMouseEnterFloated,me)},slideOutFloatedPanelEnd:function(){var me=this;if(me.collapseTool){me.collapseTool.el.show()}me.slideOutTask.cancel();me.isSliding=false;me.fireEvent("unfloat",me)},expand:function(animate){var me=this;if(me.isCollapsingOrExpanding){return me}if(!arguments.length){animate=me.animCollapse}if(!me.collapsed&&!me.floatedFromCollapse){return me}if(me.fireEvent("beforeexpand",me,animate)===false){return me}delete this.getHierarchyState().collapsed;if(me.isPlaceHolderCollapse()){return me.placeholderExpand(animate)}me.restoreHiddenDocked();me.beginExpand();me.collapsed=false;return me.doCollapseExpand(2,animate)},placeholderExpand:function(animate){var me=this,collapseDir=me.collapsed,floatCls=Ext.baseCSSPrefix+"border-region-slide-in",finalPos,floatedPos,center=me.ownerLayout?me.ownerLayout.centerRegion:null;if(Ext.AbstractComponent.layoutSuspendCount){animate=false}if(me.floatedFromCollapse){floatedPos=me.getPosition(true);me.slideOutFloatedPanelBegin();me.slideOutFloatedPanelEnd();me.floated=false}if(animate){Ext.suspendLayouts();me.placeholder.hide();me.el.show();me.collapsed=false;me.setHiddenState(false);if(center&&!floatedPos){center.hidden=true}Ext.resumeLayouts(true);center.hidden=false;me.el.addCls(floatCls);me.isCollapsingOrExpanding=2;if(floatedPos){finalPos=me.getXY();me.setLocalXY(floatedPos[0],floatedPos[1]);me.setXY([finalPos[0],finalPos[1]],{duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls);me.isCollapsingOrExpanding=0;me.fireEvent("expand",me)}}})}else{me.el.hide();me.placeholder.el.show();me.placeholder.hidden=false;me.setHiddenState(false);me.el.slideIn(me.convertCollapseDir(collapseDir),{preserveScroll:true,duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls);me.placeholder.hide();me.updateLayout();me.isCollapsingOrExpanding=0;me.fireEvent("expand",me)}}})}}else{me.floated=me.collapsed=false;me.el.removeCls(floatCls);Ext.suspendLayouts();me.placeholder.hide();me.show();Ext.resumeLayouts(true);me.fireEvent("expand",me)}return me},afterExpand:function(animated){var me=this,ownerLayout=me.ownerLayout;me.isCollapsingOrExpanding=0;me.updateCollapseTool();if(animated){me.removeCls(Ext.baseCSSPrefix+"animating-size")}if(ownerLayout&&animated){ownerLayout.onContentChange(me)}me.fireEvent("expand",me);me.fireHierarchyEvent("expand")},setBorder:function(border,targetEl){if(targetEl){return}var me=this,header=me.header;if(!border){border=0}else if(border===true){border="1px"}else{border=me.unitizeBox(border)}if(header){if(header.isHeader){header.setBorder(border)}else{header.border=border}}if(me.rendered&&me.bodyBorder!==false){me.body.setStyle("border-width",border)}me.updateLayout();me.border=border},toggleCollapse:function(){return this.collapsed||this.floatedFromCollapse?this.expand():this.collapse()},getKeyMap:function(){return this.keyMap||(this.keyMap=new Ext.util.KeyMap(Ext.apply({target:this.el},this.keys)))},initDraggable:function(){if(this.simpleDrag){this.initSimpleDraggable()}else{this.dd=new Ext.panel.DD(this,Ext.isBoolean(this.draggable)?null:this.draggable)}},initSimpleDraggable:function(){var me=this,ddConfig,dd;if(!me.header){me.updateHeader(true)}if(me.header){ddConfig=Ext.applyIf({el:me.el,delegate:"#"+Ext.escapeId(me.header.id)},me.draggable);if(me.constrain||me.constrainHeader){ddConfig.constrain=me.constrain;ddConfig.constrainDelegate=me.constrainHeader;ddConfig.constrainTo=me.constrainTo||me.container}dd=me.dd=new Ext.util.ComponentDragger(this,ddConfig);me.relayEvents(dd,["dragstart","drag","dragend"]);if(me.maximized){dd.disable()}}},ghostTools:function(){var tools=[],header=this.header,headerTools=header?header.query("tool[hidden=false]"):[],t,tLen,tool;if(headerTools.length){t=0;tLen=headerTools.length;for(;t<tLen;t++){tool=headerTools[t];tools.push({type:tool.type})}}else{tools=[{type:"placeholder"}]}return tools},ghost:function(cls){var me=this,ghostPanel=me.ghostPanel,box=me.getBox(),header;if(!ghostPanel){ghostPanel=new Ext.panel.Panel({renderTo:Ext.getBody(),floating:{shadow:false},frame:me.frame&&!me.alwaysFramed,alwaysFramed:me.alwaysFramed,overlapHeader:me.overlapHeader,headerPosition:me.headerPosition,baseCls:me.baseCls,cls:me.baseCls+"-ghost "+(cls||"")});me.ghostPanel=ghostPanel}else{ghostPanel.el.show()}me.ghostPanel.hidden=false;ghostPanel.floatParent=me.floatParent;if(me.floating){ghostPanel.zIndexManager.assignZIndices()}else{ghostPanel.toFront()}if(!(me.preventHeader||me.header===false)){header=ghostPanel.header;if(header){header.suspendLayouts();Ext.Array.forEach(header.query("tool"),header.remove,header);header.resumeLayouts()}ghostPanel.addTool(me.ghostTools());ghostPanel.setTitle(me.title);if(me.iconCls){ghostPanel.setIconCls(me.iconCls)}else if(me.icon){ghostPanel.setIcon(me.icon)}else if(me.glyph){ghostPanel.setGlyph(me.glyph)}ghostPanel.header.addCls(Ext.baseCSSPrefix+"header-ghost")}ghostPanel.setPagePosition(box.x,box.y);ghostPanel.setSize(box.width,box.height);me.el.hide();return ghostPanel},unghost:function(show,matchPosition){var me=this;if(!me.ghostPanel){return}if(show!==false){me.el.show();if(matchPosition!==false){me.setPagePosition(me.ghostPanel.getXY());if(me.hideMode=="offsets"){delete me.el.hideModeStyles}}Ext.defer(me.focus,10,me)}me.ghostPanel.el.hide();me.ghostPanel.hidden=true},beginDrag:function(){if(this.floatingDescendants){this.floatingDescendants.hide()}},endDrag:function(){if(this.floatingDescendants){this.floatingDescendants.show()}},initResizable:function(){this.callParent(arguments);if(this.collapsed){this.resizer.disable()}},convertCollapseDir:function(collapseDir){return collapseDir.substr(0,1)}},function(){this.prototype.animCollapse=Ext.enableFx});