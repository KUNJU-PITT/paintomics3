Ext.define("Ext.panel.Header",{extend:"Ext.container.Container",uses:["Ext.panel.Tool","Ext.util.CSS","Ext.layout.component.Body","Ext.Img"],alias:"widget.header",isHeader:true,defaultType:"tool",indicateDrag:false,weight:-1,componentLayout:"body",childEls:["body"],renderTpl:['<div id="{id}-body" class="{headerCls}-body {baseCls}-body {bodyCls} {bodyTargetCls}','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>"','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values)%}","</div>"],headingTpl:['<span id="{id}-textEl" class="{headerCls}-text {cls}-text {cls}-text-{ui}" unselectable="on">{title}</span>'],shrinkWrap:3,titlePosition:0,headerCls:Ext.baseCSSPrefix+"header",initComponent:function(){var me=this,hasPosition=me.hasOwnProperty("titlePosition"),items=me.items,titlePosition=hasPosition?me.titlePosition:items?items.length:0,uiClasses=[me.orientation,me.getDockName()],ownerCt=me.ownerCt;me.addEvents("click","dblclick");me.indicateDragCls=me.headerCls+"-draggable";me.title=me.title||"&#160;";me.tools=me.tools||[];items=me.items=items?Ext.Array.slice(items):[];me.orientation=me.orientation||"horizontal";me.dock=me.dock?me.dock:me.orientation=="horizontal"?"top":"left";if(ownerCt?!ownerCt.border&&!ownerCt.frame:!me.border){uiClasses.push(me.orientation+"-noborder")}me.addClsWithUI(uiClasses);me.addCls([me.headerCls,me.headerCls+"-"+me.orientation]);if(me.indicateDrag){me.addCls(me.indicateDragCls)}if(me.iconCls||me.icon||me.glyph){me.initIconCmp();if(!hasPosition&&!items.length){++titlePosition}items.push(me.iconCmp)}me.titleCmp=new Ext.Component({ariaRole:"heading",focusable:false,noWrap:true,flex:1,rtl:me.rtl,id:me.id+"_hd",style:me.titleAlign?"text-align:"+me.titleAlign:"",cls:me.headerCls+"-text-container "+me.baseCls+"-text-container "+me.baseCls+"-text-container-"+me.ui,renderTpl:me.getTpl("headingTpl"),renderData:{title:me.title,cls:me.baseCls,headerCls:me.headerCls,ui:me.ui},childEls:["textEl"],autoEl:{unselectable:"on"},listeners:{render:me.onTitleRender,scope:me}});me.layout=me.orientation=="vertical"?{type:"vbox",align:"center",alignRoundingMethod:"ceil"}:{type:"hbox",align:"middle",alignRoundingMethod:"floor"};Ext.Array.push(items,me.tools);me.tools.length=0;me.callParent();if(items.length<titlePosition){titlePosition=items.length}me.titlePosition=titlePosition;me.insert(titlePosition,me.titleCmp);me.on({dblclick:me.onDblClick,click:me.onClick,element:"el",scope:me})},initIconCmp:function(){var me=this,cls=[me.headerCls+"-icon",me.baseCls+"-icon",me.iconCls],cfg;if(me.glyph){cls.push(me.baseCls+"-glyph")}cfg={focusable:false,src:Ext.BLANK_IMAGE_URL,cls:cls,baseCls:me.baseCls+"-icon",id:me.id+"-iconEl",iconCls:me.iconCls,glyph:me.glyph};if(!Ext.isEmpty(me.icon)){delete cfg.iconCls;cfg.src=me.icon}me.iconCmp=new Ext.Img(cfg)},beforeRender:function(){this.protoEl.unselectable();this.callParent()},afterLayout:function(){var me=this,frameBR,frameTR,frameTL,xPos;if(me.orientation==="vertical"){me.adjustTitlePosition();frameTR=me.frameTR;if(frameTR){frameBR=me.frameBR;frameTL=me.frameTL;xPos=me.getWidth()-frameTR.getPadding("r")-(frameTL?frameTL.getPadding("l"):me.el.getBorderWidth("l"))+"px";frameBR.setStyle("background-position-x",xPos);frameTR.setStyle("background-position-x",xPos)}if(Ext.isIE7&&Ext.isStrict&&me.frame){me.el.repaint()}}},beforeLayout:function(){this.callParent();this.syncBeforeAfterTitleClasses()},adjustTitlePosition:function(){var titleCmp=this.titleCmp,titleEl;if(!Ext.isIE9m&&titleCmp){titleEl=titleCmp.el;titleEl.setStyle("left",titleEl.getWidth()+"px")}},onTitleRender:function(){if(this.orientation==="vertical"){this.titleCmp.el.setVertical(90)}},addUIClsToElement:function(cls){var me=this,result=me.callParent(arguments),classes=[me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls],array,i;if(me.bodyCls){array=me.bodyCls.split(" ");for(i=0;i<classes.length;i++){if(!Ext.Array.contains(array,classes[i])){array.push(classes[i])}}me.bodyCls=array.join(" ")}else{me.bodyCls=classes.join(" ")}return result},removeUIClsFromElement:function(cls){var me=this,result=me.callParent(arguments),classes=[me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls],array,i;if(me.bodyCls){array=me.bodyCls.split(" ");for(i=0;i<classes.length;i++){Ext.Array.remove(array,classes[i])}me.bodyCls=array.join(" ")}return result},addUIToElement:function(){var me=this,array,cls;me.callParent(arguments);cls=me.baseCls+"-body-"+me.ui;if(me.rendered){if(me.bodyCls){me.body.addCls(me.bodyCls)}else{me.body.addCls(cls)}}else{if(me.bodyCls){array=me.bodyCls.split(" ");if(!Ext.Array.contains(array,cls)){array.push(cls)}me.bodyCls=array.join(" ")}else{me.bodyCls=cls}}if(me.titleCmp&&me.titleCmp.rendered){me.titleCmp.addCls(me.baseCls+"-text-container-"+me.ui)}},removeUIFromElement:function(){var me=this,array,cls;me.callParent(arguments);cls=me.baseCls+"-body-"+me.ui;if(me.rendered){if(me.bodyCls){me.body.removeCls(me.bodyCls)}else{me.body.removeCls(cls)}}else{if(me.bodyCls){array=me.bodyCls.split(" ");Ext.Array.remove(array,cls);me.bodyCls=array.join(" ")}else{me.bodyCls=cls}}if(me.titleCmp&&me.titleCmp.rendered){me.titleCmp.removeCls(me.baseCls+"-text-container-"+me.ui)}},onClick:function(e){this.fireClickEvent("click",e)},onDblClick:function(e){this.fireClickEvent("dblclick",e)},fireClickEvent:function(type,e){var toolCls="."+Ext.panel.Tool.prototype.baseCls;if(!e.getTarget(toolCls)){this.fireEvent(type,this,e)}},getFocusEl:function(){return this.el},getTargetEl:function(){return this.body||this.frameBody||this.el},applyTargetCls:function(targetCls){this.bodyTargetCls=targetCls},setTitle:function(title){var me=this,titleCmp=me.titleCmp;me.title=title;if(titleCmp.rendered){titleCmp.textEl.update(me.title||"&#160;");titleCmp.updateLayout()}else{me.titleCmp.on({render:function(){me.setTitle(title)},single:true})}},getMinWidth:function(){var me=this,textEl=me.titleCmp.textEl.dom,result,tools=me.tools,l,i;textEl.style.display="inline";result=textEl.offsetWidth;textEl.style.display="";if(tools&&(l=tools.length)){for(i=0;i<l;i++){if(tools[i].el){result+=tools[i].el.dom.offsetWidth}}}if(me.iconCmp){result+=me.iconCmp.el.dom.offsetWidth}return result+10},setIconCls:function(cls){var me=this,isEmpty=!cls||!cls.length,iconCmp=me.iconCmp;me.iconCls=cls;if(!me.iconCmp&&!isEmpty){me.initIconCmp();me.insert(0,me.iconCmp)}else if(iconCmp){if(isEmpty){me.iconCmp.destroy();delete me.iconCmp}else{iconCmp.removeCls(iconCmp.iconCls);iconCmp.addCls(cls);iconCmp.iconCls=cls}}},setIcon:function(icon){var me=this,isEmpty=!icon||!icon.length,iconCmp=me.iconCmp;me.icon=icon;if(!me.iconCmp&&!isEmpty){me.initIconCmp();me.insert(0,me.iconCmp)}else if(iconCmp){if(isEmpty){me.iconCmp.destroy();delete me.iconCmp}else{iconCmp.setSrc(me.icon)}}},setGlyph:function(glyph){var me=this,iconCmp=me.iconCmp;if(!me.iconCmp){me.initIconCmp();me.insert(0,me.iconCmp)}else if(iconCmp){if(glyph){me.iconCmp.setGlyph(glyph)}else{me.iconCmp.destroy();delete me.iconCmp}}},getTools:function(){return this.tools.slice()},addTool:function(tool){this.add(Ext.ComponentManager.create(tool,"tool"))},syncBeforeAfterTitleClasses:function(){var me=this,items=me.items,childItems=items.items,titlePosition=me.titlePosition,itemCount=childItems.length,itemGeneration=items.generation,syncGen=me.syncBeforeAfterGen,afterCls,beforeCls,i,item;if(syncGen===itemGeneration){return}me.syncBeforeAfterGen=itemGeneration;for(i=0;i<itemCount;++i){item=childItems[i];afterCls=item.afterTitleCls||(item.afterTitleCls=item.baseCls+"-after-title");beforeCls=item.beforeTitleCls||(item.beforeTitleCls=item.baseCls+"-before-title");if(!me.title||i<titlePosition){if(syncGen){item.removeCls(afterCls)}item.addCls(beforeCls)}else if(i>titlePosition){if(syncGen){item.removeCls(beforeCls)}item.addCls(afterCls)}}},onAdd:function(component,index){var tools=this.tools;this.callParent(arguments);if(component.isTool){tools.push(component);tools[component.type]=component}},initRenderData:function(){return Ext.applyIf(this.callParent(),{bodyCls:this.bodyCls,bodyTargetCls:this.bodyTargetCls,headerCls:this.headerCls})},getDockName:function(){return this.dock},getFramingInfoCls:function(){var me=this,cls=me.callParent(),owner=me.ownerCt;if(!me.expanding&&(owner&&owner.collapsed)||me.isCollapsedExpander){cls+="-"+owner.collapsedCls}return cls+"-"+me.dock}});