Ext.define("Ext.layout.component.field.Field",{extend:"Ext.layout.component.Auto",alias:"layout.field",uses:["Ext.tip.QuickTip","Ext.util.TextMetrics","Ext.util.CSS"],type:"field",naturalSizingProp:"size",beginLayout:function(ownerContext){var me=this,owner=me.owner;me.callParent(arguments);ownerContext.labelStrategy=me.getLabelStrategy();ownerContext.errorStrategy=me.getErrorStrategy();ownerContext.labelContext=ownerContext.getEl("labelEl");ownerContext.bodyCellContext=ownerContext.getEl("bodyEl");ownerContext.inputContext=ownerContext.getEl("inputEl");ownerContext.errorContext=ownerContext.getEl("errorEl");if(Ext.isIE7m&&Ext.isStrict&&ownerContext.inputContext){me.ieInputWidthAdjustment=ownerContext.inputContext.getPaddingInfo().width+ownerContext.inputContext.getBorderInfo().width}ownerContext.labelStrategy.prepare(ownerContext,owner);ownerContext.errorStrategy.prepare(ownerContext,owner)},beginLayoutCycle:function(ownerContext){var me=this,owner=me.owner,widthModel=ownerContext.widthModel,ownerNaturalSize=owner[me.naturalSizingProp],width;me.callParent(arguments);if(widthModel.shrinkWrap){me.beginLayoutShrinkWrap(ownerContext)}else if(widthModel.natural){if(typeof ownerNaturalSize=="number"&&!owner.inputWidth){me.beginLayoutFixed(ownerContext,width=ownerNaturalSize*6.5+20,"px")}else{me.beginLayoutShrinkWrap(ownerContext)}ownerContext.setWidth(width,false)}else{me.beginLayoutFixed(ownerContext,"100","%")}},beginLayoutFixed:function(ownerContext,width,suffix){var owner=ownerContext.target,inputEl=owner.inputEl,inputWidth=owner.inputWidth;owner.el.setStyle("table-layout","fixed");owner.bodyEl.setStyle("width",width+suffix);if(inputEl){if(inputWidth){inputEl.setStyle("width",inputWidth+"px")}else{inputEl.setStyle("width",owner.stretchInputElFixed?"100%":"")}}ownerContext.isFixed=true},beginLayoutShrinkWrap:function(ownerContext){var owner=ownerContext.target,inputEl=owner.inputEl,inputWidth=owner.inputWidth;if(inputEl&&inputEl.dom){inputEl.dom.removeAttribute("size");if(inputWidth){inputEl.setStyle("width",inputWidth+"px")}else{inputEl.setStyle("width","")}}owner.el.setStyle("table-layout","auto");owner.bodyEl.setStyle("width","")},finishedLayout:function(ownerContext){var owner=this.owner;this.callParent(arguments);ownerContext.labelStrategy.finishedLayout(ownerContext,owner);ownerContext.errorStrategy.finishedLayout(ownerContext,owner)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){return contentHeight},measureContentHeight:function(ownerContext){return ownerContext.el.getHeight()},measureContentWidth:function(ownerContext){return ownerContext.el.getWidth()},measureLabelErrorHeight:function(ownerContext){return ownerContext.labelStrategy.getHeight(ownerContext)+ownerContext.errorStrategy.getHeight(ownerContext)},onFocus:function(){this.getErrorStrategy().onFocus(this.owner)},getLabelStrategy:function(){var me=this,strategies=me.labelStrategies,labelAlign=me.owner.labelAlign;return strategies[labelAlign]||strategies.base},getErrorStrategy:function(){var me=this,owner=me.owner,strategies=me.errorStrategies,msgTarget=owner.msgTarget;return!owner.preventMark&&Ext.isString(msgTarget)?strategies[msgTarget]||strategies.elementId:strategies.none},labelStrategies:function(){var base={prepare:function(ownerContext,owner){var cls=owner.labelCls+"-"+owner.labelAlign,labelEl=owner.labelEl;if(labelEl){labelEl.addCls(cls)}},getHeight:function(){return 0},finishedLayout:Ext.emptyFn};return{base:base,top:Ext.applyIf({getHeight:function(ownerContext){var labelContext=ownerContext.labelContext,props=labelContext.props,height=props.height;if(height===undefined){props.height=height=labelContext.el.getHeight()}return height}},base),left:base,right:base}}(),errorStrategies:function(){function showTip(owner){var tip=Ext.layout.component.field.Field.tip,target;if(tip&&tip.isVisible()){target=tip.activeTarget;if(target&&target.el===owner.getActionEl().dom){tip.toFront(true)}}}var applyIf=Ext.applyIf,emptyFn=Ext.emptyFn,iconCls=Ext.baseCSSPrefix+"form-invalid-icon",iconWidth,base={prepare:function(ownerContext,owner){var el=owner.errorEl;if(el){el.setDisplayed(false)}},getHeight:function(){return 0},onFocus:emptyFn,finishedLayout:emptyFn};return{none:base,side:applyIf({prepare:function(ownerContext,owner){var errorEl=owner.errorEl,sideErrorCell=owner.sideErrorCell,displayError=owner.hasActiveError(),tempEl;if(!iconWidth){iconWidth=(tempEl=Ext.getBody().createChild({style:"position:absolute",cls:iconCls})).getWidth();tempEl.remove()}errorEl.addCls(iconCls);errorEl.set({"data-errorqtip":owner.getActiveError()||""});if(owner.autoFitErrors){errorEl.setDisplayed(displayError)}else{errorEl.setVisible(displayError)}if(sideErrorCell&&owner.autoFitErrors){sideErrorCell.setDisplayed(displayError)}owner.bodyEl.dom.colSpan=owner.getBodyColspan();Ext.layout.component.field.Field.initTip()},onFocus:showTip},base),under:applyIf({prepare:function(ownerContext,owner){var errorEl=owner.errorEl,cls=Ext.baseCSSPrefix+"form-invalid-under";errorEl.addCls(cls);errorEl.setDisplayed(owner.hasActiveError())},getHeight:function(ownerContext){var height=0,errorContext,props;if(ownerContext.target.hasActiveError()){errorContext=ownerContext.errorContext;props=errorContext.props;height=props.height;if(height===undefined){props.height=height=errorContext.el.getHeight()}}return height}},base),qtip:applyIf({prepare:function(ownerContext,owner){Ext.layout.component.field.Field.initTip();owner.getActionEl().dom.setAttribute("data-errorqtip",owner.getActiveError()||"")},onFocus:showTip},base),title:applyIf({prepare:function(ownerContext,owner){owner.getActionEl().dom.setAttribute("title",owner.getActiveError()||"")}},base),elementId:applyIf({prepare:function(ownerContext,owner){var targetEl=Ext.fly(owner.msgTarget);if(targetEl){targetEl.dom.innerHTML=owner.getActiveError()||"";targetEl.setDisplayed(owner.hasActiveError())}}},base)}}(),statics:{initTip:function(){var tip=this.tip;if(!tip){tip=this.tip=Ext.create("Ext.tip.QuickTip",{ui:"form-invalid"});tip.tagConfig=Ext.apply({},{attribute:"errorqtip"},tip.tagConfig)}},destroyTip:function(){var tip=this.tip;if(tip){tip.destroy();delete this.tip}}}});