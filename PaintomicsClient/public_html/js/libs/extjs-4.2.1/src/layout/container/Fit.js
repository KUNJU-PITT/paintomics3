Ext.define("Ext.layout.container.Fit",{extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.FitLayout",alias:"layout.fit",itemCls:Ext.baseCSSPrefix+"fit-item",targetCls:Ext.baseCSSPrefix+"layout-fit",type:"fit",defaultMargins:{top:0,right:0,bottom:0,left:0},manageMargins:true,sizePolicies:{0:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},1:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},2:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},3:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(item,ownerSizeModel){var sizeModel=ownerSizeModel||this.owner.getSizeModel(),mode=(sizeModel.width.shrinkWrap?0:1)|(sizeModel.height.shrinkWrap?0:2);return this.sizePolicies[mode]},beginLayoutCycle:function(ownerContext,firstCycle){var me=this,resetHeight=me.lastHeightModel&&me.lastHeightModel.calculated,resetWidth=me.lastWidthModel&&me.lastWidthModel.calculated,resetSizes=resetWidth||resetHeight,maxChildMinHeight=0,maxChildMinWidth=0,c,childItems,i,item,length,margins,minHeight,minWidth,style,undef;me.callParent(arguments);if(resetSizes&&ownerContext.targetContext.el.dom.tagName.toUpperCase()!="TD"){resetSizes=resetWidth=resetHeight=false}childItems=ownerContext.childItems;length=childItems.length;for(i=0;i<length;++i){item=childItems[i];if(firstCycle){c=item.target;minHeight=c.minHeight;minWidth=c.minWidth;if(minWidth||minHeight){margins=item.marginInfo||item.getMarginInfo();minHeight+=margins.height;minWidth+=margins.height;if(maxChildMinHeight<minHeight){maxChildMinHeight=minHeight}if(maxChildMinWidth<minWidth){maxChildMinWidth=minWidth}}}if(resetSizes){style=item.el.dom.style;if(resetHeight){style.height=""}if(resetWidth){style.width=""}}}if(firstCycle){ownerContext.maxChildMinHeight=maxChildMinHeight;ownerContext.maxChildMinWidth=maxChildMinWidth}c=ownerContext.target;ownerContext.overflowX=!ownerContext.widthModel.shrinkWrap&&ownerContext.maxChildMinWidth&&c.scrollFlags.x||undef;ownerContext.overflowY=!ownerContext.heightModel.shrinkWrap&&ownerContext.maxChildMinHeight&&c.scrollFlags.y||undef},calculate:function(ownerContext){var me=this,childItems=ownerContext.childItems,length=childItems.length,containerSize=me.getContainerSize(ownerContext),info={length:length,ownerContext:ownerContext,targetSize:containerSize},shrinkWrapWidth=ownerContext.widthModel.shrinkWrap,shrinkWrapHeight=ownerContext.heightModel.shrinkWrap,overflowX=ownerContext.overflowX,overflowY=ownerContext.overflowY,scrollbars,scrollbarSize,padding,i,contentWidth,contentHeight;if(overflowX||overflowY){scrollbars=me.getScrollbarsNeeded(overflowX&&containerSize.width,overflowY&&containerSize.height,ownerContext.maxChildMinWidth,ownerContext.maxChildMinHeight);if(scrollbars){scrollbarSize=Ext.getScrollbarSize();if(scrollbars&1){containerSize.height-=scrollbarSize.height}if(scrollbars&2){containerSize.width-=scrollbarSize.width}}}for(i=0;i<length;++i){info.index=i;me.fitItem(childItems[i],info)}if(shrinkWrapHeight||shrinkWrapWidth){padding=ownerContext.targetContext.getPaddingInfo();if(shrinkWrapWidth){if(overflowY&&!containerSize.gotHeight){me.done=false}else{contentWidth=info.contentWidth+padding.width;if(scrollbars&2){contentWidth+=scrollbarSize.width}if(!ownerContext.setContentWidth(contentWidth)){me.done=false}}}if(shrinkWrapHeight){if(overflowX&&!containerSize.gotWidth){me.done=false}else{contentHeight=info.contentHeight+padding.height;if(scrollbars&1){contentHeight+=scrollbarSize.height}if(!ownerContext.setContentHeight(contentHeight)){me.done=false}}}}},fitItem:function(itemContext,info){var me=this;if(itemContext.invalid){me.done=false;return}info.margins=itemContext.getMarginInfo();info.needed=info.got=0;me.fitItemWidth(itemContext,info);me.fitItemHeight(itemContext,info);if(info.got!=info.needed){me.done=false}},fitItemWidth:function(itemContext,info){var contentWidth,width;if(info.ownerContext.widthModel.shrinkWrap){width=itemContext.getProp("width")+info.margins.width;contentWidth=info.contentWidth;if(contentWidth===undefined){info.contentWidth=width}else{info.contentWidth=Math.max(contentWidth,width)}}else if(itemContext.widthModel.calculated){++info.needed;if(info.targetSize.gotWidth){++info.got;this.setItemWidth(itemContext,info)}}this.positionItemX(itemContext,info)},fitItemHeight:function(itemContext,info){var contentHeight,height;if(info.ownerContext.heightModel.shrinkWrap){height=itemContext.getProp("height")+info.margins.height;contentHeight=info.contentHeight;if(contentHeight===undefined){info.contentHeight=height}else{info.contentHeight=Math.max(contentHeight,height)}}else if(itemContext.heightModel.calculated){++info.needed;if(info.targetSize.gotHeight){++info.got;this.setItemHeight(itemContext,info)}}this.positionItemY(itemContext,info)},positionItemX:function(itemContext,info){var margins=info.margins;if(info.index||margins.left){itemContext.setProp("x",margins.left)}if(margins.width){itemContext.setProp("margin-right",margins.width)}},positionItemY:function(itemContext,info){var margins=info.margins;if(info.index||margins.top){itemContext.setProp("y",margins.top)}if(margins.height){itemContext.setProp("margin-bottom",margins.height)}},setItemHeight:function(itemContext,info){itemContext.setHeight(info.targetSize.height-info.margins.height)},setItemWidth:function(itemContext,info){itemContext.setWidth(info.targetSize.width-info.margins.width)}});