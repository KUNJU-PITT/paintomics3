Ext.define("Ext.layout.container.Auto",{alias:["layout.auto","layout.autocontainer"],extend:"Ext.layout.container.Container",type:"autocontainer",childEls:["outerCt","innerCt","clearEl"],reserveScrollbar:false,managePadding:true,manageOverflow:false,lastOverflowAdjust:{width:0,height:0},renderTpl:["{% if (!(Ext.isIEQuirks || Ext.isIE7m)) { %}",'<span id="{ownerId}-outerCt" style="display:table;">','<div id="{ownerId}-innerCt" style="display:table-cell;height:100%;','vertical-align:top;{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}","</div>","</span>","{% } else if (values.shrinkWrapWidth) { %}",'<table id="{ownerId}-outerCt" class="'+Ext.plainTableCls+'">',"<tr>",'<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</td>","</tr>","</table>","{% } else { %}",'<div id="{ownerId}-outerCt" style="zoom:1;{%this.renderPadding(out, values)%}">','<div id="{ownerId}-innerCt" style="zoom:1;height:100%;" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</div>","</div>","{% values.$layout.isShrinkWrapTpl = false %}","{% } %}"],tableTpl:['<table id="{ownerId}-outerCt" class="'+Ext.plainTableCls+'">',"<tr>",'<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"</td>","</tr>","</table>"],isShrinkWrapTpl:true,beginLayout:function(ownerContext){var me=this,bottomPadding,overflowYStyle,overflowXStyle,needsTable;me.callParent(arguments);me.initContextItems(ownerContext);if(!me.isShrinkWrapTpl){if(ownerContext.widthModel.shrinkWrap){needsTable=true}if(Ext.isStrict&&Ext.isIE7){overflowXStyle=me.getOverflowXStyle(ownerContext);if((overflowXStyle==="auto"||overflowXStyle==="scroll")&&ownerContext.paddingContext.getPaddingInfo().right){needsTable=true}}if(needsTable){me.insertTableCt(ownerContext)}}if(!me.isShrinkWrapTpl&&Ext.isIE7&&Ext.isStrict&&!me.clearElHasPadding){bottomPadding=ownerContext.paddingContext.getPaddingInfo().bottom;overflowYStyle=me.getOverflowYStyle(ownerContext);if(bottomPadding&&(overflowYStyle==="auto"||overflowYStyle==="scroll")){me.clearEl.setStyle("height",bottomPadding);me.clearElHasPadding=true}}},beforeLayoutCycle:function(ownerContext){var comp=this.owner,hierarchyState=comp.hierarchyState,hierarchyStateInner=comp.hierarchyStateInner;if(!hierarchyState||hierarchyState.invalid){hierarchyState=comp.getHierarchyState();hierarchyStateInner=comp.hierarchyStateInner}if(ownerContext.widthModel.shrinkWrap&&this.isShrinkWrapTpl){hierarchyStateInner.inShrinkWrapTable=true}else{delete hierarchyStateInner.inShrinkWrapTable}},beginLayoutCycle:function(ownerContext){var me=this,outerCt=me.outerCt,lastOuterCtWidth=me.lastOuterCtWidth||"",lastOuterCtHeight=me.lastOuterCtHeight||"",lastOuterCtTableLayout=me.lastOuterCtTableLayout||"",state=ownerContext.state,overflowXStyle,overflowYStyle,outerCtWidth,outerCtHeight,outerCtTableLayout,deferWidth,hierarchyStateInner;me.callParent(arguments);outerCtWidth=outerCtHeight=outerCtTableLayout="";if(!ownerContext.widthModel.shrinkWrap&&me.isShrinkWrapTpl){if(Ext.isIE7m&&Ext.isStrict){overflowYStyle=me.getOverflowYStyle(ownerContext);if(overflowYStyle==="auto"||overflowYStyle==="scroll"){deferWidth=true}}if(!deferWidth){outerCtWidth="100%"}hierarchyStateInner=me.owner.hierarchyStateInner;overflowXStyle=me.getOverflowXStyle(ownerContext);outerCtTableLayout=hierarchyStateInner.inShrinkWrapTable||overflowXStyle==="auto"||overflowXStyle==="scroll"?"":"fixed"}if(!ownerContext.heightModel.shrinkWrap&&!Ext.supports.PercentageHeightOverflowBug){outerCtHeight="100%"}if(outerCtWidth!==lastOuterCtWidth||me.hasOuterCtPxWidth){outerCt.setStyle("width",outerCtWidth);me.lastOuterCtWidth=outerCtWidth;me.hasOuterCtPxWidth=false}if(outerCtTableLayout!==lastOuterCtTableLayout){outerCt.setStyle("table-layout",outerCtTableLayout);me.lastOuterCtTableLayout=outerCtTableLayout}if(outerCtHeight!==lastOuterCtHeight||me.hasOuterCtPxHeight){outerCt.setStyle("height",outerCtHeight);me.lastOuterCtHeight=outerCtHeight;me.hasOuterCtPxHeight=false}if(me.hasInnerCtPxHeight){me.innerCt.setStyle("height","");me.hasInnerCtPxHeight=false}state.overflowAdjust=state.overflowAdjust||me.lastOverflowAdjust},calculate:function(ownerContext){var me=this,state=ownerContext.state,containerSize=me.getContainerSize(ownerContext,true),calculatedItems=state.calculatedItems||(state.calculatedItems=me.calculateItems?me.calculateItems(ownerContext,containerSize):true);me.setCtSizeIfNeeded(ownerContext,containerSize);if(calculatedItems&&ownerContext.hasDomProp("containerChildrenSizeDone")){me.calculateContentSize(ownerContext);if(containerSize.gotAll){if(me.manageOverflow&&!ownerContext.state.secondPass&&!me.reserveScrollbar){me.calculateOverflow(ownerContext,containerSize)}return}}me.done=false},calculateContentSize:function(ownerContext){var me=this,containerDimensions=(ownerContext.widthModel.shrinkWrap?1:0)|(ownerContext.heightModel.shrinkWrap?2:0),calcWidth=containerDimensions&1||undefined,calcHeight=containerDimensions&2||undefined,needed=0,props=ownerContext.props;if(calcWidth){if(isNaN(props.contentWidth)){++needed}else{calcWidth=undefined}}if(calcHeight){if(isNaN(props.contentHeight)){++needed}else{calcHeight=undefined}}if(needed){if(calcWidth&&!ownerContext.setContentWidth(me.measureContentWidth(ownerContext))){me.done=false}if(calcHeight&&!ownerContext.setContentHeight(me.measureContentHeight(ownerContext))){me.done=false}}},calculateOverflow:function(ownerContext){var me=this,width,height,scrollbarSize,scrollbars,xauto,yauto,targetEl;xauto=me.getOverflowXStyle(ownerContext)==="auto";yauto=me.getOverflowYStyle(ownerContext)==="auto";if(xauto||yauto){scrollbarSize=Ext.getScrollbarSize();targetEl=ownerContext.overflowContext.el.dom;scrollbars=0;if(targetEl.scrollWidth>targetEl.clientWidth){scrollbars|=1}if(targetEl.scrollHeight>targetEl.clientHeight){scrollbars|=2}width=yauto&&scrollbars&2?scrollbarSize.width:0;height=xauto&&scrollbars&1?scrollbarSize.height:0;if(width!==me.lastOverflowAdjust.width||height!==me.lastOverflowAdjust.height){me.done=false;ownerContext.invalidate({state:{overflowAdjust:{width:width,height:height},overflowState:scrollbars,secondPass:true}})}}},completeLayout:function(ownerContext){this.lastOverflowAdjust=ownerContext.state.overflowAdjust},doRenderPadding:function(out,renderData){var me=renderData.$layout,owner=renderData.$layout.owner,padding=owner[owner.contentPaddingProperty];if(me.managePadding&&padding){out.push("padding:",owner.unitizeBox(padding))}},finishedLayout:function(ownerContext){var innerCt=this.innerCt;this.callParent(arguments);if(Ext.isIEQuirks||Ext.isIE8m){innerCt.repaint()}if(Ext.isOpera){innerCt.setStyle("position","relative");innerCt.dom.scrollWidth;innerCt.setStyle("position","")}},getContainerSize:function(ownerContext,inDom){var size=this.callParent(arguments),overflowAdjust=ownerContext.state.overflowAdjust;if(overflowAdjust){size.width-=overflowAdjust.width;size.height-=overflowAdjust.height}return size},getRenderData:function(){var owner=this.owner,data=this.callParent();if((Ext.isIEQuirks||Ext.isIE7m)&&(owner.shrinkWrap&1||owner.floating&&!owner.width)){data.shrinkWrapWidth=true}return data},getRenderTarget:function(){return this.innerCt},getElementTarget:function(){return this.innerCt},getOverflowXStyle:function(ownerContext){return ownerContext.overflowXStyle||(ownerContext.overflowXStyle=this.owner.scrollFlags.overflowX||ownerContext.overflowContext.getStyle("overflow-x"))},getOverflowYStyle:function(ownerContext){return ownerContext.overflowYStyle||(ownerContext.overflowYStyle=this.owner.scrollFlags.overflowY||ownerContext.overflowContext.getStyle("overflow-y"))},initContextItems:function(ownerContext){var me=this,target=ownerContext.target,customOverflowEl=me.owner.customOverflowEl;ownerContext.outerCtContext=ownerContext.getEl("outerCt",me);ownerContext.innerCtContext=ownerContext.getEl("innerCt",me);if(customOverflowEl){ownerContext.overflowContext=ownerContext.getEl(customOverflowEl)}else{ownerContext.overflowContext=ownerContext.targetContext}if(target[target.contentPaddingProperty]!==undefined){ownerContext.paddingContext=me.isShrinkWrapTpl?ownerContext.innerCtContext:ownerContext.outerCtContext}},initLayout:function(){var me=this,scrollbarWidth=Ext.getScrollbarSize().width,owner=me.owner;me.callParent();if(scrollbarWidth&&me.manageOverflow&&!me.hasOwnProperty("lastOverflowAdjust")){if(owner.autoScroll||me.reserveScrollbar){me.lastOverflowAdjust={width:scrollbarWidth,height:0}}}},insertTableCt:function(ownerContext){var me=this,owner=me.owner,i=0,renderTpl,fragment,childNodes,childLength,targetEl;renderTpl=Ext.XTemplate.getTpl(this,"tableTpl");renderTpl.renderPadding=me.doRenderPadding;me.outerCt.dom.removeChild(me.innerCt.dom);fragment=document.createDocumentFragment();childNodes=me.innerCt.dom.childNodes;childLength=childNodes.length;for(;i<childLength;i++){fragment.appendChild(childNodes[0])}targetEl=me.getTarget();targetEl.dom.innerHTML=renderTpl.apply({$layout:me,ownerId:me.owner.id});targetEl.down("td").dom.appendChild(fragment);me.applyChildEls(owner.el,owner.id);me.isShrinkWrapTpl=true;ownerContext.removeEl(me.outerCt);ownerContext.removeEl(me.innerCt);me.initContextItems(ownerContext)},measureContentHeight:function(ownerContext){var contentHeight=this.outerCt.getHeight(),target=ownerContext.target;if(this.managePadding&&target[target.contentPaddingProperty]===undefined){contentHeight+=ownerContext.targetContext.getPaddingInfo().height}return contentHeight},measureContentWidth:function(ownerContext){var dom,style,old,contentWidth,target;if(this.chromeCellMeasureBug){dom=this.innerCt.dom;style=dom.style;old=style.display;if(old=="table-cell"){style.display="";dom.offsetWidth;style.display=old}}contentWidth=this.outerCt.getWidth();target=ownerContext.target;if(this.managePadding&&target[target.contentPaddingProperty]===undefined){contentWidth+=ownerContext.targetContext.getPaddingInfo().width}return contentWidth},setCtSizeIfNeeded:function(ownerContext,containerSize){var me=this,width=containerSize.width,height=containerSize.height,padding=ownerContext.paddingContext.getPaddingInfo(),targetEl=me.getTarget(),overflowXStyle=me.getOverflowXStyle(ownerContext),overflowYStyle=me.getOverflowYStyle(ownerContext),canOverflowX=overflowXStyle==="auto"||overflowXStyle==="scroll",canOverflowY=overflowYStyle==="auto"||overflowYStyle==="scroll",scrollbarSize=Ext.getScrollbarSize(),isShrinkWrapTpl=me.isShrinkWrapTpl,manageOverflow=me.manageOverflow,overflowStyleName,needsOuterHeight,needsInnerHeight,needsInnerCtPaddingHeight;if(width&&!ownerContext.widthModel.shrinkWrap&&(Ext.isIE7m&&Ext.isStrict&&isShrinkWrapTpl&&canOverflowY||Ext.isIEQuirks&&!isShrinkWrapTpl&&!canOverflowX)){if(!manageOverflow){if(canOverflowY&&targetEl.dom.scrollHeight>targetEl.dom.clientHeight){width-=scrollbarSize.width}}ownerContext.outerCtContext.setProp("width",width+padding.width);me.hasOuterCtPxWidth=true}if(height&&!ownerContext.heightModel.shrinkWrap){if(Ext.supports.PercentageHeightOverflowBug){needsOuterHeight=true}if(Ext.isIE8&&Ext.isStrict||Ext.isIE7m&&Ext.isStrict&&isShrinkWrapTpl){needsInnerHeight=true;needsInnerCtPaddingHeight=!Ext.isIE8}if((needsOuterHeight||needsInnerHeight)&&canOverflowX&&targetEl.dom.scrollWidth>targetEl.dom.clientWidth){height=Math.max(height-scrollbarSize.height,0)}if(needsOuterHeight){ownerContext.outerCtContext.setProp("height",height+padding.height);me.hasOuterCtPxHeight=true}if(needsInnerHeight){if(needsInnerCtPaddingHeight){height+=padding.height}ownerContext.innerCtContext.setProp("height",height);me.hasInnerCtPxHeight=true}}if(Ext.isIE7&&Ext.isStrict&&!isShrinkWrapTpl&&overflowYStyle==="auto"){overflowStyleName=overflowXStyle==="auto"?"overflow-x":"overflow-y";targetEl.setStyle(overflowStyleName,"hidden");targetEl.setStyle(overflowStyleName,"auto")}},setupRenderTpl:function(renderTpl){this.callParent(arguments);renderTpl.renderPadding=this.doRenderPadding},getContentTarget:function(){return this.innerCt}},function(){this.prototype.chromeCellMeasureBug=Ext.isChrome&&Ext.chromeVersion>=26});