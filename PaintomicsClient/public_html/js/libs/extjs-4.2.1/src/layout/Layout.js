Ext.define("Ext.layout.Layout",{requires:["Ext.XTemplate","Ext.layout.SizeModel"],uses:["Ext.layout.Context"],isLayout:true,initialized:false,running:false,autoSizePolicy:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},statics:{layoutsByType:{},create:function(layout,defaultType){var ClassManager=Ext.ClassManager,layoutsByType=this.layoutsByType,alias,className,config,layoutClass,type,load;if(!layout||typeof layout==="string"){type=layout||defaultType;config={}}else if(layout.isLayout){return layout}else{config=layout;type=layout.type||defaultType}if(!(layoutClass=layoutsByType[type])){alias="layout."+type;className=ClassManager.getNameByAlias(alias);if(!className){load=true}layoutClass=ClassManager.get(className);if(load||!layoutClass){return ClassManager.instantiateByAlias(alias,config||{})}layoutsByType[type]=layoutClass}return new layoutClass(config)}},constructor:function(config){var me=this;me.id=Ext.id(null,me.type+"-");Ext.apply(me,config);me.layoutCount=0},beginLayout:Ext.emptyFn,beginLayoutCycle:function(ownerContext){var me=this,context=me.context,changed;if(me.lastWidthModel!=ownerContext.widthModel){if(me.lastWidthModel){changed=true}me.lastWidthModel=ownerContext.widthModel}if(me.lastHeightModel!=ownerContext.heightModel){if(me.lastWidthModel){changed=true}me.lastHeightModel=ownerContext.heightModel}if(changed){(context=ownerContext.context).clearTriggers(me,false);context.clearTriggers(me,true);me.triggerCount=0}},finishedLayout:function(ownerContext){this.lastWidthModel=ownerContext.widthModel;this.lastHeightModel=ownerContext.heightModel;this.ownerContext=null},redoLayout:Ext.emptyFn,undoLayout:Ext.emptyFn,getAnimatePolicy:function(){return this.animatePolicy},getItemSizePolicy:function(item){return this.autoSizePolicy},isItemBoxParent:function(itemContext){return false},isItemLayoutRoot:function(item){var sizeModel=item.getSizeModel(),width=sizeModel.width,height=sizeModel.height;if(!item.componentLayout.lastComponentSize&&(width.calculated||height.calculated)){return false}return!width.shrinkWrap&&!height.shrinkWrap},isItemShrinkWrap:function(item){return item.shrinkWrap},isRunning:function(){return!!this.ownerContext},getItemsRenderTree:function(items,renderCfgs){var length=items.length,i,item,itemConfig,result;if(length){result=[];for(i=0;i<length;++i){item=items[i];if(!item.rendered){if(renderCfgs&&renderCfgs[item.id]!==undefined){itemConfig=renderCfgs[item.id]}else{this.configureItem(item);itemConfig=item.getRenderTree();if(renderCfgs){renderCfgs[item.id]=itemConfig}}if(itemConfig){result.push(itemConfig)}}}}return result},finishRender:Ext.emptyFn,finishRenderItems:function(target,items){var length=items.length,i,item;for(i=0;i<length;i++){item=items[i];if(item.rendering){item.finishRender(i);this.afterRenderItem(item)}}},renderChildren:function(){var me=this,items=me.getLayoutItems(),target=me.getRenderTarget();me.renderItems(items,target)},renderItems:function(items,target){var me=this,ln=items.length,i=0,item;if(ln){Ext.suspendLayouts();for(;i<ln;i++){item=items[i];if(item&&!item.rendered){me.renderItem(item,target,i)}else if(!me.isValidParent(item,target,i)){me.moveItem(item,target,i)}else{me.configureItem(item)}}Ext.resumeLayouts(true)}},isValidParent:function(item,target,position){var itemDom=item.el?item.el.dom:Ext.getDom(item),targetDom=target&&target.dom||target,parentNode=itemDom.parentNode,className;if(parentNode){className=parentNode.className;if(className&&className.indexOf(Ext.baseCSSPrefix+"resizable-wrap")!==-1){itemDom=itemDom.parentNode}}if(itemDom&&targetDom){if(typeof position=="number"){position=this.getPositionOffset(position);return itemDom===targetDom.childNodes[position]}return itemDom.parentNode===targetDom}return false},getPositionOffset:function(position){return position},configureItem:function(item){item.ownerLayout=this},renderItem:function(item,target,position){var me=this;if(!item.rendered){me.configureItem(item);item.render(target,position);me.afterRenderItem(item)}},moveItem:function(item,target,position){target=target.dom||target;if(typeof position=="number"){position=target.childNodes[position]}target.insertBefore(item.el.dom,position||null);item.container=Ext.get(target);this.configureItem(item)},onContentChange:function(){this.owner.updateLayout();return true},initLayout:function(){this.initialized=true},setOwner:function(owner){this.owner=owner},getLayoutItems:function(){return[]},onAdd:function(item){item.ownerLayout=this},afterRenderItem:Ext.emptyFn,onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,afterRemove:function(item){var me=this,el=item.el,owner=me.owner,removeClasses;if(item.rendered){removeClasses=[].concat(me.itemCls||[]);if(owner.itemCls){removeClasses=Ext.Array.push(removeClasses,owner.itemCls)}if(removeClasses.length){el.removeCls(removeClasses)}}delete item.ownerLayout},destroy:function(){var me=this,target;if(me.targetCls){target=me.getTarget();if(target){target.removeCls(me.targetCls)}}me.onDestroy()},sortWeightedItems:function(items,reverseProp){for(var i=0,length=items.length;i<length;++i){items[i].$i=i}Ext.Array.sort(items,function(item1,item2){var ret=item2.weight-item1.weight;if(!ret){ret=item1.$i-item2.$i;if(item1[reverseProp]){ret=-ret}}return ret});for(i=0;i<length;++i){delete items[i].$i}}},function(){var Layout=this;Layout.prototype.sizeModels=Layout.sizeModels=Ext.layout.SizeModel.sizeModels});