Ext.define("Ext.view.TableLayout",{extend:"Ext.layout.component.Auto",requires:["Ext.util.CSS"],alias:["layout.tableview"],type:"tableview",beginLayout:function(ownerContext){var me=this,otherSide=me.owner.lockingPartner,owner=me.owner;me.callParent(arguments);if(otherSide){me.lockedGrid=me.owner.up("[lockable]");me.lockedGrid.needsRowHeightSync=true;if(!ownerContext.lockingPartner){ownerContext.lockingPartner=ownerContext.context.getItem(otherSide,otherSide.el);if(ownerContext.lockingPartner&&!ownerContext.lockingPartner.lockingPartner){ownerContext.lockingPartner.lockingPartner=ownerContext}}}ownerContext.headerContext=ownerContext.context.getCmp(me.headerCt);if(me.owner.body.dom){ownerContext.bodyContext=ownerContext.getEl(me.owner.body)}if(Ext.isWebKit){owner.el.select(owner.getBodySelector()).setStyle("table-layout","auto")}},calculate:function(ownerContext){var me=this,lockingPartner=me.lockingPartner,owner=me.owner,contentHeight=0,emptyEl;if(ownerContext.headerContext.hasProp("columnWidthsDone")){if(!me.setColumnWidths(ownerContext)){me.done=false;return}ownerContext.state.columnWidthsSynced=true;if(ownerContext.bodyContext){emptyEl=me.owner.el.down("."+owner.ownerCt.emptyCls,true);if(!emptyEl){contentHeight=ownerContext.bodyContext.el.dom.offsetHeight;ownerContext.bodyContext.setHeight(contentHeight,false)}else{contentHeight=emptyEl.offsetHeight}ownerContext.setProp("contentHeight",contentHeight)}if(lockingPartner&&!lockingPartner.state.columnWidthsSynced){me.done=false}else{me.callParent(arguments)}}else{me.done=false}},measureContentHeight:function(ownerContext){var lockingPartner=ownerContext.lockingPartner;if(!ownerContext.bodyContext||ownerContext.state.columnWidthsSynced&&(!lockingPartner||lockingPartner.state.columnWidthsSynced)){return this.callParent(arguments)}},setColumnWidths:function(ownerContext){var me=this,owner=me.owner,context=ownerContext.context,columns=me.headerCt.getVisibleGridColumns(),column,i=0,len=columns.length,tableWidth=0,columnLineWidth=0,childContext,colWidth,isContentBox=!Ext.isBorderBox;if(context){context.currentLayout=me}for(i=0;i<len;i++){column=columns[i];childContext=context.getCmp(column);colWidth=childContext.props.width;if(isNaN(colWidth)){childContext.getProp("width");return false}tableWidth+=colWidth;if(isContentBox&&owner.columnLines){if(!columnLineWidth){columnLineWidth=context.getCmp(column).borderInfo.width||1}colWidth-=columnLineWidth}owner.body.select(owner.getColumnSizerSelector(column)).setWidth(colWidth)}owner.el.select(owner.getBodySelector()).setWidth(tableWidth);return true},finishedLayout:function(){var me=this,owner=me.owner;me.callParent(arguments);if(Ext.isWebKit){owner.el.select(owner.getBodySelector()).setStyle("table-layout","")}if(owner.refreshCounter&&me.lockedGrid&&me.lockedGrid.syncRowHeight&&me.lockedGrid.needsRowHeightSync){me.lockedGrid.syncRowHeights();me.lockedGrid.needsRowHeightSync=false}}});