Ext.define("Ext.view.View",{extend:"Ext.view.AbstractView",alternateClassName:"Ext.DataView",alias:"widget.dataview",deferHighlight:Ext.isIE7m?100:0,mouseOverOutBuffer:20,inputTagRe:/^textarea$|^input$/i,inheritableStatics:{EventMap:{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut",mouseenter:"MouseEnter",mouseleave:"MouseLeave",keydown:"KeyDown",focus:"Focus"}},initComponent:function(){var me=this;me.callParent();if(me.mouseOverOutBuffer){me.handleMouseOverOrOut=Ext.Function.createBuffered(me.handleMouseOverOrOut,me.mouseOverOutBuffer,me);me.lastMouseOverOutEvent=new Ext.EventObjectImpl}else if(me.deferHighlight){me.setHighlightedItem=Ext.Function.createBuffered(me.setHighlightedItem,me.deferHighlight,me)}},addCmpEvents:function(){this.addEvents("beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","beforeitemkeydown","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","itemkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","beforecontainerkeydown","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","containerkeydown","selectionchange","beforeselect","beforedeselect","select","deselect","focuschange","highlightitem","unhighlightitem")},getFocusEl:function(){return this.getTargetEl()},afterRender:function(){var me=this,onMouseOverOut=me.mouseOverOutBuffer?me.onMouseOverOut:me.handleMouseOverOrOut;me.callParent();me.mon(me.getTargetEl(),{scope:me,freezeEvent:true,click:me.handleEvent,mousedown:me.handleEvent,mouseup:me.handleEvent,dblclick:me.handleEvent,contextmenu:me.handleEvent,keydown:me.handleEvent,mouseover:onMouseOverOut,mouseout:onMouseOverOut})},onMouseOverOut:function(e){var me=this;me.lastMouseOverOutEvent.setEvent(e.browserEvent,true);me.handleMouseOverOrOut(me.lastMouseOverOutEvent)},handleMouseOverOrOut:function(e){var me=this,isMouseout=e.type==="mouseout",method=isMouseout?e.getRelatedTarget:e.getTarget,nowOverItem=method.call(e,me.itemSelector)||method.call(e,me.dataRowSelector);if(!me.mouseOverItem||nowOverItem!==me.mouseOverItem){if(me.mouseOverItem){e.item=me.mouseOverItem;e.newType="mouseleave";me.handleEvent(e)}me.mouseOverItem=nowOverItem;if(me.mouseOverItem){e.item=me.mouseOverItem;e.newType="mouseenter";me.handleEvent(e)}}},handleEvent:function(e){var me=this,key=e.type=="keydown"&&e.getKey();if(me.processUIEvent(e)!==false){me.processSpecialEvent(e)}if(key===e.SPACE){if(!me.inputTagRe.test(e.getTarget().tagName)){e.stopEvent()}}},processItemEvent:Ext.emptyFn,processContainerEvent:Ext.emptyFn,processSpecialEvent:Ext.emptyFn,processUIEvent:function(e){if(!Ext.getBody().isAncestor(e.target)){return}var me=this,item=e.getTarget(me.getItemSelector(),me.getTargetEl()),map=this.statics().EventMap,index,record,type=e.type,newType=e.type,sm;if(e.newType){newType=e.newType;item=e.item}if(!item&&type=="keydown"){sm=me.getSelectionModel();record=sm.lastFocused||sm.getLastSelected();if(record){item=me.getNode(record,true)}}if(item){if(!record){record=me.getRecord(item)}index=me.indexInStore?me.indexInStore(record):me.indexOf(item);if(!record||me.processItemEvent(record,item,index,e)===false){return false}if(me["onBeforeItem"+map[newType]](record,item,index,e)===false||me.fireEvent("beforeitem"+newType,me,record,item,index,e)===false||me["onItem"+map[newType]](record,item,index,e)===false){return false}me.fireEvent("item"+newType,me,record,item,index,e)}else{if(me.processContainerEvent(e)===false||me["onBeforeContainer"+map[type]](e)===false||me.fireEvent("beforecontainer"+type,me,e)===false||me["onContainer"+map[type]](e)===false){return false}me.fireEvent("container"+type,me,e)}return true},onItemMouseEnter:function(record,item,index,e){if(this.trackOver){this.highlightItem(item)}},onItemMouseLeave:function(record,item,index,e){if(this.trackOver){this.clearHighlight()}},onItemMouseDown:Ext.emptyFn,onItemMouseUp:Ext.emptyFn,onItemFocus:Ext.emptyFn,onItemClick:Ext.emptyFn,onItemDblClick:Ext.emptyFn,onItemContextMenu:Ext.emptyFn,onItemKeyDown:Ext.emptyFn,onBeforeItemMouseDown:Ext.emptyFn,onBeforeItemMouseUp:Ext.emptyFn,onBeforeItemFocus:Ext.emptyFn,onBeforeItemMouseEnter:Ext.emptyFn,onBeforeItemMouseLeave:Ext.emptyFn,onBeforeItemClick:Ext.emptyFn,onBeforeItemDblClick:Ext.emptyFn,onBeforeItemContextMenu:Ext.emptyFn,onBeforeItemKeyDown:Ext.emptyFn,onContainerMouseDown:Ext.emptyFn,onContainerMouseUp:Ext.emptyFn,onContainerMouseOver:Ext.emptyFn,onContainerMouseOut:Ext.emptyFn,onContainerClick:Ext.emptyFn,onContainerDblClick:Ext.emptyFn,onContainerContextMenu:Ext.emptyFn,onContainerKeyDown:Ext.emptyFn,onBeforeContainerMouseDown:Ext.emptyFn,onBeforeContainerMouseUp:Ext.emptyFn,onBeforeContainerMouseOver:Ext.emptyFn,onBeforeContainerMouseOut:Ext.emptyFn,onBeforeContainerClick:Ext.emptyFn,onBeforeContainerDblClick:Ext.emptyFn,onBeforeContainerContextMenu:Ext.emptyFn,onBeforeContainerKeyDown:Ext.emptyFn,setHighlightedItem:function(item){var me=this,highlighted=me.highlightedItem,overItemCls=me.overItemCls,beforeOverItemCls=me.beforeOverItemCls,previous;if(highlighted!=item){if(highlighted){Ext.fly(highlighted).removeCls(overItemCls);previous=highlighted.previousSibling;if(beforeOverItemCls&&previous){Ext.fly(previous).removeCls(beforeOverItemCls)}me.fireEvent("unhighlightitem",me,highlighted)}me.highlightedItem=item;if(item){Ext.fly(item).addCls(me.overItemCls);previous=item.previousSibling;if(beforeOverItemCls&&previous){Ext.fly(previous).addCls(beforeOverItemCls)}me.fireEvent("highlightitem",me,item)}}},highlightItem:function(item){this.setHighlightedItem(item)},clearHighlight:function(){this.setHighlightedItem(undefined)},onUpdate:function(store,record){var me=this,node,newNode,highlighted;if(me.viewReady){node=me.getNode(record);newNode=me.callParent(arguments);highlighted=me.highlightedItem;if(highlighted&&highlighted===node){delete me.highlightedItem;if(newNode){me.highlightItem(newNode)}}}},refresh:function(){this.clearHighlight();this.callParent(arguments)},focusNode:function(rec){var me=this,node=me.getNode(rec,true),el=me.el,adjustmentY=0,adjustmentX=0,elRegion=el.getRegion(),nodeRegion;elRegion.bottom=elRegion.top+el.dom.clientHeight;elRegion.right=elRegion.left+el.dom.clientWidth;if(node){nodeRegion=Ext.fly(node).getRegion();if(nodeRegion.top<elRegion.top){adjustmentY=nodeRegion.top-elRegion.top}else if(nodeRegion.bottom>elRegion.bottom){adjustmentY=nodeRegion.bottom-elRegion.bottom}if(nodeRegion.left<elRegion.left){adjustmentX=nodeRegion.left-elRegion.left}else if(nodeRegion.right>elRegion.right){adjustmentX=nodeRegion.right-elRegion.right}if(adjustmentX||adjustmentY){me.scrollBy(adjustmentX,adjustmentY,false)}el.focus()}}});