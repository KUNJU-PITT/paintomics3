Ext.define("Ext.util.Renderable",{requires:["Ext.dom.Element"],frameCls:Ext.baseCSSPrefix+"frame",frameIdRegex:/[\-]frame\d+[TMB][LCR]$/,frameElNames:["TL","TC","TR","ML","MC","MR","BL","BC","BR"],frameTpl:["{%this.renderDockedItems(out,values,0);%}",'<tpl if="top">','<tpl if="left"><div id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>",'<tpl if="left"><div id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</div>",'<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>','<tpl if="bottom">','<tpl if="left"><div id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>","{%this.renderDockedItems(out,values,1);%}"],frameTableTpl:["{%this.renderDockedItems(out,values,0);%}",'<table class="',Ext.plainTableCls,'" cellpadding="0"><tbody>','<tpl if="top">',"<tr>",'<tpl if="left"><td id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>","<tr>",'<tpl if="left"><td id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</td>",'<tpl if="right"><td id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>",'<tpl if="bottom">',"<tr>",'<tpl if="left"><td id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>","</tbody></table>","{%this.renderDockedItems(out,values,1);%}"],afterRender:function(){var me=this,data={},protoEl=me.protoEl,target=me.el,item,pre,hide,contentEl;me.finishRenderChildren();if(me.contentEl){pre=Ext.baseCSSPrefix;hide=pre+"hide-";contentEl=Ext.get(me.contentEl);contentEl.removeCls([pre+"hidden",hide+"display",hide+"offsets",hide+"nosize"]);me.getContentTarget().appendChild(contentEl.dom)}protoEl.writeTo(data);item=data.removed;if(item){target.removeCls(item)}item=data.cls;if(item.length){target.addCls(item)}item=data.style;if(data.style){target.setStyle(item)}me.protoEl=null;if(!me.ownerCt){me.updateLayout()}},afterFirstLayout:function(width,height){var me=this,x=me.x,y=me.y,hasX,hasY,pos,xy;if(!me.ownerLayout){hasX=Ext.isDefined(x);hasY=Ext.isDefined(y)}if(me.floating&&(!hasX||!hasY)){if(me.floatParent){pos=me.floatParent.getTargetEl().getViewRegion();xy=me.el.getAlignToXY(me.floatParent.getTargetEl(),"c-c");pos.x=xy[0]-pos.x;pos.y=xy[1]-pos.y}else{xy=me.el.getAlignToXY(me.container,"c-c");pos=me.container.translateXY(xy[0],xy[1])}x=hasX?x:pos.x;y=hasY?y:pos.y;hasX=hasY=true}if(hasX||hasY){me.setPosition(x,y)}me.onBoxReady(width,height)},applyRenderSelectors:function(){var me=this,selectors=me.renderSelectors,el=me.el,dom=el.dom,selector;me.applyChildEls(el);if(selectors){for(selector in selectors){if(selectors.hasOwnProperty(selector)&&selectors[selector]){me[selector]=Ext.get(Ext.DomQuery.selectNode(selectors[selector],dom))}}}},beforeRender:function(){var me=this,target=me.getTargetEl(),overflowEl=me.getOverflowEl(),layout=me.getComponentLayout(),overflowStyle=me.getOverflowStyle();me.frame=me.frame||me.alwaysFramed;if(!layout.initialized){layout.initLayout()}if(overflowEl){overflowEl.setStyle(overflowStyle);me.overflowStyleSet=true}me.setUI(me.ui);if(me.disabled){me.disable(true)}},doApplyRenderTpl:function(out,values){var me=values.$comp,tpl;if(!me.rendered){tpl=me.initRenderTpl();tpl.applyOut(values.renderData,out)}},doAutoRender:function(){var me=this;if(!me.rendered){if(me.floating){me.render(document.body)}else{me.render(Ext.isBoolean(me.autoRender)?Ext.getBody():me.autoRender)}}},doRenderContent:function(out,renderData){var me=renderData.$comp;if(me.html){Ext.DomHelper.generateMarkup(me.html,out);delete me.html}if(me.tpl){if(!me.tpl.isTemplate){me.tpl=new Ext.XTemplate(me.tpl)}if(me.data){me.tpl.applyOut(me.data,out);delete me.data}}},doRenderFramingDockedItems:function(out,renderData,after){var me=renderData.$comp;if(!me.rendered&&me.doRenderDockedItems){renderData.renderData.$skipDockedItems=true;me.doRenderDockedItems.call(this,out,renderData,after)}},finishRender:function(containerIdx){var me=this,tpl,data,el;if(!me.el||me.$pid){if(me.container){el=me.container.getById(me.id,true)}else{el=Ext.getDom(me.id)}if(!me.el){me.wrapPrimaryEl(el)}else{delete me.$pid;if(!me.el.dom){me.wrapPrimaryEl(me.el)}el.parentNode.insertBefore(me.el.dom,el);Ext.removeNode(el)}}else if(!me.rendering){tpl=me.initRenderTpl();if(tpl){data=me.initRenderData();tpl.insertFirst(me.getTargetEl(),data)}}if(!me.container){me.container=Ext.get(me.el.dom.parentNode)}if(me.ctCls){me.container.addCls(me.ctCls)}me.onRender(me.container,containerIdx);if(!me.overflowStyleSet){me.getOverflowEl().setStyle(me.getOverflowStyle())}me.el.setVisibilityMode(Ext.Element[me.hideMode.toUpperCase()]);if(me.overCls){me.el.hover(me.addOverCls,me.removeOverCls,me)}if(me.hasListeners.render){me.fireEvent("render",me)}me.afterRender();if(me.hasListeners.afterrender){me.fireEvent("afterrender",me)}me.initEvents();if(me.hidden){me.el.hide()}},finishRenderChildren:function(){var layout=this.getComponentLayout();layout.finishRender()},getElConfig:function(){var me=this,autoEl=me.autoEl,frameInfo=me.getFrameInfo(),config={tag:"div",tpl:frameInfo?me.initFramingTpl(frameInfo.table):me.initRenderTpl()},protoEl=me.protoEl,i,frameElNames,len,suffix,frameGenId,frameData;me.initStyles(protoEl);protoEl.writeTo(config);protoEl.flush();if(Ext.isString(autoEl)){config.tag=autoEl}else{Ext.apply(config,autoEl)}config.id=me.id;if(config.tpl){if(frameInfo){frameElNames=me.frameElNames;len=frameElNames.length;config.tplData=frameData=me.getFrameRenderData();frameData.renderData=me.initRenderData();frameGenId=frameData.fgid;for(i=0;i<len;i++){suffix=frameElNames[i];me.addChildEls({name:"frame"+suffix,id:frameGenId+suffix})}me.addChildEls({name:"frameBody",id:frameGenId+"MC"})}else{config.tplData=me.initRenderData()}}return config},initFramingTpl:function(table){var tpl=this.getFrameTpl(table);if(tpl&&!tpl.applyRenderTpl){this.setupFramingTpl(tpl)}return tpl},setupFramingTpl:function(frameTpl){frameTpl.applyRenderTpl=this.doApplyRenderTpl;frameTpl.renderDockedItems=this.doRenderFramingDockedItems},getInsertPosition:function(position){if(position!==undefined){if(Ext.isNumber(position)){position=this.container.dom.childNodes[position]}else{position=Ext.getDom(position)}}return position},getRenderTree:function(){var me=this;if(!me.hasListeners.beforerender||me.fireEvent("beforerender",me)!==false){me.beforeRender();me.rendering=true;if(me.el){return{tag:"div",id:me.$pid=Ext.id()}}return me.getElConfig()}return null},initContainer:function(container){var me=this;if(!container&&me.el){container=me.el.dom.parentNode;me.allowDomMove=false}me.container=container.dom?container:Ext.get(container);return me.container},initRenderData:function(){var me=this;return Ext.apply({$comp:me,id:me.id,ui:me.ui,uiCls:me.uiCls,baseCls:me.baseCls,componentCls:me.componentCls,frame:me.frame,childElCls:""},me.renderData)},initRenderTpl:function(){var tpl=this.getTpl("renderTpl");if(tpl&&!tpl.renderContent){this.setupRenderTpl(tpl)}return tpl},onRender:function(parentNode,containerIdx){var me=this,x=me.x,y=me.y,lastBox=null,width,height,el=me.el;me.applyRenderSelectors();me.rendering=null;me.rendered=true;if(x!=null){lastBox={x:x}}if(y!=null){(lastBox=lastBox||{}).y=y}if(!me.getFrameInfo()&&Ext.isBorderBox){width=me.width;height=me.height;if(typeof width==="number"){lastBox=lastBox||{};lastBox.width=width}if(typeof height==="number"){lastBox=lastBox||{};lastBox.height=height}}me.lastBox=el.lastBox=lastBox},render:function(container,position){var me=this,el=me.el&&(me.el=Ext.get(me.el)),vetoed,tree,nextSibling;Ext.suspendLayouts();container=me.initContainer(container);nextSibling=me.getInsertPosition(position);if(!el){tree=me.getRenderTree();if(me.ownerLayout&&me.ownerLayout.transformItemRenderTree){tree=me.ownerLayout.transformItemRenderTree(tree)}if(tree){if(nextSibling){el=Ext.DomHelper.insertBefore(nextSibling,tree)}else{el=Ext.DomHelper.append(container,tree)}me.wrapPrimaryEl(el)}}else{if(!me.hasListeners.beforerender||me.fireEvent("beforerender",me)!==false){me.beforeRender();me.initStyles(el);if(me.allowDomMove!==false){if(nextSibling){container.dom.insertBefore(el.dom,nextSibling)}else{container.dom.appendChild(el.dom)}}}else{vetoed=true}}if(el&&!vetoed){me.finishRender(position)}Ext.resumeLayouts(!me.hidden&&!container.isDetachedBody)},ensureAttachedToBody:function(runLayout){var comp=this,body;while(comp.ownerCt){comp=comp.ownerCt}if(comp.container.isDetachedBody){comp.container=body=Ext.getBody();body.appendChild(comp.el.dom);if(runLayout){comp.updateLayout()}if(typeof comp.x=="number"||typeof comp.y=="number"){comp.setPosition(comp.x,comp.y)}}},setupRenderTpl:function(renderTpl){renderTpl.renderBody=renderTpl.renderContent=this.doRenderContent},wrapPrimaryEl:function(dom){this.el=Ext.get(dom,true)},initFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return}var me=this,frameInfo=me.getFrameInfo(),frameTpl,frameGenId,frameElNames=me.frameElNames,len=frameElNames.length,i,frameData,suffix;if(frameInfo){frameTpl=me.getFrameTpl(frameInfo.table);frameData=me.getFrameRenderData();frameGenId=frameData.fgid;frameTpl.insertFirst(me.el,frameData);me.frameBody=me.el.down("."+me.frameCls+"-mc");me.removeChildEls(function(c){return c.id&&me.frameIdRegex.test(c.id)});for(i=0;i<len;i++){suffix=frameElNames[i];me["frame"+suffix]=me.el.getById(frameGenId+suffix)}}},getFrameRenderData:function(){var me=this,frameInfo=me.frameSize,frameGenId=(me.frameGenId||0)+1;me.frameGenId=frameGenId;return{$comp:me,fgid:me.id+"-frame"+frameGenId,ui:me.ui,uiCls:me.uiCls,frameCls:me.frameCls,baseCls:me.baseCls,top:!!frameInfo.top,left:!!frameInfo.left,right:!!frameInfo.right,bottom:!!frameInfo.bottom,frameElCls:""}},updateFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return}var me=this,wasTable=me.frameSize&&me.frameSize.table,oldFrameTL=me.frameTL,oldFrameBL=me.frameBL,oldFrameML=me.frameML,oldFrameMC=me.frameMC,newMCClassName;me.initFrame();if(oldFrameMC){if(me.frame){newMCClassName=me.frameMC.dom.className;oldFrameMC.insertAfter(me.frameMC);me.frameMC.remove();me.frameBody=me.frameMC=oldFrameMC;oldFrameMC.dom.className=newMCClassName;if(wasTable){me.el.query("> table")[1].remove()}else{if(oldFrameTL){oldFrameTL.remove()}if(oldFrameBL){oldFrameBL.remove()}if(oldFrameML){oldFrameML.remove()}}}}else if(me.frame){me.applyRenderSelectors()}},getFrameInfo:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return false}var me=this,frameInfoCache=me.frameInfoCache,cls=me.getFramingInfoCls()+"-frameInfo",frameInfo=frameInfoCache[cls],max=Math.max,styleEl,match,info,frameTop,frameRight,frameBottom,frameLeft,borderWidthT,borderWidthR,borderWidthB,borderWidthL,paddingT,paddingR,paddingB,paddingL,borderRadiusTL,borderRadiusTR,borderRadiusBR,borderRadiusBL;if(frameInfo==null){styleEl=Ext.fly(me.getStyleProxy(cls),"frame-style-el");info=styleEl.getStyle("font-family");if(info){info=info.split("-");borderRadiusTL=parseInt(info[1],10);borderRadiusTR=parseInt(info[2],10);borderRadiusBR=parseInt(info[3],10);borderRadiusBL=parseInt(info[4],10);borderWidthT=parseInt(info[5],10);borderWidthR=parseInt(info[6],10);borderWidthB=parseInt(info[7],10);borderWidthL=parseInt(info[8],10);paddingT=parseInt(info[9],10);paddingR=parseInt(info[10],10);paddingB=parseInt(info[11],10);paddingL=parseInt(info[12],10);frameTop=max(borderWidthT,max(borderRadiusTL,borderRadiusTR));frameRight=max(borderWidthR,max(borderRadiusTR,borderRadiusBR));frameBottom=max(borderWidthB,max(borderRadiusBL,borderRadiusBR));frameLeft=max(borderWidthL,max(borderRadiusTL,borderRadiusBL));frameInfo={table:info[0].charAt(0)==="t",vertical:info[0].charAt(1)==="v",top:frameTop,right:frameRight,bottom:frameBottom,left:frameLeft,width:frameLeft+frameRight,height:frameTop+frameBottom,maxWidth:max(frameTop,frameRight,frameBottom,frameLeft),border:{top:borderWidthT,right:borderWidthR,bottom:borderWidthB,left:borderWidthL,width:borderWidthL+borderWidthR,height:borderWidthT+borderWidthB},padding:{top:paddingT,right:paddingR,bottom:paddingB,left:paddingL,width:paddingL+paddingR,height:paddingT+paddingB},radius:{tl:borderRadiusTL,tr:borderRadiusTR,br:borderRadiusBR,bl:borderRadiusBL}}}else{frameInfo=false}if(me.frame===true&&!frameInfo){Ext.log.error("You have set frame: true explicity on this component ("+me.getXType()+") and it "+"does not have any framing defined in the CSS template. In this case IE cannot figure out "+"what sizes to use and thus framing on this component will be disabled.")}frameInfoCache[cls]=frameInfo}me.frame=!!frameInfo;me.frameSize=frameInfo;return frameInfo},getFramingInfoCls:function(){return this.baseCls+"-"+this.ui},getStyleProxy:function(cls){var result=this.styleProxyEl||(Ext.AbstractComponent.prototype.styleProxyEl=Ext.getBody().createChild({style:{position:"absolute",top:"-10000px"}},null,true));result.className=cls;return result},getFrameTpl:function(table){return this.getTpl(table?"frameTableTpl":"frameTpl")},frameInfoCache:{}});