Ext.define("Ext.grid.ColumnLayout",{extend:"Ext.layout.container.HBox",alias:"layout.gridcolumn",type:"gridcolumn",reserveOffset:false,firstHeaderCls:Ext.baseCSSPrefix+"column-header-first",lastHeaderCls:Ext.baseCSSPrefix+"column-header-last",initLayout:function(){if(!this.scrollbarWidth){this.self.prototype.scrollbarWidth=Ext.getScrollbarSize().width}this.grid=this.owner.up("[scrollerOwner]");this.callParent()},beginLayout:function(ownerContext){var me=this,owner=me.owner,grid=me.grid,view=grid.view,items=me.getVisibleItems(),len=items.length,firstCls=me.firstHeaderCls,lastCls=me.lastHeaderCls,i,item;if(grid.lockable){if(owner.up("tablepanel")===view.normalGrid){view=view.normalGrid.getView()}else{view=null}}for(i=0;i<len;i++){item=items[i];item.isLast=false;item.removeCls([firstCls,lastCls]);if(i===0){item.addCls(firstCls)}if(i===len-1){item.addCls(lastCls);item.isLast=true}}me.callParent(arguments);if(!owner.isColumn&&Ext.getScrollbarSize().width&&!grid.collapsed&&view&&view.rendered&&(ownerContext.viewTable=view.body.dom)){ownerContext.viewContext=ownerContext.context.getCmp(view)}},roundFlex:function(width){return Math.floor(width)},calculate:function(ownerContext){this.callParent(arguments);if(ownerContext.state.parallelDone&&(!this.owner.forceFit||ownerContext.flexedItems.length)){ownerContext.setProp("columnWidthsDone",true)}if(ownerContext.viewContext){ownerContext.state.tableHeight=ownerContext.viewTable.offsetHeight}},completeLayout:function(ownerContext){var me=this,owner=me.owner,state=ownerContext.state;me.callParent(arguments);if(!ownerContext.flexedItems.length&&!state.flexesCalculated&&owner.forceFit&&me.convertWidthsToFlexes(ownerContext)){me.cacheFlexes(ownerContext);ownerContext.invalidate({state:{flexesCalculated:true}})}else{ownerContext.setProp("columnWidthsDone",true)}},convertWidthsToFlexes:function(ownerContext){var me=this,totalWidth=0,calculated=me.sizeModels.calculated,childItems,len,i,childContext,item;childItems=ownerContext.childItems;len=childItems.length;for(i=0;i<len;i++){childContext=childItems[i];item=childContext.target;totalWidth+=childContext.props.width;if(!(item.fixed||item.resizable===false)){item.flex=ownerContext.childItems[i].flex=childContext.props.width;item.width=null;childContext.widthModel=calculated}}return totalWidth!==ownerContext.props.width},getContainerSize:function(ownerContext){var me=this,result,viewContext=ownerContext.viewContext,viewHeight;if(me.owner.isColumn){result=me.getColumnContainerSize(ownerContext)}else{result=me.callParent(arguments);if(viewContext&&!viewContext.heightModel.shrinkWrap&&viewContext.target.componentLayout.ownerContext){viewHeight=viewContext.getProp("height");if(isNaN(viewHeight)){me.done=false}else if(ownerContext.state.tableHeight>viewHeight){result.width-=Ext.getScrollbarSize().width;ownerContext.state.parallelDone=false;viewContext.invalidate()}}}return result},getColumnContainerSize:function(ownerContext){var padding=ownerContext.paddingContext.getPaddingInfo(),got=0,needed=0,gotWidth,gotHeight,width,height;if(!ownerContext.widthModel.shrinkWrap){++needed;width=ownerContext.getProp("innerWidth");gotWidth=typeof width=="number";if(gotWidth){++got;width-=padding.width;if(width<0){width=0}}}if(!ownerContext.heightModel.shrinkWrap){++needed;height=ownerContext.getProp("innerHeight");gotHeight=typeof height=="number";if(gotHeight){++got;height-=padding.height;if(height<0){height=0}}}return{width:width,height:height,needed:needed,got:got,gotAll:got==needed,gotWidth:gotWidth,gotHeight:gotHeight}},publishInnerCtSize:function(ownerContext){var me=this,size=ownerContext.state.boxPlan.targetSize,cw=ownerContext.peek("contentWidth"),view;me.owner.tooNarrow=ownerContext.state.boxPlan.tooNarrow;if(cw!=null&&!me.owner.isColumn){size.width=cw;view=me.owner.ownerCt.view;if(view.scrollFlags.y){size.width+=Ext.getScrollbarSize().width}}return me.callParent(arguments)}});