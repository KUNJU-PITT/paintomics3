Ext.define("Ext.Component",{alias:["widget.component","widget.box"],extend:"Ext.AbstractComponent",uses:["Ext.util.DelayedTask","Ext.Layer","Ext.resizer.Resizer","Ext.util.ComponentDragger"],mixins:{floating:"Ext.util.Floating"},statics:{DIRECTION_TOP:"top",DIRECTION_RIGHT:"right",DIRECTION_BOTTOM:"bottom",DIRECTION_LEFT:"left",VERTICAL_DIRECTION_Re:/^(?:top|bottom)$/,INVALID_ID_CHARS_Re:/[\.,\s]/g},resizeHandles:"all",floating:false,defaultAlign:"tl-bl?",toFrontOnShow:true,hideMode:"display",offsetsCls:Ext.baseCSSPrefix+"hide-offsets",bubbleEvents:[],defaultComponentLayoutType:"autocomponent",constructor:function(config){var me=this;config=config||{};if(config.initialConfig){if(config.isAction){me.baseAction=config}config=config.initialConfig}else if(config.tagName||config.dom||Ext.isString(config)){config={applyTo:config,id:config.id||config}}me.callParent([config]);if(me.baseAction){me.baseAction.addComponent(me)}},initComponent:function(){var me=this;me.callParent();if(me.listeners){me.on(me.listeners);me.listeners=null}me.enableBubble(me.bubbleEvents)},afterRender:function(){var me=this;me.callParent();if(!(me.x&&me.y)&&(me.pageX||me.pageY)){me.setPagePosition(me.pageX,me.pageY)}},setAutoScroll:function(scroll){var me=this;me.autoScroll=!!scroll;if(me.rendered){me.getOverflowEl().setStyle(me.getOverflowStyle())}me.updateLayout();return me},setOverflowXY:function(overflowX,overflowY){var me=this,argCount=arguments.length;if(argCount){me.overflowX=overflowX||"";if(argCount>1){me.overflowY=overflowY||""}}if(me.rendered){me.getOverflowEl().setStyle(me.getOverflowStyle())}me.updateLayout();return me},beforeRender:function(){var me=this,floating=me.floating,cls;if(floating){me.addCls(Ext.baseCSSPrefix+"layer");cls=floating.cls;if(cls){me.addCls(cls)}}return me.callParent()},beforeLayout:function(){this.callParent(arguments);if(this.floating){this.onBeforeFloatLayout()}},afterComponentLayout:function(){this.callParent(arguments);if(this.floating){this.onAfterFloatLayout()}},makeFloating:function(dom){this.mixins.floating.constructor.call(this,dom)},wrapPrimaryEl:function(dom){if(this.floating){this.makeFloating(dom)}else{this.callParent(arguments)}},initResizable:function(resizable){var me=this;resizable=Ext.apply({target:me,dynamic:false,constrainTo:me.constrainTo||(me.floatParent?me.floatParent.getTargetEl():null),handles:me.resizeHandles},resizable);resizable.target=me;me.resizer=new Ext.resizer.Resizer(resizable)},getDragEl:function(){return this.el},initDraggable:function(){var me=this,dragTarget=me.resizer&&me.resizer.el!==me.el?me.resizerComponent=new Ext.Component({el:me.resizer.el,rendered:true,container:me.container}):me,ddConfig=Ext.applyIf({el:dragTarget.getDragEl(),constrainTo:me.constrain||me.draggable.constrain?me.constrainTo||(me.floatParent?me.floatParent.getTargetEl():me.container):undefined},me.draggable);if(me.constrain||me.constrainDelegate){ddConfig.constrain=me.constrain;ddConfig.constrainDelegate=me.constrainDelegate}me.dd=new Ext.util.ComponentDragger(dragTarget,ddConfig)},scrollBy:function(deltaX,deltaY,animate){var el;if((el=this.getTargetEl())&&el.dom){el.scrollBy.apply(el,arguments)}},setLoading:function(load,targetEl){var me=this,config={target:me};if(me.rendered){Ext.destroy(me.loadMask);me.loadMask=null;if(load!==false&&!me.collapsed){if(Ext.isObject(load)){Ext.apply(config,load)}else if(Ext.isString(load)){config.msg=load}if(targetEl){Ext.applyIf(config,{useTargetEl:true})}me.loadMask=new Ext.LoadMask(config);me.loadMask.show()}}return me.loadMask},beforeSetPosition:function(){var me=this,pos=me.callParent(arguments),adj;if(pos){adj=me.adjustPosition(pos.x,pos.y);pos.x=adj.x;pos.y=adj.y}return pos||null},afterSetPosition:function(ax,ay){this.onPosition(ax,ay);this.fireEvent("move",this,ax,ay)},showAt:function(x,y,animate){var me=this;if(!me.rendered&&(me.autoRender||me.floating)){me.x=x;me.y=y;return me.show()}if(me.floating){me.setPosition(x,y,animate)}else{me.setPagePosition(x,y,animate)}me.show()},showBy:function(cmp,pos,off){var me=this;if(!me.floating){Ext.log.warn("Using showBy on a non-floating component");return me}if(me.floating&&cmp){me.show();if(me.rendered&&!me.hidden){me.alignTo(cmp,pos||me.defaultAlign,off)}}return me},setPagePosition:function(x,y,animate){var me=this,p,floatParentBox;if(Ext.isArray(x)){y=x[1];x=x[0]}me.pageX=x;me.pageY=y;if(me.floating){if(me.isContainedFloater()){floatParentBox=me.floatParent.getTargetEl().getViewRegion();if(Ext.isNumber(x)&&Ext.isNumber(floatParentBox.left)){x-=floatParentBox.left}if(Ext.isNumber(y)&&Ext.isNumber(floatParentBox.top)){y-=floatParentBox.top}}else{p=me.el.translateXY(x,y);x=p.x;y=p.y}me.setPosition(x,y,animate)}else{p=me.el.translateXY(x,y);me.setPosition(p.x,p.y,animate)}return me},isContainedFloater:function(){return this.floating&&this.floatParent},updateBox:function(box){this.setSize(box.width,box.height);this.setPagePosition(box.x,box.y);return this},getOuterSize:function(){var el=this.el;return{width:el.getWidth()+el.getMargin("lr"),height:el.getHeight()+el.getMargin("tb")}},adjustPosition:function(x,y){var me=this,floatParentBox;if(me.isContainedFloater()){floatParentBox=me.floatParent.getTargetEl().getViewRegion();x+=floatParentBox.left;y+=floatParentBox.top}return{x:x,y:y}},getPosition:function(local){var me=this,xy,isContainedFloater=me.isContainedFloater(),floatParentBox;if(local===true&&!isContainedFloater){return[me.getLocalX(),me.getLocalY()]}xy=me.getXY();if(local===true&&isContainedFloater){floatParentBox=me.floatParent.getTargetEl().getViewRegion();xy[0]-=floatParentBox.left;xy[1]-=floatParentBox.top}return xy},getId:function(){var me=this,xtype;if(!me.id){xtype=me.getXType();if(xtype){xtype=xtype.replace(Ext.Component.INVALID_ID_CHARS_Re,"-")}else{xtype=Ext.name.toLowerCase()+"-comp"}me.id=xtype+"-"+me.getAutoId()}return me.id},show:function(animateTarget,cb,scope){var me=this,rendered=me.rendered;if(me.hierarchicallyHidden||me.floating&&!rendered&&me.isHierarchicallyHidden()){if(!rendered){me.initHierarchyEvents()}if(arguments.length>1){arguments[0]=null;me.pendingShow=arguments}else{me.pendingShow=true}}else if(rendered&&me.isVisible()){if(me.toFrontOnShow&&me.floating){me.toFront()}}else{if(me.fireEvent("beforeshow",me)!==false){me.hidden=false;delete this.getHierarchyState().hidden;Ext.suspendLayouts();if(!rendered&&(me.autoRender||me.floating)){me.doAutoRender();rendered=me.rendered}if(rendered){me.beforeShow();Ext.resumeLayouts();me.onShow.apply(me,arguments);me.afterShow.apply(me,arguments)}else{Ext.resumeLayouts(true)}}else{me.onShowVeto()}}return me},onShowVeto:Ext.emptyFn,beforeShow:Ext.emptyFn,onShow:function(){var me=this;me.el.show();me.callParent(arguments);if(me.floating){if(me.maximized){me.fitContainer()}else if(me.constrain){me.doConstrain()}}},getAnimateTarget:function(target){target=target||this.animateTarget;if(target){target=target.isComponent?target.getEl():Ext.get(target)}return target||null},afterShow:function(animateTarget,cb,scope){var me=this,myEl=me.el,fromBox,toBox,ghostPanel;animateTarget=me.getAnimateTarget(animateTarget);if(!me.ghost){animateTarget=null}if(animateTarget){toBox={x:myEl.getX(),y:myEl.getY(),width:myEl.dom.offsetWidth,height:myEl.dom.offsetHeight};fromBox={x:animateTarget.getX(),y:animateTarget.getY(),width:animateTarget.dom.offsetWidth,height:animateTarget.dom.offsetHeight};myEl.addCls(me.offsetsCls);ghostPanel=me.ghost();ghostPanel.el.stopAnimation();ghostPanel.setX(-1e4);me.ghostBox=toBox;ghostPanel.el.animate({from:fromBox,to:toBox,listeners:{afteranimate:function(){delete ghostPanel.componentLayout.lastComponentSize;me.unghost();delete me.ghostBox;myEl.removeCls(me.offsetsCls);me.onShowComplete(cb,scope)}}})}else{me.onShowComplete(cb,scope)}me.fireHierarchyEvent("show")},onShowComplete:function(cb,scope){var me=this;if(me.floating){me.toFront();me.onFloatShow()}Ext.callback(cb,scope||me);me.fireEvent("show",me);delete me.hiddenByLayout},hide:function(animateTarget,cb,scope){var me=this,continueHide;if(me.pendingShow){delete me.pendingShow}if(!(me.rendered&&!me.isVisible())){continueHide=me.fireEvent("beforehide",me)!==false;if(me.hierarchicallyHidden||continueHide){me.hidden=true;me.getHierarchyState().hidden=true;if(me.rendered){me.onHide.apply(me,arguments)}}}return me},onHide:function(animateTarget,cb,scope){var me=this,ghostPanel,fromSize,toBox;animateTarget=me.getAnimateTarget(animateTarget);if(!me.ghost){animateTarget=null}if(animateTarget){toBox={x:animateTarget.getX(),y:animateTarget.getY(),width:animateTarget.dom.offsetWidth,height:animateTarget.dom.offsetHeight};ghostPanel=me.ghost();ghostPanel.el.stopAnimation();fromSize=me.getSize();ghostPanel.el.animate({to:toBox,listeners:{afteranimate:function(){delete ghostPanel.componentLayout.lastComponentSize;ghostPanel.el.hide();ghostPanel.el.setSize(fromSize);me.afterHide(cb,scope)}}})}me.el.hide();if(!animateTarget){me.afterHide(cb,scope)}},afterHide:function(cb,scope){var me=this,activeEl=Ext.Element.getActiveElement();me.hiddenByLayout=null;Ext.AbstractComponent.prototype.onHide.call(me);if(activeEl===me.el||me.el.contains(activeEl)){Ext.fly(activeEl).blur()}Ext.callback(cb,scope||me);me.fireEvent("hide",me);me.fireHierarchyEvent("hide")},onDestroy:function(){var me=this;if(me.rendered){Ext.destroy(me.dd,me.resizer,me.proxy,me.proxyWrap,me.resizerComponent)}delete me.focusTask;me.callParent()},deleteMembers:function(){var args=arguments,len=args.length,i=0;for(;i<len;++i){delete this[args[i]]}},focus:function(selectText,delay,callback,scope){var me=this,focusEl,focusElDom,containerScrollTop;if(delay){if(!me.focusTask){Ext.Component.prototype.focusTask=new Ext.util.DelayedTask(me.focus)}me.focusTask.delay(Ext.isNumber(delay)?delay:10,null,me,[selectText,false,callback,scope]);return me}if(me.focusTask){me.focusTask.cancel()}if(me.rendered&&!me.isDestroyed&&me.isVisible(true)&&(focusEl=me.getFocusEl())){if(focusEl.isComponent){return focusEl.focus(selectText,delay)}if(focusElDom=focusEl.dom){if(focusEl.needsTabIndex()){focusElDom.tabIndex=-1}if(me.floating){containerScrollTop=me.container.dom.scrollTop}focusEl.focus();if(selectText===true){focusElDom.select()}Ext.callback(callback,scope)}if(me.floating){me.toFront(true);if(containerScrollTop!==undefined){me.container.dom.scrollTop=containerScrollTop}}}return me},cancelFocus:function(){var task=this.focusTask;if(task){task.cancel()}},blur:function(){var focusEl;if(this.rendered&&(focusEl=this.getFocusEl())){focusEl.blur()}return this},getEl:function(){return this.el},getResizeEl:function(){return this.el},getPositionEl:function(){return this.el},getActionEl:function(){return this.el},getVisibilityEl:function(){return this.el},getRefOwner:function(){return this.ownerCt||this.floatParent},getBubbleTarget:function(){return this.getRefOwner()},getContentTarget:function(){return this.el},cloneConfig:function(overrides){overrides=overrides||{};var id=overrides.id||Ext.id(),cfg=Ext.applyIf(overrides,this.initialConfig),self;cfg.id=id;self=Ext.getClass(this);return new self(cfg)},getXType:function(){return this.self.xtype},findParentBy:function(fn){var p;for(p=this.getBubbleTarget();p&&!fn(p,this);p=p.getBubbleTarget()){}return p||null},findParentByType:function(xtype){return Ext.isFunction(xtype)?this.findParentBy(function(p){return p.constructor===xtype}):this.up(xtype)},bubble:function(fn,scope,args){var p=this;while(p){if(fn.apply(scope||p,args||[p])===false){break}p=p.getBubbleTarget()}return this},getProxy:function(){var me=this,target;if(!me.proxy){target=Ext.getBody();me.proxy=me.el.createProxy(Ext.baseCSSPrefix+"proxy-el",target,true)}return me.proxy},fireHierarchyEvent:function(ename){this.hierarchyEventSource.fireEvent(ename,this)},onAdded:function(){this.callParent(arguments);if(this.hierarchyEventSource.hasListeners.added){this.fireHierarchyEvent("added")}}},function(){this.hierarchyEventSource=this.prototype.hierarchyEventSource=new Ext.util.Observable({events:{hide:true,show:true,collapse:true,expand:true,added:true}})});