Ext.define("Ext.data.writer.Json",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.JsonWriter",alias:"writer.json",root:undefined,encode:false,allowSingle:true,expandData:false,getExpandedData:function(data){var dataLength=data.length,i=0,item,prop,nameParts,j,tempObj,toObject=function(name,value){var o={};o[name]=value;return o};for(;i<dataLength;i++){item=data[i];for(prop in item){if(item.hasOwnProperty(prop)){nameParts=prop.split(".");j=nameParts.length-1;if(j>0){tempObj=item[prop];for(;j>0;j--){tempObj=toObject(nameParts[j],tempObj)}item[nameParts[0]]=item[nameParts[0]]||{};Ext.Object.merge(item[nameParts[0]],tempObj);delete item[prop]}}}}return data},writeRecords:function(request,data){var root=this.root;if(this.expandData){data=this.getExpandedData(data)}if(this.allowSingle&&data.length===1){data=data[0]}if(this.encode){if(root){request.params[root]=Ext.encode(data)}else{Ext.Error.raise("Must specify a root when using encode")}}else{request.jsonData=request.jsonData||{};if(root){request.jsonData[root]=data}else{request.jsonData=data}}return request}});