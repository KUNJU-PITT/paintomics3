Ext.define("Ext.data.reader.Xml",{extend:"Ext.data.reader.Reader",alternateClassName:"Ext.data.XmlReader",alias:"reader.xml",createAccessor:function(expr){var me=this;if(Ext.isEmpty(expr)){return Ext.emptyFn}if(Ext.isFunction(expr)){return expr}return function(root){return me.getNodeValue(Ext.DomQuery.selectNode(expr,root))}},getNodeValue:function(node){if(node){if(typeof node.normalize==="function"){node.normalize()}node=node.firstChild;if(node){return node.nodeValue}}return undefined},getResponseData:function(response){var xml=response.responseXML,error,msg;if(!xml){msg="XML data not found in the response";error=new Ext.data.ResultSet({total:0,count:0,records:[],success:false,message:msg});this.fireEvent("exception",this,response,error);Ext.Logger.warn(msg);return error}return this.readRecords(xml)},getData:function(data){return data.documentElement||data},getRoot:function(data){var nodeName=data.nodeName,root=this.root;if(!root||nodeName&&nodeName==root){return data}else if(Ext.DomQuery.isXml(data)){return Ext.DomQuery.selectNode(root,data)}},extractData:function(root){var recordName=this.record;if(!recordName){Ext.Error.raise("Record is a required parameter")}if(recordName!=root.nodeName){root=Ext.DomQuery.select(recordName,root)}else{root=[root]}return this.callParent([root])},getAssociatedDataRoot:function(data,associationName){return Ext.DomQuery.select(associationName,data)[0]},readRecords:function(doc){if(Ext.isArray(doc)){doc=doc[0]}this.xmlData=doc;return this.callParent([doc])},createFieldAccessExpression:function(field,fieldVarName,dataName){var namespace=this.namespace,selector,result;selector=field.mapping||(namespace?namespace+"|":"")+field.name;if(typeof selector==="function"){result=fieldVarName+".mapping("+dataName+", this)"}else{result='me.getNodeValue(Ext.DomQuery.selectNode("'+selector+'", '+dataName+"))"}return result}});