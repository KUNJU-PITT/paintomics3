Ext.define("Ext.container.Monitor",{target:null,selector:"",scope:null,addHandler:null,removeHandler:null,disabled:0,constructor:function(config){Ext.apply(this,config)},bind:function(target){var me=this;me.target=target;target.on("beforedestroy",me.disable,me);me.onContainerAdd(target)},unbind:function(){var me=this,target=me.target;if(target){target.un("beforedestroy",me.disable,me)}me.items=null},disable:function(){++this.disabled},enable:function(){if(this.disabled>0){--this.disabled}},handleAdd:function(ct,comp){if(!this.disabled){if(comp.is(this.selector)){this.onItemAdd(comp.ownerCt,comp)}if(comp.isQueryable){this.onContainerAdd(comp)}}},onItemAdd:function(ct,comp){var me=this,items=me.items,handler=me.addHandler;if(!me.disabled){if(handler){handler.call(me.scope||comp,comp)}if(items){items.add(comp)}}},onItemRemove:function(ct,comp){var me=this,items=me.items,handler=me.removeHandler;if(!me.disabled){if(handler){handler.call(me.scope||comp,comp)}if(items){items.remove(comp)}}},onContainerAdd:function(ct,preventChildren){var me=this,items,len,handleAdd=me.handleAdd,handleRemove=me.handleRemove,i,comp;if(ct.isContainer){ct.on("add",handleAdd,me);ct.on("dockedadd",handleAdd,me);ct.on("remove",handleRemove,me);ct.on("dockedremove",handleRemove,me)}if(preventChildren!==true){items=ct.query(me.selector);for(i=0,len=items.length;i<len;++i){comp=items[i];me.onItemAdd(comp.ownerCt,comp)}}items=ct.query("container");for(i=0,len=items.length;i<len;++i){me.onContainerAdd(items[i],true)}},handleRemove:function(ct,comp){var me=this;if(!me.disabled){if(comp.is(me.selector)){me.onItemRemove(ct,comp)}if(comp.isQueryable){me.onContainerRemove(ct,comp)}}},onContainerRemove:function(ct,comp){var me=this,items,i,len,item;if(!comp.isDestroyed&&!comp.destroying&&comp.isContainer){me.removeCtListeners(comp);items=comp.query(me.selector);for(i=0,len=items.length;i<len;++i){item=items[i];me.onItemRemove(item.ownerCt,item)}items=comp.query("container");for(i=0,len=items.length;i<len;++i){me.removeCtListeners(items[i])}}else{me.invalidateItems()}},removeCtListeners:function(comp){var me=this;comp.un("add",me.handleAdd,me);comp.un("dockedadd",me.handleAdd,me);comp.un("remove",me.handleRemove,me);comp.un("dockedremove",me.handleRemove,me)},getItems:function(){var me=this,items=me.items;if(!items){items=me.items=new Ext.util.MixedCollection;items.addAll(me.target.query(me.selector))}return items},invalidateItems:function(){this.items=null}});