(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");var _fixedNodesIndex=Object.create(null);sigma.classes.graph.attach("addNode","sigma.helpers.graph.addNode",function(n){if(n.fixed){_fixedNodesIndex[n.id]=this.nodesIndex[n.id]}});sigma.classes.graph.attachBefore("dropNode","sigma.helpers.graph.dropNode",function(id){delete _fixedNodesIndex[id]});sigma.classes.graph.attachBefore("clear","sigma.helpers.graph.clear",function(){var k;for(k in _fixedNodesIndex)if(!("hasOwnProperty"in _fixedNodesIndex)||_fixedNodesIndex.hasOwnProperty(k))delete _fixedNodesIndex[k];_fixedNodesIndex=Object.create(null)});if(!sigma.classes.graph.hasMethod("fixNode"))sigma.classes.graph.addMethod("fixNode",function(id){if(this.nodesIndex[id]){this.nodesIndex[id].fixed=true;_fixedNodesIndex[id]=this.nodesIndex[id]}return this});if(!sigma.classes.graph.hasMethod("unfixNode"))sigma.classes.graph.addMethod("unfixNode",function(id){if(this.nodesIndex[id]){delete this.nodesIndex[id].fixed;delete _fixedNodesIndex[id]}return this});if(!sigma.classes.graph.hasMethod("getFixedNodes"))sigma.classes.graph.addMethod("getFixedNodes",function(){var nid,nodes=[];for(nid in _fixedNodesIndex){nodes.push(this.nodesIndex[nid])}return nodes});if(!sigma.classes.graph.hasMethod("dropNodes"))sigma.classes.graph.addMethod("dropNodes",function(v){if(arguments.length>1)throw new Error("Too many arguments. Use an array instead.");if(typeof v==="string"||typeof v==="number")this.dropNode(v);else if(Array.isArray(v)){var i,l;for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number")this.dropNode(v[i]);else throw new TypeError("Invalid argument: a node id is not a string or a number, was "+v[i])}else throw new TypeError('Invalid argument: "v" is not a string, a number, or an array, was '+v);return this});if(!sigma.classes.graph.hasMethod("dropEdges"))sigma.classes.graph.addMethod("dropEdges",function(v){if(arguments.length>1)throw new Error("Too many arguments. Use an array instead.");if(typeof v==="string"||typeof v==="number")this.dropEdge(v);else if(Array.isArray(v)){var i,l;for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number")this.dropEdge(v[i]);else throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+v[i])}else throw new TypeError("Invalid argument: it is not a string, a number, or an array, was "+v);return this});if(!sigma.classes.graph.hasMethod("adjacentNodes"))sigma.classes.graph.addMethod("adjacentNodes",function(id,options){options=options||{};options.withHidden=arguments.length==2?options.withHidden:true;if(typeof id!=="string"&&typeof id!=="number")throw new TypeError("The node id is not a string or a number, was "+id);var self=this,target,edgeNotHidden,nodes=[];for(target in this.allNeighborsIndex[id]){if(options.withHidden){nodes.push(this.nodesIndex[target])}else if(!this.nodes(target).hidden){edgeNotHidden=Object.keys(this.allNeighborsIndex[id][target]).map(function(eid){return self.edges(eid)}).filter(function(e){return!e.hidden}).length!=0;if(edgeNotHidden){nodes.push(this.nodesIndex[target])}}}return nodes});if(!sigma.classes.graph.hasMethod("adjacentEdges"))sigma.classes.graph.addMethod("adjacentEdges",function(id,options){options=options||{};options.withHidden=arguments.length==2?options.withHidden:true;if(typeof id!=="string"&&typeof id!=="number")throw new TypeError("The node id is not a string or a number, was "+id);var a=this.allNeighborsIndex[id],eid,target,edges=[];for(target in a){for(eid in a[target]){if(options.withHidden||!this.edges(eid).hidden){edges.push(a[target][eid])}}}return edges})}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma.exporters.gexf: sigma is not declared";function download(fileEntry,extension,filename){var blob=null,objectUrl=null,dataUrl=null;if(window.Blob){blob=new Blob([fileEntry],{type:"text/xml"});objectUrl=window.URL.createObjectURL(blob)}else{dataUrl="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(fileEntry)}if(navigator.msSaveBlob){navigator.msSaveBlob(blob,filename)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(blob,filename)}else{var anchor=document.createElement("a");anchor.setAttribute("href",window.Blob?objectUrl:dataUrl);anchor.setAttribute("download",filename||"graph."+extension);document.body.appendChild(anchor);anchor.click();document.body.removeChild(anchor)}if(objectUrl){setTimeout(function(){window.URL.revokeObjectURL(objectUrl)},0)}}function strToObjectRef(obj,str){if(str===null)return null;return str.split(".").reduce(function(obj,i){return obj[i]},obj)}function hexToRgb(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]:null}function getDate(){var today=new Date;var dd=today.getDate();var mm=today.getMonth()+1;var yyyy=today.getFullYear();if(dd<10){dd="0"+dd}if(mm<10){mm="0"+mm}return yyyy+"-"+mm+"-"+dd}function isInteger(n){return n===+n&&n===(n|0)}function typeOf(x,type){if(type==="integer"&&typeof x==="number"){if(!isInteger(x)){type="float"}}else if(typeof x!=="number"){type="string";if(typeof x==="boolean"){type="boolean"}}return type}sigma.prototype.toGEXF=function(params){params=params||{};var doc=document.implementation.createDocument("","",null),oSerializer=new XMLSerializer,sXML="",webgl=true,prefix,nodes=this.graph.nodes(),edges=this.graph.edges();if(params.renderer){webgl=params.renderer instanceof sigma.renderers.webgl;prefix=webgl?params.renderer.camera.prefix:params.renderer.camera.readPrefix}var o,attrs,nodeAttrIndex={},nodeAttrCpt=0,edgeAttrIndex={},edgeAttrCpt=0,attrDefElem,attrsElem,attrElem,nodeAttrsDefElem,edgeAttrsDefElem,colorElem,creatorElem,descriptionElem,edgesElem,edgeElem,graphElem,metaElem,nodesElem,nodeElem,rootElem,positionElem,sizeElem,textElem;rootElem=doc.createElement("gexf");rootElem.setAttribute("xmlns","http://www.gexf.net/1.2draft");rootElem.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz");rootElem.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");rootElem.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd");rootElem.setAttribute("version","1.2");metaElem=doc.createElement("meta");metaElem.setAttribute("lastmodifieddate",getDate());if(params.creator){creatorElem=doc.createElement("creator");textElem=doc.createTextNode(""+params.creator);creatorElem.appendChild(textElem);metaElem.appendChild(creatorElem)}if(params.description){descriptionElem=doc.createElement("description");textElem=doc.createTextNode(""+params.description);descriptionElem.appendChild(textElem);metaElem.appendChild(descriptionElem)}graphElem=doc.createElement("graph");graphElem.setAttribute("mode","static");nodesElem=doc.createElement("nodes");for(var i=0;i<nodes.length;i++){o=nodes[i];nodeElem=doc.createElement("node");nodeElem.setAttribute("id",o.id);if(o.label)nodeElem.setAttribute("label",o.label);attrs=strToObjectRef(o,params.nodeAttributes);if(attrs){attrsElem=doc.createElement("attvalues");Object.keys(attrs).forEach(function(k){if(!(k in nodeAttrIndex)){nodeAttrIndex[k]={id:nodeAttrCpt,type:"integer"};nodeAttrCpt++}var v=attrs[k];nodeAttrIndex[k].type=typeOf(v,nodeAttrIndex[k].type);attrElem=doc.createElement("attvalue");attrElem.setAttribute("for",nodeAttrIndex[k].id);attrElem.setAttribute("value",v);attrsElem.appendChild(attrElem)});nodeElem.appendChild(attrsElem)}if(params.renderer){if(o.color){var rgb;if(o.color[0]==="#"){rgb=hexToRgb(o.color)}else{rgb=o.color.match(/\d+/g)}if(rgb.length>2){colorElem=doc.createElement("viz:color");colorElem.setAttribute("r",rgb[0]);colorElem.setAttribute("g",rgb[1]);colorElem.setAttribute("b",rgb[2]);if(rgb.length>3){if(rgb.length===5)colorElem.setAttribute("a",rgb[3]+"."+rgb[4]);else colorElem.setAttribute("a",rgb[3])}nodeElem.appendChild(colorElem)}}positionElem=doc.createElement("viz:position");positionElem.setAttribute("x",o[prefix+"x"]);positionElem.setAttribute("y",-parseInt(o[prefix+"y"],10));nodeElem.appendChild(positionElem);if(o.size){sizeElem=doc.createElement("viz:size");sizeElem.setAttribute("value",o[prefix+"size"]);nodeElem.appendChild(sizeElem)}}nodesElem.appendChild(nodeElem)}nodeAttrsDefElem=doc.createElement("attributes");nodeAttrsDefElem.setAttribute("class","node");Object.keys(nodeAttrIndex).forEach(function(k){attrDefElem=doc.createElement("attribute");attrDefElem.setAttribute("id",nodeAttrIndex[k].id);attrDefElem.setAttribute("title",k);attrDefElem.setAttribute("type",nodeAttrIndex[k].type);nodeAttrsDefElem.appendChild(attrDefElem)});edgesElem=doc.createElement("edges");for(var i=0;i<edges.length;i++){o=edges[i];edgeElem=doc.createElement("edge");edgeElem.setAttribute("id",o.id);edgeElem.setAttribute("source",o.source);edgeElem.setAttribute("target",o.target);if(o.size){edgeElem.setAttribute("weight",o.size)}if(o.label)edgeElem.setAttribute("label",o.label);attrs=strToObjectRef(o,params.edgeAttributes);if(attrs){attrsElem=doc.createElement("attvalues");Object.keys(attrs).forEach(function(k){if(!(k in edgeAttrIndex)){edgeAttrIndex[k]={id:edgeAttrCpt,type:"integer"};edgeAttrCpt++}var v=attrs[k];edgeAttrIndex[k].type=typeOf(v,edgeAttrIndex[k].type);attrElem=doc.createElement("attvalue");attrElem.setAttribute("for",edgeAttrIndex[k].id);attrElem.setAttribute("value",v);attrsElem.appendChild(attrElem)});edgeElem.appendChild(attrsElem)}if(params.renderer){if(o.color){var rgb;if(o.color[0]==="#"){rgb=hexToRgb(o.color)}else{rgb=o.color.match(/\d+/g)}if(rgb.length>2&&rgb.length<=5){colorElem=doc.createElement("viz:color");colorElem.setAttribute("r",rgb[0]);colorElem.setAttribute("g",rgb[1]);colorElem.setAttribute("b",rgb[2]);edgeElem.appendChild(colorElem)}}if(o.size){sizeElem=doc.createElement("viz:size");sizeElem.setAttribute("value",o.size);edgeElem.appendChild(sizeElem)}}edgesElem.appendChild(edgeElem)}edgeAttrsDefElem=doc.createElement("attributes");edgeAttrsDefElem.setAttribute("class","edge");Object.keys(edgeAttrIndex).forEach(function(k){attrDefElem=doc.createElement("attribute");attrDefElem.setAttribute("id",edgeAttrIndex[k].id);attrDefElem.setAttribute("title",k);attrDefElem.setAttribute("type",edgeAttrIndex[k].type);edgeAttrsDefElem.appendChild(attrDefElem)});graphElem.appendChild(nodeAttrsDefElem);graphElem.appendChild(edgeAttrsDefElem);graphElem.appendChild(nodesElem);graphElem.appendChild(edgesElem);rootElem.appendChild(metaElem);rootElem.appendChild(graphElem);doc.appendChild(rootElem);sXML=oSerializer.serializeToString(doc);if(params.download){download(sXML,"gexf",params.filename)}if(attrDefElem)attrDefElem.parentNode.removeChild(attrDefElem);if(attrsElem)attrsElem.parentNode.removeChild(attrsElem);if(attrElem)attrElem.parentNode.removeChild(attrElem);if(colorElem)colorElem.parentNode.removeChild(colorElem);if(creatorElem)creatorElem.parentNode.removeChild(creatorElem);if(descriptionElem)descriptionElem.parentNode.removeChild(descriptionElem);if(textElem)textElem.parentNode.removeChild(textElem);if(positionElem)positionElem.parentNode.removeChild(positionElem);if(sizeElem)sizeElem.parentNode.removeChild(sizeElem);if(nodeElem)nodeElem.parentNode.removeChild(nodeElem);if(edgeElem)edgeElem.parentNode.removeChild(edgeElem);if(nodeAttrsDefElem)nodeAttrsDefElem.parentNode.removeChild(nodeAttrsDefElem);if(edgeAttrsDefElem)edgeAttrsDefElem.parentNode.removeChild(edgeAttrsDefElem);if(nodesElem)nodesElem.parentNode.removeChild(nodesElem);if(edgesElem)edgesElem.parentNode.removeChild(edgesElem);if(graphElem)graphElem.parentNode.removeChild(graphElem);if(metaElem)metaElem.parentNode.removeChild(metaElem);if(rootElem)rootElem.parentNode.removeChild(rootElem);doc=null;return sXML}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");function download(fileEntry,extension,filename){var blob=null,objectUrl=null,dataUrl=null;if(window.Blob){blob=new Blob([fileEntry],{type:"text/xml"});objectUrl=window.URL.createObjectURL(blob)}else{dataUrl="data:text/csv;charset=UTF-8,"+encodeURIComponent(fileEntry)}if(navigator.msSaveBlob){navigator.msSaveBlob(blob,filename)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(blob,filename)}else{var anchor=document.createElement("a");anchor.setAttribute("href",window.Blob?objectUrl:dataUrl);anchor.setAttribute("download",filename||"graph."+extension);document.body.appendChild(anchor);anchor.click();document.body.removeChild(anchor)}if(objectUrl){setTimeout(function(){window.URL.revokeObjectURL(objectUrl)},0)}}function escape(x,separator){if(x===null||x===undefined)return separator+separator;if(typeof x==="function")return x.toString();x=typeof x==="string"?x:JSON.stringify(x);x=x.replace(/\s+/g," ");if(separator&&separator.length){return separator+x.replace(separator,separator==='"'?"'":'"')+separator}return x}function strToObjectRef(obj,str){if(str===null||str===undefined)return null;return str.split(".").reduce(function(obj,i){return obj[i]},obj)}sigma.prototype.toSpreadsheet=function(params){params=params||{};params.separator=params.separator||",";params.textSeparator=params.textSeparator||"";if(params.textSeparator&&params.textSeparator!=='"'&&params.textSeparator!=="'")throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+params.textSeparator);var rows=[],index={},attributesArr=[],cpt=0,data,attributes,categories,categoriesColName=params.categoriesName||"categories",o,arr,extraCol;if(!params.what)throw new TypeError('Missing argument: "what".');if(params.what==="nodes"){if(params.which)data=this.graph.nodes(params.which);else data=this.graph.nodes()}else if(params.what==="edges"){if(params.which)data=this.graph.edges(params.which);else data=this.graph.edges()}else throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+params.what);index["id"]=cpt++;attributesArr.push(escape("id",params.textSeparator));if(params.what==="edges"){index["source"]=cpt++;attributesArr.push(escape("source",params.textSeparator));index["target"]=cpt++;attributesArr.push(escape("target",params.textSeparator))}extraCol=params.categories&&params.categories.length;if(extraCol){index["categories"]=cpt++;attributesArr.push(escape(categoriesColName,params.textSeparator))}for(var i=0;i<data.length;i++){o=data[i];attributes=strToObjectRef(o,params.attributes)||{};Object.keys(attributes).forEach(function(k){if(!(k in index)){index[k]=cpt++;attributesArr.push(escape(k,params.textSeparator))}})}rows.push(attributesArr);for(var i=0;i<data.length;i++){o=data[i];arr=[];arr.length=cpt;arr[0]=escape(o.id,params.textSeparator);if(params.what==="edges"){arr[1]=escape(o.source,params.textSeparator);arr[2]=escape(o.target,params.textSeparator)}if(extraCol){categories=strToObjectRef(o,params.categories);if(Array.isArray(categories)){categories=categories.join(",")}arr[index["categories"]]=escape(categories,params.textSeparator)}attributes=strToObjectRef(o,params.attributes)||{};Object.keys(attributes).forEach(function(k){arr[index[k]]=escape(attributes[k],params.textSeparator)});rows.push(arr)}var serialized=rows.map(function(arr){return arr.join(params.separator)}).join("\n");if(params.download){download(serialized,"csv",params.filename)}return serialized}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma.renderers.snapshot: sigma not in scope.";var URL=this.URL||this.webkitURL||this;function createBlob(data){return new Blob([data],{type:"image/svg+xml;charset=utf-8"})}function download(string,filename){if(typeof safari!=="undefined"){var msg="File download does not work in Safari. Please use a modern web browser such as Firefox, Chrome, or Internet Explorer 11.";alert(msg);throw new Error(msg)}var blob=createBlob(string),objectUrl=window.URL.createObjectURL(blob);if(navigator.msSaveBlob){navigator.msSaveBlob(blob,filename)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(blob,filename)}else{var anchor=document.createElement("a");anchor.setAttribute("href",objectUrl);anchor.setAttribute("download",filename);document.body.appendChild(anchor);anchor.click();document.body.removeChild(anchor)}setTimeout(function(){window.URL.revokeObjectURL(objectUrl)},0)}var DEFAULTS={size:"1000",width:"1000",height:"1000",classes:true,labels:true,data:false,download:false,filename:"graph.svg"};var XMLNS="http://www.w3.org/2000/svg";function optimize(svg,prefix,params){var nodeColorIndex={},edgeColorIndex={},count=0,color,style,styleText="",f,i,l;if(params.classes){style=document.createElementNS(XMLNS,"style");svg.insertBefore(style,svg.firstChild)}var nodes=svg.querySelectorAll('[id="'+prefix+'-group-nodes"] > [class="'+prefix+'-node"]');for(i=0,l=nodes.length,f=true;i<l;i++){color=nodes[i].getAttribute("fill");if(!params.data)nodes[i].removeAttribute("data-node-id");if(params.classes){if(!(color in nodeColorIndex)){nodeColorIndex[color]=f?prefix+"-node":"c-"+count++;styleText+="."+nodeColorIndex[color]+"{fill: "+color+"}"}if(nodeColorIndex[color]!==prefix+"-node")nodes[i].setAttribute("class",nodes[i].getAttribute("class")+" "+nodeColorIndex[color]);nodes[i].removeAttribute("fill")}f=false}var edges=svg.querySelectorAll('[id="'+prefix+'-group-edges"] > [class="'+prefix+'-edge"]');for(i=0,l=edges.length,f=true;i<l;i++){color=edges[i].getAttribute("stroke");if(!params.data)edges[i].removeAttribute("data-edge-id");if(params.classes){if(!(color in edgeColorIndex)){edgeColorIndex[color]=f?prefix+"-edge":"c-"+count++;styleText+="."+edgeColorIndex[color]+"{stroke: "+color+"}"}if(edgeColorIndex[color]!==prefix+"-edge")edges[i].setAttribute("class",edges[i].getAttribute("class")+" "+edgeColorIndex[color]);edges[i].removeAttribute("stroke")}f=false}if(params.classes)style.appendChild(document.createTextNode(styleText))}sigma.prototype.toSVG=function(params){params=params||{};var prefix=this.settings("classPrefix"),w=params.size||params.width||DEFAULTS.size,h=params.size||params.height||DEFAULTS.size;var container=document.createElement("div");container.setAttribute("width",w);container.setAttribute("height",h);container.setAttribute("style","position:absolute; top: 0px; left:0px; width: "+w+"px; height: "+h+"px;");var camera=this.addCamera();var renderer=this.addRenderer({camera:camera,container:container,type:"svg",forceLabels:!!params.labels});renderer.resize(w,h);this.refresh();this.killRenderer(renderer);this.killCamera(camera);var svg=container.querySelector("svg");svg.removeAttribute("style");svg.setAttribute("width",w+"px");svg.setAttribute("height",h+"px");svg.setAttribute("x","0px");svg.setAttribute("y","0px");if(!params.labels){var labelGroup=svg.querySelector('[id="'+prefix+'-group-labels"]');svg.removeChild(labelGroup)}var hoverGroup=svg.querySelector('[id="'+prefix+'-group-hovers"]');svg.removeChild(hoverGroup);params.classes=params.classes!==false;if(!params.data||params.classes)optimize(svg,prefix,params);var svgString=svg.outerHTML;container=null;var output='<?xml version="1.0" encoding="utf-8"?>\n';output+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n';output+=svgString;if(params.download)download(output,params.filename||DEFAULTS.filename);return output}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");if(typeof dagre==="undefined"||typeof dagre.graphlib==="undefined")console.warn("to use the xlx plugin, you have to include the XLSX library");function downloadBlob(blob,extension,filename){var objectUrl=window.URL.createObjectURL(blob);if(navigator.msSaveBlob){navigator.msSaveBlob(blob,filename)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(blob,filename)}else{var anchor=document.createElement("a");anchor.setAttribute("href",objectUrl);anchor.setAttribute("download",filename||"graph."+extension);document.body.appendChild(anchor);anchor.click();document.body.removeChild(anchor)}setTimeout(function(){window.URL.revokeObjectURL(objectUrl)},0)}function s2ab(s){var buf=new ArrayBuffer(s.length);var view=new Uint8Array(buf);for(var i=0;i!=s.length;++i)view[i]=s.charCodeAt(i)&255;return buf}function format(x){if(x===null||x===undefined)return"";if(typeof x==="string"||typeof x==="number")return x;if(typeof x==="function")return x.toString();return JSON.stringify(x)}function formatCategories(x){if(x===null||x===undefined)return"";if(typeof x==="string"||typeof x==="number")return x;if(Array.isArray(x))return x.join(",");if(typeof x==="function")return x.toString();return JSON.stringify(x)}function strToObjectRef(obj,str){if(str===null||str===undefined)return null;return str.split(".").reduce(function(obj,i){return obj[i]},obj)}function Workbook(){if(!(this instanceof Workbook))return new Workbook;this.SheetNames=[];this.Sheets={}}function datenum(v,date1904){if(date1904)v+=1462;var epoch=Date.parse(v);return(epoch-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function sheet(data,opts){var ws={};var range={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(var R=0;R!=data.length;++R){for(var C=0;C!=data[R].length;++C){if(range.s.r>R)range.s.r=R;if(range.s.c>C)range.s.c=C;if(range.e.r<R)range.e.r=R;if(range.e.c<C)range.e.c=C;var cell={v:data[R][C]};if(cell.v==null)continue;var cell_ref=XLSX.utils.encode_cell({c:C,r:R});if(typeof cell.v==="number")cell.t="n";else if(typeof cell.v==="boolean")cell.t="b";else if(cell.v instanceof Date){cell.t="n";cell.z=XLSX.SSF._table[14];cell.v=datenum(cell.v)}else cell.t="s";ws[cell_ref]=cell}}if(range.s.c<1e7)ws["!ref"]=XLSX.utils.encode_range(range);return ws}function toArray(data,params){var cpt=0,index={},attributesArr=[],attributes,attributesPath=params.nodesAttributes,categoryPath=params.nodesCategories,categoriesColName=params.nodesCategoriesName||"categories",o,arr,extraCol=0,rows=[];if(params.what==="edges"){attributesPath=params.edgesAttributes;categoryPath=params.edgesCategories;categoriesColName=params.edgesCategoriesName||"categories"}extraCol=categoryPath&&categoryPath.length?1:0;index["id"]=cpt++;attributesArr.push("id");if(params.what==="edges"){index["source"]=cpt++;attributesArr.push("source");index["target"]=cpt++;attributesArr.push("target")}if(extraCol){cpt++;attributesArr.push(categoriesColName)}for(var i=0;i<data.length;i++){o=data[i];attributes=strToObjectRef(o,attributesPath)||{};Object.keys(attributes).forEach(function(k){if(!(k in index)){index[k]=cpt++;attributesArr.push(format(k))}})}rows.push(attributesArr);for(var i=0;i<data.length;i++){o=data[i];arr=[];arr.length=cpt;arr[0]=format(o.id);if(params.what==="edges"){arr[1]=format(o.source);arr[2]=format(o.target);if(extraCol){arr[3]=formatCategories(strToObjectRef(o,categoryPath))}}else if(extraCol){arr[1]=formatCategories(strToObjectRef(o,categoryPath))}attributes=strToObjectRef(o,attributesPath)||{};Object.keys(attributes).forEach(function(k){arr[index[k]]=format(attributes[k])});rows.push(arr)}return rows}sigma.prototype.toXLSX=function(params){if(typeof XLSX==="undefined")throw new Error("XLSX is not declared");params=params||{};var wb=new Workbook,wsNodes,wsEdges,data;if(!params.what){params.what="nodes";wsNodes=sheet(toArray(this.graph.nodes(),params));params.what="edges";wsEdges=sheet(toArray(this.graph.edges(),params))}else{if(params.what==="nodes"){if(params.which)data=this.graph.nodes(params.which);else data=this.graph.nodes();wsNodes=sheet(toArray(data,params))}else if(params.what==="edges"){if(params.which)data=this.graph.edges(params.which);else data=this.graph.edges();wsEdges=sheet(toArray(data,params))}else throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+params.what)}if(wsNodes){wb.SheetNames.push("Nodes");wb.Sheets["Nodes"]=wsNodes}if(wsEdges){wb.SheetNames.push("Edges");wb.Sheets["Edges"]=wsEdges}var wbout=XLSX.write(wb,{bookType:"xlsx",bookSST:false,type:"binary"});var blob=new Blob([s2ab(wbout)],{type:""});downloadBlob(blob,"xlsx",params.filename)}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");if(typeof dagre==="undefined"||typeof dagre.graphlib==="undefined")console.warn("to use the dagre plugin, "+"you have to include dagre and dagre.graphlib");sigma.utils.pkg("sigma.layouts.dagre");var settings={directed:true,multigraph:true,compound:false,rankDir:"TB"};var _instance={};var _eventEmitter={};function getBoundaries(nodes,prefix){var i,l,prefix=prefix||"",sizeMax=-Infinity,minX=Infinity,minY=Infinity,maxX=-Infinity,maxY=-Infinity;for(i=0,l=nodes.length;i<l;i++){sizeMax=Math.max(nodes[i][prefix+"size"],sizeMax);maxX=Math.max(nodes[i][prefix+"x"],maxX);minX=Math.min(nodes[i][prefix+"x"],minX);maxY=Math.max(nodes[i][prefix+"y"],maxY);minY=Math.min(nodes[i][prefix+"y"],minY)}sizeMax=sizeMax||1;return{sizeMax:sizeMax,minX:minX,minY:minY,maxX:maxX,maxY:maxY}}function scaleRange(value,baseMin,baseMax,limitMin,limitMax){return(limitMax-limitMin)*(value-baseMin)/(baseMax-baseMin)+limitMin}function rescalePosition(point,baseBox,limitBox){return{x:scaleRange(point.x,baseBox.minX,baseBox.maxX,limitBox.minX,limitBox.maxX),y:scaleRange(point.y,baseBox.minY,baseBox.maxY,limitBox.minY,limitBox.maxY)}}function dagreLayout(){if(typeof dagre==="undefined")throw new Error("dagre is not declared");if(typeof dagre.graphlib==="undefined")throw new Error("dagre.graphlib is not declared");var self=this,dg;this.init=function(sigInst,options){options=options||{};if(options.nodes){this.nodes=options.nodes;delete options.nodes}if(options.boundingBox){this.boundingBox=options.boundingBox;delete options.boundingBox}this.sigInst=sigInst;this.config=sigma.utils.extend(options,settings);this.easing=options.easing;this.duration=options.duration;if(this.easing&&(!sigma.plugins||typeof sigma.plugins.animate==="undefined")){throw new Error("sigma.plugins.animate is not declared")}this.running=false};this.start=function(){if(this.running)return;this.running=true;dg=new dagre.graphlib.Graph({directed:this.config.directed,multigraph:this.config.multigraph,compound:this.config.compound});dg.setGraph(this.config);var nodes=this.nodes||this.sigInst.graph.nodes();for(var i=0;i<nodes.length;i++){if(!nodes[i].fixed){dg.setNode(nodes[i].id,{})}}if(this.boundingBox===true){this.boundingBox=getBoundaries(nodes)}var edges=this.sigInst.graph.edges();for(var i=0;i<edges.length;i++){if(dg.node(edges[i].source)!=null&&dg.node(edges[i].target)!=null){dg.setEdge(edges[i].source,edges[i].target,{id:edges[i].id})}}_eventEmitter[self.sigInst.id].dispatchEvent("start");dagre.layout(dg);var edge;dg.edges().map(function(e){edge=self.sigInst.graph.edges(dg.edge(e).id);edge.points=dg.edge(e).points});this.stop()};this.stop=function(){if(!dg)return;var nodes=dg.nodes().map(function(nid){return self.sigInst.graph.nodes(nid)});var coord;if(this.boundingBox){var baseBoundingBox=getBoundaries(dg.nodes().map(function(nid){return dg.node(nid)}))}this.running=false;if(this.easing){for(var i=0;i<nodes.length;i++){if(this.boundingBox){coord=rescalePosition(dg.node(nodes[i].id),baseBoundingBox,self.boundingBox);nodes[i].dagre_x=coord.x;nodes[i].dagre_y=coord.y}else{nodes[i].dagre_x=dg.node(nodes[i].id).x;nodes[i].dagre_y=dg.node(nodes[i].id).y}}_eventEmitter[self.sigInst.id].dispatchEvent("interpolate");sigma.plugins.animate(self.sigInst,{x:"dagre_x",y:"dagre_y"},{nodes:nodes,easing:self.easing,onComplete:function(){for(var i=0;i<nodes.length;i++){nodes[i].dagre_x=null;nodes[i].dagre_y=null}_eventEmitter[self.sigInst.id].dispatchEvent("stop");self.sigInst.refresh()},duration:self.duration})}else{var node;dg.nodes().forEach(function(nid){node=self.sigInst.graph.nodes(nid);node.x=dg.node(nid).x;node.y=dg.node(nid).y});_eventEmitter[self.sigInst.id].dispatchEvent("stop");this.sigInst.refresh()}};this.kill=function(){this.sigInst=null;this.config=null;this.easing=null}}sigma.layouts.dagre.configure=function(sigInst,config){if(!sigInst)throw new Error('Missing argument: "sigInst"');if(!config)throw new Error('Missing argument: "config"');if(!_instance[sigInst.id]){_instance[sigInst.id]=new dagreLayout;_eventEmitter[sigInst.id]={};sigma.classes.dispatcher.extend(_eventEmitter[sigInst.id]);sigInst.bind("kill",function(){_instance[sigInst.id].kill();_instance[sigInst.id]=null;_eventEmitter[sigInst.id]=null})}_instance[sigInst.id].init(sigInst,config);return _eventEmitter[sigInst.id]};sigma.layouts.dagre.start=function(sigInst,config){if(!sigInst)throw new Error('Missing argument: "sigInst"');if(config){this.configure(sigInst,config)}_instance[sigInst.id].start();return _eventEmitter[sigInst.id]};sigma.layouts.dagre.isRunning=function(sigInst){if(!sigInst)throw new Error('Missing argument: "sigInst"');return!!_instance[sigInst.id]&&_instance[sigInst.id].running}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";var _root=this;var webWorkers="Worker"in _root;function Supervisor(sigInst,options){var _this=this,workerFn=sigInst.getForceAtlas2Worker&&sigInst.getForceAtlas2Worker();options=options||{};_root.URL=_root.URL||_root.webkitURL;this.sigInst=sigInst;this.graph=this.sigInst.graph;this.ppn=10;this.ppe=3;this.config={};this.shouldUseWorker=options.worker===false?false:true&&webWorkers;this.workerUrl=options.workerUrl;this.started=false;this.running=false;if(this.shouldUseWorker){if(!this.workerUrl){var blob=this.makeBlob(workerFn);this.worker=new Worker(URL.createObjectURL(blob))}else{this.worker=new Worker(this.workerUrl)}this.worker.postMessage=this.worker.webkitPostMessage||this.worker.postMessage}else{eval(workerFn)}this.msgName=this.worker?"message":"newCoords";this.listener=function(e){_this.nodesByteArray=new Float32Array(e.data.nodes);if(_this.running){_this.applyLayoutChanges();_this.sendByteArrayToWorker();_this.sigInst.refresh()}};(this.worker||document).addEventListener(this.msgName,this.listener);this.graphToByteArrays();sigInst.bind("kill",function(){sigInst.killForceAtlas2()})}Supervisor.prototype.makeBlob=function(workerFn){var blob;try{blob=new Blob([workerFn],{type:"application/javascript"})}catch(e){_root.BlobBuilder=_root.BlobBuilder||_root.WebKitBlobBuilder||_root.MozBlobBuilder;blob=new BlobBuilder;blob.append(workerFn);blob=blob.getBlob()}return blob};Supervisor.prototype.graphToByteArrays=function(){var nodes=this.graph.nodes(),edges=this.graph.edges(),nbytes=nodes.length*this.ppn,ebytes=edges.length*this.ppe,nIndex={},i,j,l;this.nodesByteArray=new Float32Array(nbytes);this.edgesByteArray=new Float32Array(ebytes);for(i=j=0,l=nodes.length;i<l;i++){nIndex[nodes[i].id]=j;this.nodesByteArray[j]=nodes[i].x;this.nodesByteArray[j+1]=nodes[i].y;this.nodesByteArray[j+2]=0;this.nodesByteArray[j+3]=0;this.nodesByteArray[j+4]=0;this.nodesByteArray[j+5]=0;this.nodesByteArray[j+6]=1+this.graph.degree(nodes[i].id);this.nodesByteArray[j+7]=1;this.nodesByteArray[j+8]=nodes[i].size;this.nodesByteArray[j+9]=0;j+=this.ppn}for(i=j=0,l=edges.length;i<l;i++){this.edgesByteArray[j]=nIndex[edges[i].source];this.edgesByteArray[j+1]=nIndex[edges[i].target];this.edgesByteArray[j+2]=edges[i].weight||0;j+=this.ppe}};Supervisor.prototype.applyLayoutChanges=function(){var nodes=this.graph.nodes(),j=0,realIndex;for(var i=0,l=this.nodesByteArray.length;i<l;i+=this.ppn){nodes[j].x=this.nodesByteArray[i];nodes[j].y=this.nodesByteArray[i+1];j++}};Supervisor.prototype.sendByteArrayToWorker=function(action){var content={action:action||"loop",nodes:this.nodesByteArray.buffer};var buffers=[this.nodesByteArray.buffer];if(action==="start"){content.config=this.config||{};content.edges=this.edgesByteArray.buffer;buffers.push(this.edgesByteArray.buffer)}if(this.shouldUseWorker)this.worker.postMessage(content,buffers);else _root.postMessage(content,"*")};Supervisor.prototype.start=function(){
if(this.running)return;this.running=true;var k,c;for(k in this.sigInst.cameras){c=this.sigInst.cameras[k];c.edgequadtree._enabled=false}if(!this.started){this.sendByteArrayToWorker("start");this.started=true}else{this.sendByteArrayToWorker()}};Supervisor.prototype.stop=function(){if(!this.running)return;var k,c,bounds;for(k in this.sigInst.cameras){c=this.sigInst.cameras[k];c.edgequadtree._enabled=true;bounds=sigma.utils.getBoundaries(this.graph,c.readPrefix);if(c.settings("drawEdges")&&c.settings("enableEdgeHovering"))c.edgequadtree.index(this.sigInst.graph,{prefix:c.readPrefix,bounds:{x:bounds.minX,y:bounds.minY,width:bounds.maxX-bounds.minX,height:bounds.maxY-bounds.minY}})}this.running=false};Supervisor.prototype.killWorker=function(){if(this.worker){this.worker.terminate()}else{_root.postMessage({action:"kill"},"*");document.removeEventListener(this.msgName,this.listener)}};Supervisor.prototype.configure=function(config){this.config=config;if(!this.started)return;var data={action:"config",config:this.config};if(this.shouldUseWorker)this.worker.postMessage(data);else _root.postMessage(data,"*")};sigma.prototype.startForceAtlas2=function(config){if(!this.supervisor)this.supervisor=new Supervisor(this,config);if(config)this.supervisor.configure(config);this.supervisor.start();return this};sigma.prototype.stopForceAtlas2=function(){if(!this.supervisor)return this;this.supervisor.stop();return this};sigma.prototype.killForceAtlas2=function(){if(!this.supervisor)return this;this.supervisor.stop();this.supervisor.killWorker();this.supervisor=null;return this};sigma.prototype.configForceAtlas2=function(config){if(!this.supervisor)this.supervisor=new Supervisor(this,config);this.supervisor.configure(config);return this};sigma.prototype.isForceAtlas2Running=function(config){return!!this.supervisor&&this.supervisor.running}}).call(this);(function(undefined){"use strict";var _root=this,inWebWorker=!("document"in _root);var Worker=function(undefined){"use strict";var W={ppn:10,ppe:3,ppr:9,maxForce:10,iterations:0,converged:false,settings:{linLogMode:false,outboundAttractionDistribution:false,adjustSizes:false,edgeWeightInfluence:0,scalingRatio:1,strongGravityMode:false,gravity:1,slowDown:1,barnesHutOptimize:false,barnesHutTheta:.5,startingIterations:1,iterationsPerRender:1}};var NodeMatrix,EdgeMatrix,RegionMatrix;function extend(){var i,k,res={},l=arguments.length;for(i=l-1;i>=0;i--)for(k in arguments[i])res[k]=arguments[i][k];return res}function __emptyObject(obj){var k;for(k in obj)if(!("hasOwnProperty"in obj)||obj.hasOwnProperty(k))delete obj[k];return obj}var nodeProperties={x:0,y:1,dx:2,dy:3,old_dx:4,old_dy:5,mass:6,convergence:7,size:8,fixed:9};var edgeProperties={source:0,target:1,weight:2};var regionProperties={node:0,centerX:1,centerY:2,size:3,nextSibling:4,firstChild:5,mass:6,massCenterX:7,massCenterY:8};function np(i,p){if(i%W.ppn!==0)throw"np: non correct ("+i+").";if(i!==parseInt(i))throw"np: non int.";if(p in nodeProperties)return i+nodeProperties[p];else throw"ForceAtlas2.Worker - "+"Inexistant node property given ("+p+")."}function ep(i,p){if(i%W.ppe!==0)throw"ep: non correct ("+i+").";if(i!==parseInt(i))throw"ep: non int.";if(p in edgeProperties)return i+edgeProperties[p];else throw"ForceAtlas2.Worker - "+"Inexistant edge property given ("+p+")."}function rp(i,p){if(i%W.ppr!==0)throw"rp: non correct ("+i+").";if(i!==parseInt(i))throw"rp: non int.";if(p in regionProperties)return i+regionProperties[p];else throw"ForceAtlas2.Worker - "+"Inexistant region property given ("+p+")."}function nan(v){if(isNaN(v))throw"NaN alert!"}function init(nodes,edges,config){config=config||{};var i,l;NodeMatrix=nodes;EdgeMatrix=edges;W.nodesLength=NodeMatrix.length;W.edgesLength=EdgeMatrix.length;configure(config)}function configure(o){W.settings=extend(o,W.settings)}function pass(){var a,i,j,l,r,n,n1,n2,e,w,g,k,m;var outboundAttCompensation,coefficient,xDist,yDist,ewc,mass,distance,size,factor;for(n=0;n<W.nodesLength;n+=W.ppn){NodeMatrix[np(n,"old_dx")]=NodeMatrix[np(n,"dx")];NodeMatrix[np(n,"old_dy")]=NodeMatrix[np(n,"dy")];NodeMatrix[np(n,"dx")]=0;NodeMatrix[np(n,"dy")]=0}if(W.settings.outboundAttractionDistribution){outboundAttCompensation=0;for(n=0;n<W.nodesLength;n+=W.ppn){outboundAttCompensation+=NodeMatrix[np(n,"mass")]}outboundAttCompensation/=W.nodesLength}if(W.settings.barnesHutOptimize){var minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity,q,q0,q1,q2,q3;RegionMatrix=[];for(n=0;n<W.nodesLength;n+=W.ppn){minX=Math.min(minX,NodeMatrix[np(n,"x")]);maxX=Math.max(maxX,NodeMatrix[np(n,"x")]);minY=Math.min(minY,NodeMatrix[np(n,"y")]);maxY=Math.max(maxY,NodeMatrix[np(n,"y")])}RegionMatrix[rp(0,"node")]=-1;RegionMatrix[rp(0,"centerX")]=(minX+maxX)/2;RegionMatrix[rp(0,"centerY")]=(minY+maxY)/2;RegionMatrix[rp(0,"size")]=Math.max(maxX-minX,maxY-minY);RegionMatrix[rp(0,"nextSibling")]=-1;RegionMatrix[rp(0,"firstChild")]=-1;RegionMatrix[rp(0,"mass")]=0;RegionMatrix[rp(0,"massCenterX")]=0;RegionMatrix[rp(0,"massCenterY")]=0;l=1;for(n=0;n<W.nodesLength;n+=W.ppn){r=0;while(true){if(RegionMatrix[rp(r,"firstChild")]>=0){if(NodeMatrix[np(n,"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}RegionMatrix[rp(r,"massCenterX")]=(RegionMatrix[rp(r,"massCenterX")]*RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"x")]*NodeMatrix[np(n,"mass")])/(RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"mass")]);RegionMatrix[rp(r,"massCenterY")]=(RegionMatrix[rp(r,"massCenterY")]*RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"y")]*NodeMatrix[np(n,"mass")])/(RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"mass")]);RegionMatrix[rp(r,"mass")]+=NodeMatrix[np(n,"mass")];r=q;continue}else{if(RegionMatrix[rp(r,"node")]<0){RegionMatrix[rp(r,"node")]=n;break}else{RegionMatrix[rp(r,"firstChild")]=l*W.ppr;w=RegionMatrix[rp(r,"size")]/2;g=RegionMatrix[rp(r,"firstChild")];RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]-w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]-w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]-w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]+w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]+w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]-w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]+w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]+w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=RegionMatrix[rp(r,"nextSibling")];RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;l+=4;if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}RegionMatrix[rp(r,"mass")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")];RegionMatrix[rp(r,"massCenterX")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")];RegionMatrix[rp(r,"massCenterY")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")];RegionMatrix[rp(q,"node")]=RegionMatrix[rp(r,"node")];RegionMatrix[rp(r,"node")]=-1;if(NodeMatrix[np(n,"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q2=RegionMatrix[rp(r,"firstChild")]}else{q2=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q2=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q2=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}if(q===q2){r=q;continue}RegionMatrix[rp(q2,"node")]=n;break}}}}}if(W.settings.barnesHutOptimize){coefficient=W.settings.scalingRatio;for(n=0;n<W.nodesLength;n+=W.ppn){r=0;while(true){if(RegionMatrix[rp(r,"firstChild")]>=0){distance=Math.sqrt(Math.pow(NodeMatrix[np(n,"x")]-RegionMatrix[rp(r,"massCenterX")],2)+Math.pow(NodeMatrix[np(n,"y")]-RegionMatrix[rp(r,"massCenterY")],2));if(2*RegionMatrix[rp(r,"size")]/distance<W.settings.barnesHutTheta){xDist=NodeMatrix[np(n,"x")]-RegionMatrix[rp(r,"massCenterX")];yDist=NodeMatrix[np(n,"y")]-RegionMatrix[rp(r,"massCenterY")];if(W.settings.adjustSize){if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}else if(distance<0){factor=-coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}else{if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}if(RegionMatrix[rp(r,"nextSibling")]<0)break;r=RegionMatrix[rp(r,"nextSibling")];continue}else{r=RegionMatrix[rp(r,"firstChild")];continue}}else{if(RegionMatrix[rp(r,"node")]>=0&&RegionMatrix[rp(r,"node")]!==n){xDist=NodeMatrix[np(n,"x")]-NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")];yDist=NodeMatrix[np(n,"y")]-NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")];distance=Math.sqrt(xDist*xDist+yDist*yDist);if(W.settings.adjustSize){if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}else if(distance<0){factor=-coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}else{if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}}if(RegionMatrix[rp(r,"nextSibling")]<0)break;r=RegionMatrix[rp(r,"nextSibling")];continue}}}}else{coefficient=W.settings.scalingRatio;for(n1=0;n1<W.nodesLength;n1+=W.ppn){for(n2=0;n2<n1;n2+=W.ppn){xDist=NodeMatrix[np(n1,"x")]-NodeMatrix[np(n2,"x")];yDist=NodeMatrix[np(n1,"y")]-NodeMatrix[np(n2,"y")];if(W.settings.adjustSize){distance=Math.sqrt(xDist*xDist+yDist*yDist)-NodeMatrix[np(n1,"size")]-NodeMatrix[np(n2,"size")];if(distance>0){factor=coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")]/distance/distance;NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]+=xDist*factor;NodeMatrix[np(n2,"dy")]+=yDist*factor}else if(distance<0){factor=100*coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")];NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}else{distance=Math.sqrt(xDist*xDist+yDist*yDist);if(distance>0){factor=coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")]/distance/distance;NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}}}}g=W.settings.gravity/W.settings.scalingRatio;coefficient=W.settings.scalingRatio;for(n=0;n<W.nodesLength;n+=W.ppn){factor=0;xDist=NodeMatrix[np(n,"x")];yDist=NodeMatrix[np(n,"y")];distance=Math.sqrt(Math.pow(xDist,2)+Math.pow(yDist,2));if(W.settings.strongGravityMode){if(distance>0)factor=coefficient*NodeMatrix[np(n,"mass")]*g}else{if(distance>0)factor=coefficient*NodeMatrix[np(n,"mass")]*g/distance}NodeMatrix[np(n,"dx")]-=xDist*factor;NodeMatrix[np(n,"dy")]-=yDist*factor}coefficient=1*(W.settings.outboundAttractionDistribution?outboundAttCompensation:1);for(e=0;e<W.edgesLength;e+=W.ppe){n1=EdgeMatrix[ep(e,"source")];n2=EdgeMatrix[ep(e,"target")];w=EdgeMatrix[ep(e,"weight")];ewc=Math.pow(w,W.settings.edgeWeightInfluence);xDist=NodeMatrix[np(n1,"x")]-NodeMatrix[np(n2,"x")];yDist=NodeMatrix[np(n1,"y")]-NodeMatrix[np(n2,"y")];if(W.settings.adjustSizes){distance=Math.sqrt(Math.pow(xDist,2)+Math.pow(yDist,2)-NodeMatrix[np(n1,"size")]-NodeMatrix[np(n2,"size")]);if(W.settings.linLogMode){if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance/NodeMatrix[np(n1,"mass")]}}else{if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance}}}else{if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc/NodeMatrix[np(n1,"mass")]}}else{if(distance>0){factor=-coefficient*ewc}}}}else{distance=Math.sqrt(Math.pow(xDist,2)+Math.pow(yDist,2));if(W.settings.linLogMode){if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance/NodeMatrix[np(n1,"mass")]}}else{if(distance>0)factor=-coefficient*ewc*Math.log(1+distance)/distance}}else{if(W.settings.outboundAttractionDistribution){distance=1;factor=-coefficient*ewc/NodeMatrix[np(n1,"mass")]}else{distance=1;factor=-coefficient*ewc}}}if(distance>0){NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}var force,swinging,traction,nodespeed;if(W.settings.adjustSizes){for(n=0;n<W.nodesLength;n+=W.ppn){if(!NodeMatrix[np(n,"fixed")]){force=Math.sqrt(Math.pow(NodeMatrix[np(n,"dx")],2)+Math.pow(NodeMatrix[np(n,"dy")],2));if(force>W.maxForce){NodeMatrix[np(n,"dx")]=NodeMatrix[np(n,"dx")]*W.maxForce/force;NodeMatrix[np(n,"dy")]=NodeMatrix[np(n,"dy")]*W.maxForce/force}swinging=NodeMatrix[np(n,"mass")]*Math.sqrt((NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")]));traction=Math.sqrt((NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")]))/2;nodespeed=.1*Math.log(1+traction)/(1+Math.sqrt(swinging));NodeMatrix[np(n,"x")]=NodeMatrix[np(n,"x")]+NodeMatrix[np(n,"dx")]*(nodespeed/W.settings.slowDown);NodeMatrix[np(n,"y")]=NodeMatrix[np(n,"y")]+NodeMatrix[np(n,"dy")]*(nodespeed/W.settings.slowDown)}}}else{for(n=0;n<W.nodesLength;n+=W.ppn){if(!NodeMatrix[np(n,"fixed")]){swinging=NodeMatrix[np(n,"mass")]*Math.sqrt((NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")]));traction=Math.sqrt((NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")]))/2;nodespeed=NodeMatrix[np(n,"convergence")]*Math.log(1+traction)/(1+Math.sqrt(swinging));NodeMatrix[np(n,"convergence")]=Math.min(1,Math.sqrt(nodespeed*(Math.pow(NodeMatrix[np(n,"dx")],2)+Math.pow(NodeMatrix[np(n,"dy")],2))/(1+Math.sqrt(swinging))));NodeMatrix[np(n,"x")]=NodeMatrix[np(n,"x")]+NodeMatrix[np(n,"dx")]*(nodespeed/W.settings.slowDown);NodeMatrix[np(n,"y")]=NodeMatrix[np(n,"y")]+NodeMatrix[np(n,"dy")]*(nodespeed/W.settings.slowDown)}}}W.iterations++}var sendNewCoords;if(typeof window!=="undefined"&&window.document){sendNewCoords=function(){var e;if(document.createEvent){e=document.createEvent("Event");e.initEvent("newCoords",true,false)}else{e=document.createEventObject();e.eventType="newCoords"}e.eventName="newCoords";e.data={nodes:NodeMatrix.buffer};requestAnimationFrame(function(){document.dispatchEvent(e)})}}else{sendNewCoords=function(){self.postMessage({nodes:NodeMatrix.buffer},[NodeMatrix.buffer])}}function run(n){for(var i=0;i<n;i++)pass();sendNewCoords()}var listener=function(e){switch(e.data.action){case"start":init(new Float32Array(e.data.nodes),new Float32Array(e.data.edges),e.data.config);run(W.settings.startingIterations);break;case"loop":NodeMatrix=new Float32Array(e.data.nodes);run(W.settings.iterationsPerRender);break;case"config":configure(e.data.config);break;case"kill":__emptyObject(W);NodeMatrix=null;EdgeMatrix=null;RegionMatrix=null;self.removeEventListener("message",listener);break;default:}};self.addEventListener("message",listener)};function crush(fnString){var pattern,i,l;var np=["x","y","dx","dy","old_dx","old_dy","mass","convergence","size","fixed"];var ep=["source","target","weight"];var rp=["node","centerX","centerY","size","nextSibling","firstChild","mass","massCenterX","massCenterY"];for(i=0,l=rp.length;i<l;i++){pattern=new RegExp("rp\\(([^,]*), '"+rp[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}for(i=0,l=np.length;i<l;i++){pattern=new RegExp("np\\(([^,]*), '"+np[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}for(i=0,l=ep.length;i<l;i++){pattern=new RegExp("ep\\(([^,]*), '"+ep[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}return fnString}function getWorkerFn(){return";("+crush(Worker.toString())+").call(this);"}if(inWebWorker){eval(getWorkerFn())}else{if(typeof sigma==="undefined")throw"sigma is not declared";sigma.prototype.getForceAtlas2Worker=getWorkerFn}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.layouts");var _root=this;var webWorkers="Worker"in _root;var eventEmitter={};sigma.classes.dispatcher.extend(eventEmitter);function Supervisor(sigInst,options){_root.URL=_root.URL||_root.webkitURL;options=options||{};this.sigInst=sigInst;this.graph=this.sigInst.graph;this.ppn=10;this.ppe=3;this.config={};this.worker=null;this.shouldUseWorker=null;this.workerUrl=null;this.runOnBackground=null;this.easing=null;this.randomize=null;this.configure(options);this.started=false;this.running=false;this.initWorker()}Supervisor.prototype.makeBlob=function(workerFn){var blob;try{blob=new Blob([workerFn],{type:"application/javascript"})}catch(e){_root.BlobBuilder=_root.BlobBuilder||_root.WebKitBlobBuilder||_root.MozBlobBuilder;blob=new BlobBuilder;blob.append(workerFn);blob=blob.getBlob()}return blob};Supervisor.prototype.graphToByteArrays=function(){var nodes=this.graph.nodes(),edges=this.graph.edges(),nbytes=nodes.length*this.ppn,ebytes=edges.length*this.ppe,nIndex={},i,j,l;this.nodesByteArray=new Float32Array(nbytes);this.edgesByteArray=new Float32Array(ebytes);for(i=j=0,l=nodes.length;i<l;i++){nIndex[nodes[i].id]=j;this.nodesByteArray[j]=this.randomize(nodes[i].x);this.nodesByteArray[j+1]=this.randomize(nodes[i].y);this.nodesByteArray[j+2]=0;this.nodesByteArray[j+3]=0;this.nodesByteArray[j+4]=0;this.nodesByteArray[j+5]=0;this.nodesByteArray[j+6]=1+this.graph.degree(nodes[i].id);this.nodesByteArray[j+7]=1;this.nodesByteArray[j+8]=nodes[i].size;this.nodesByteArray[j+9]=nodes[i].fixed||0;j+=this.ppn}for(i=j=0,l=edges.length;i<l;i++){this.edgesByteArray[j]=nIndex[edges[i].source];this.edgesByteArray[j+1]=nIndex[edges[i].target];this.edgesByteArray[j+2]=edges[i].weight||0;j+=this.ppe}};Supervisor.prototype.applyLayoutChanges=function(prefixed){var nodes=this.graph.nodes(),j=0,realIndex;for(var i=0,l=this.nodesByteArray.length;i<l;i+=this.ppn){if(prefixed){nodes[j].fa2_x=this.nodesByteArray[i];nodes[j].fa2_y=this.nodesByteArray[i+1]}else{nodes[j].x=this.nodesByteArray[i];nodes[j].y=this.nodesByteArray[i+1]}j++}};Supervisor.prototype.sendByteArrayToWorker=function(action){var content={action:action||"loop",nodes:this.nodesByteArray.buffer};var buffers=[this.nodesByteArray.buffer];if(action==="start"){content.config=this.config||{};content.edges=this.edgesByteArray.buffer;buffers.push(this.edgesByteArray.buffer)}if(this.shouldUseWorker)this.worker.postMessage(content,buffers);else _root.postMessage(content,"*")};Supervisor.prototype.start=function(){if(this.running)return;this.running=true;if(!this.started){this.sendByteArrayToWorker("start");this.started=true;eventEmitter.dispatchEvent("start")}else{this.sendByteArrayToWorker()}};Supervisor.prototype.stop=function(){if(!this.running)return;this.running=false;eventEmitter.dispatchEvent("stop")};Supervisor.prototype.initWorker=function(){var _this=this,workerFn=sigma.layouts.getForceLinkWorker();if(this.shouldUseWorker){if(!this.workerUrl){var blob=this.makeBlob(workerFn);this.worker=new Worker(URL.createObjectURL(blob))}else{this.worker=new Worker(this.workerUrl)}this.worker.postMessage=this.worker.webkitPostMessage||this.worker.postMessage}else{eval(workerFn)}this.msgName=this.worker?"message":"newCoords";this.listener=function(e){_this.nodesByteArray=new Float32Array(e.data.nodes);if(_this.running){_this.applyLayoutChanges(_this.runOnBackground);_this.sendByteArrayToWorker();if(!_this.runOnBackground)_this.sigInst.refresh({skipIndexation:true})}if(e.data.converged){_this.running=false}if(!_this.running){_this.killWorker();if(_this.runOnBackground&&_this.easing){_this.applyLayoutChanges(true);eventEmitter.dispatchEvent("interpolate");sigma.plugins.animate(_this.sigInst,{x:"fa2_x",y:"fa2_y"},{easing:_this.easing,onComplete:function(){_this.sigInst.refresh();eventEmitter.dispatchEvent("stop")}})}else{_this.applyLayoutChanges(false);_this.sigInst.refresh();eventEmitter.dispatchEvent("stop")}}};(this.worker||document).addEventListener(this.msgName,this.listener);this.graphToByteArrays();_this.sigInst.bind("kill",function(){sigma.layouts.killForceLink()})};Supervisor.prototype.killWorker=function(){if(this.worker){this.worker.terminate()}else{_root.postMessage({action:"kill"},"*");document.removeEventListener(this.msgName,this.listener)}};Supervisor.prototype.configure=function(config){this.config=config;this.shouldUseWorker=config.worker===false?false:true&&webWorkers;this.workerUrl=config.workerUrl;this.runOnBackground=config.background?true:false;this.easing=config.easing;switch(config.randomize){case"globally":this.randomize=function(x){return Math.random()*(config.randomizeFactor||1)};break;case"locally":this.randomize=function(x){return x+Math.random()*(config.randomizeFactor||1)};break;default:this.randomize=function(x){return x}}if(!this.started)return;var data={action:"config",config:this.config};if(this.shouldUseWorker)this.worker.postMessage(data);else _root.postMessage(data,"*")};var supervisor=null;sigma.layouts.startForceLink=function(sigInst,config){if(!supervisor){supervisor=new Supervisor(sigInst,config)}else if(!supervisor.running){supervisor.killWorker();supervisor.initWorker();supervisor.started=false}if(config)supervisor.configure(config);supervisor.start();return eventEmitter};sigma.layouts.stopForceLink=function(){if(!supervisor)return;supervisor.stop();return supervisor};sigma.layouts.killForceLink=function(){if(!supervisor)return;supervisor.stop();supervisor.killWorker();supervisor=null;eventEmitter={};sigma.classes.dispatcher.extend(eventEmitter)};sigma.layouts.configForceLink=function(sigInst,config){if(!supervisor){supervisor=new Supervisor(sigInst,config)}else if(!supervisor.running){supervisor.killWorker();supervisor.initWorker();supervisor.started=false}supervisor.configure(config);return eventEmitter};sigma.layouts.isForceLinkRunning=function(){return!!supervisor&&supervisor.running}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.layouts");var _root=this,inWebWorker=!("document"in _root);var Worker=function(undefined){"use strict";var W={ppn:10,ppe:3,ppr:9,maxForce:10,iterations:0,converged:false,settings:{linLogMode:false,outboundAttractionDistribution:false,adjustSizes:false,edgeWeightInfluence:0,scalingRatio:1,strongGravityMode:false,gravity:1,slowDown:1,barnesHutOptimize:false,barnesHutTheta:.5,startingIterations:1,iterationsPerRender:1,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:false,alignNodeSiblings:false,nodeSiblingsScale:1,nodeSiblingsAngleMin:0}};var NodeMatrix,EdgeMatrix,RegionMatrix;function extend(){var i,k,res={},l=arguments.length;for(i=l-1;i>=0;i--)for(k in arguments[i])res[k]=arguments[i][k];return res}function __emptyObject(obj){var k;for(k in obj)if(!("hasOwnProperty"in obj)||obj.hasOwnProperty(k))delete obj[k];return obj}function getDistance(x0,y0,x1,y1){return Math.sqrt((x1-x0)*(x1-x0)+(y1-y0)*(y1-y0))}function getCircleIntersection(x0,y0,r0,x1,y1,r1){var a,dx,dy,d,h,rx,ry,x2,y2;dx=x1-x0;dy=y1-y0;d=Math.sqrt(dy*dy+dx*dx);if(d>r0+r1){return false}if(d<Math.abs(r0-r1)){return false}a=(r0*r0-r1*r1+d*d)/(2*d);x2=x0+dx*a/d;y2=y0+dy*a/d;h=Math.sqrt(r0*r0-a*a);rx=-dy*(h/d);ry=dx*(h/d);var xi=x2+rx;var xi_prime=x2-rx;var yi=y2+ry;var yi_prime=y2-ry;return{xi:xi,xi_prime:xi_prime,yi:yi,yi_prime:yi_prime}}function getLinesIntersection(line1x1,line1y1,line1x2,line1y2,line2x1,line2y1,line2x2,line2y2){var denominator,a,b,numerator1,numerator2,result={x:null,y:null,onLine1:false,onLine2:false};denominator=(line2y2-line2y1)*(line1x2-line1x1)-(line2x2-line2x1)*(line1y2-line1y1);if(denominator==0){return result}a=line1y1-line2y1;b=line1x1-line2x1;numerator1=(line2x2-line2x1)*a-(line2y2-line2y1)*b;numerator2=(line1x2-line1x1)*a-(line1y2-line1y1)*b;a=numerator1/denominator;b=numerator2/denominator;result.x=line1x1+a*(line1x2-line1x1);result.y=line1y1+a*(line1y2-line1y1);if(a>0&&a<1){result.onLine1=true}if(b>0&&b<1){result.onLine2=true}return result}function scaleRange(value,baseMin,baseMax,limitMin,limitMax){return(limitMax-limitMin)*(value-baseMin)/(baseMax-baseMin)+limitMin}function getVectorAngle(v){return Math.acos(v.x/Math.sqrt(v.x*v.x+v.y*v.y))}function getNormalVector(aX,aY,bX,bY){return{xi:-(bY-aY),yi:bX-aX,xi_prime:bY-aY,yi_prime:-(bX-aX)}}function getNormalizedVector(v,length){return{x:(v.xi_prime-v.xi)/length,y:(v.yi_prime-v.yi)/length}}function getPointOnLineSegment(aX,aY,bX,bY,t){return{x:aX+(bX-aX)*t,y:aY+(bY-aY)*t}}var nodeProperties={x:0,y:1,dx:2,dy:3,old_dx:4,old_dy:5,mass:6,convergence:7,size:8,fixed:9};var edgeProperties={source:0,target:1,weight:2};var regionProperties={node:0,centerX:1,centerY:2,size:3,nextSibling:4,firstChild:5,mass:6,massCenterX:7,massCenterY:8};function np(i,p){if(i%W.ppn!==0)throw new Error('Invalid argument in np: "i" is not correct ('+i+").");if(i!==parseInt(i))throw new TypeError('Invalid argument in np: "i" is not an integer.');if(p in nodeProperties)return i+nodeProperties[p];else throw new Error("ForceLink.Worker - "+"Inexistant node property given ("+p+").")}function ep(i,p){if(i%W.ppe!==0)throw new Error('Invalid argument in ep: "i" is not correct ('+i+").");if(i!==parseInt(i))throw new TypeError('Invalid argument in ep: "i" is not an integer.');if(p in edgeProperties)return i+edgeProperties[p];else throw new Error("ForceLink.Worker - "+"Inexistant edge property given ("+p+").")}function rp(i,p){if(i%W.ppr!==0)throw new Error('Invalid argument in rp: "i" is not correct ('+i+").");if(i!==parseInt(i))throw new TypeError('Invalid argument in rp: "i" is not an integer.');if(p in regionProperties)return i+regionProperties[p];else throw new Error("ForceLink.Worker - "+"Inexistant region property given ("+p+").")}function nan(v){if(isNaN(v))throw new TypeError("NaN alert!")}function init(nodes,edges,config){config=config||{};var i,l;NodeMatrix=nodes;EdgeMatrix=edges;W.nodesLength=NodeMatrix.length;W.edgesLength=EdgeMatrix.length;configure(config)}function configure(o){W.settings=extend(o,W.settings)}function pass(){var a,i,j,l,r,n,n1,n2,e,w,g,k,m;var outboundAttCompensation,coefficient,xDist,yDist,oldxDist,oldyDist,ewc,mass,distance,size,factor;for(n=0;n<W.nodesLength;n+=W.ppn){NodeMatrix[np(n,"old_dx")]=NodeMatrix[np(n,"dx")];NodeMatrix[np(n,"old_dy")]=NodeMatrix[np(n,"dy")];NodeMatrix[np(n,"dx")]=0;NodeMatrix[np(n,"dy")]=0}if(W.settings.outboundAttractionDistribution){outboundAttCompensation=0;for(n=0;n<W.nodesLength;n+=W.ppn){outboundAttCompensation+=NodeMatrix[np(n,"mass")]}outboundAttCompensation/=W.nodesLength}if(W.settings.barnesHutOptimize){var minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity,q,q0,q1,q2,q3;RegionMatrix=[];for(n=0;n<W.nodesLength;n+=W.ppn){minX=Math.min(minX,NodeMatrix[np(n,"x")]);maxX=Math.max(maxX,NodeMatrix[np(n,"x")]);minY=Math.min(minY,NodeMatrix[np(n,"y")]);maxY=Math.max(maxY,NodeMatrix[np(n,"y")])}RegionMatrix[rp(0,"node")]=-1;RegionMatrix[rp(0,"centerX")]=(minX+maxX)/2;RegionMatrix[rp(0,"centerY")]=(minY+maxY)/2;RegionMatrix[rp(0,"size")]=Math.max(maxX-minX,maxY-minY);RegionMatrix[rp(0,"nextSibling")]=-1;RegionMatrix[rp(0,"firstChild")]=-1;RegionMatrix[rp(0,"mass")]=0;RegionMatrix[rp(0,"massCenterX")]=0;RegionMatrix[rp(0,"massCenterY")]=0;l=1;for(n=0;n<W.nodesLength;n+=W.ppn){r=0;while(true){if(RegionMatrix[rp(r,"firstChild")]>=0){if(NodeMatrix[np(n,"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}RegionMatrix[rp(r,"massCenterX")]=(RegionMatrix[rp(r,"massCenterX")]*RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"x")]*NodeMatrix[np(n,"mass")])/(RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"mass")]);RegionMatrix[rp(r,"massCenterY")]=(RegionMatrix[rp(r,"massCenterY")]*RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"y")]*NodeMatrix[np(n,"mass")])/(RegionMatrix[rp(r,"mass")]+NodeMatrix[np(n,"mass")]);RegionMatrix[rp(r,"mass")]+=NodeMatrix[np(n,"mass")];r=q;continue}else{if(RegionMatrix[rp(r,"node")]<0){RegionMatrix[rp(r,"node")]=n;break}else{RegionMatrix[rp(r,"firstChild")]=l*W.ppr;w=RegionMatrix[rp(r,"size")]/2;g=RegionMatrix[rp(r,"firstChild")];RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]-w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]-w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]-w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]+w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]+w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]-w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=g+W.ppr;RegionMatrix[rp(g,"firstChild")]=-1;RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;g+=W.ppr;RegionMatrix[rp(g,"node")]=-1;RegionMatrix[rp(g,"centerX")]=RegionMatrix[rp(r,"centerX")]+w;RegionMatrix[rp(g,"centerY")]=RegionMatrix[rp(r,"centerY")]+w;RegionMatrix[rp(g,"size")]=w;RegionMatrix[rp(g,"nextSibling")]=RegionMatrix[rp(r,"nextSibling")];RegionMatrix[rp(g,"firstChild")]=-1;
RegionMatrix[rp(g,"mass")]=0;RegionMatrix[rp(g,"massCenterX")]=0;RegionMatrix[rp(g,"massCenterY")]=0;l+=4;if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")]<RegionMatrix[rp(r,"centerY")]){q=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}RegionMatrix[rp(r,"mass")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")];RegionMatrix[rp(r,"massCenterX")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")];RegionMatrix[rp(r,"massCenterY")]=NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")];RegionMatrix[rp(q,"node")]=RegionMatrix[rp(r,"node")];RegionMatrix[rp(r,"node")]=-1;if(NodeMatrix[np(n,"x")]<RegionMatrix[rp(r,"centerX")]){if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q2=RegionMatrix[rp(r,"firstChild")]}else{q2=RegionMatrix[rp(r,"firstChild")]+W.ppr}}else{if(NodeMatrix[np(n,"y")]<RegionMatrix[rp(r,"centerY")]){q2=RegionMatrix[rp(r,"firstChild")]+W.ppr*2}else{q2=RegionMatrix[rp(r,"firstChild")]+W.ppr*3}}if(q===q2){r=q;continue}RegionMatrix[rp(q2,"node")]=n;break}}}}}if(W.settings.barnesHutOptimize){coefficient=W.settings.scalingRatio;for(n=0;n<W.nodesLength;n+=W.ppn){r=0;while(true){if(RegionMatrix[rp(r,"firstChild")]>=0){distance=Math.sqrt((NodeMatrix[np(n,"x")]-RegionMatrix[rp(r,"massCenterX")])*(NodeMatrix[np(n,"x")]-RegionMatrix[rp(r,"massCenterX")])+(NodeMatrix[np(n,"y")]-RegionMatrix[rp(r,"massCenterY")])*(NodeMatrix[np(n,"y")]-RegionMatrix[rp(r,"massCenterY")]));if(2*RegionMatrix[rp(r,"size")]/distance<W.settings.barnesHutTheta){xDist=NodeMatrix[np(n,"x")]-RegionMatrix[rp(r,"massCenterX")];yDist=NodeMatrix[np(n,"y")]-RegionMatrix[rp(r,"massCenterY")];if(W.settings.adjustSize){if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}else if(distance<0){factor=-coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}else{if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*RegionMatrix[rp(r,"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}if(RegionMatrix[rp(r,"nextSibling")]<0)break;r=RegionMatrix[rp(r,"nextSibling")];continue}else{r=RegionMatrix[rp(r,"firstChild")];continue}}else{if(RegionMatrix[rp(r,"node")]>=0&&RegionMatrix[rp(r,"node")]!==n){xDist=NodeMatrix[np(n,"x")]-NodeMatrix[np(RegionMatrix[rp(r,"node")],"x")];yDist=NodeMatrix[np(n,"y")]-NodeMatrix[np(RegionMatrix[rp(r,"node")],"y")];distance=Math.sqrt(xDist*xDist+yDist*yDist);if(W.settings.adjustSize){if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}else if(distance<0){factor=-coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}else{if(distance>0){factor=coefficient*NodeMatrix[np(n,"mass")]*NodeMatrix[np(RegionMatrix[rp(r,"node")],"mass")]/distance/distance;NodeMatrix[np(n,"dx")]+=xDist*factor;NodeMatrix[np(n,"dy")]+=yDist*factor}}}if(RegionMatrix[rp(r,"nextSibling")]<0)break;r=RegionMatrix[rp(r,"nextSibling")];continue}}}}else{coefficient=W.settings.scalingRatio;for(n1=0;n1<W.nodesLength;n1+=W.ppn){for(n2=0;n2<n1;n2+=W.ppn){xDist=NodeMatrix[np(n1,"x")]-NodeMatrix[np(n2,"x")];yDist=NodeMatrix[np(n1,"y")]-NodeMatrix[np(n2,"y")];if(W.settings.adjustSize){distance=Math.sqrt(xDist*xDist+yDist*yDist)-NodeMatrix[np(n1,"size")]-NodeMatrix[np(n2,"size")];if(distance>0){factor=coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")]/distance/distance;NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]+=xDist*factor;NodeMatrix[np(n2,"dy")]+=yDist*factor}else if(distance<0){factor=100*coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")];NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}else{distance=Math.sqrt(xDist*xDist+yDist*yDist);if(distance>0){factor=coefficient*NodeMatrix[np(n1,"mass")]*NodeMatrix[np(n2,"mass")]/distance/distance;NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}}}}g=W.settings.gravity/W.settings.scalingRatio;coefficient=W.settings.scalingRatio;for(n=0;n<W.nodesLength;n+=W.ppn){factor=0;xDist=NodeMatrix[np(n,"x")];yDist=NodeMatrix[np(n,"y")];distance=Math.sqrt(xDist*xDist+yDist*yDist);if(W.settings.strongGravityMode){if(distance>0)factor=coefficient*NodeMatrix[np(n,"mass")]*g}else{if(distance>0)factor=coefficient*NodeMatrix[np(n,"mass")]*g/distance}NodeMatrix[np(n,"dx")]-=xDist*factor;NodeMatrix[np(n,"dy")]-=yDist*factor}coefficient=1*(W.settings.outboundAttractionDistribution?outboundAttCompensation:1);for(e=0;e<W.edgesLength;e+=W.ppe){n1=EdgeMatrix[ep(e,"source")];n2=EdgeMatrix[ep(e,"target")];w=EdgeMatrix[ep(e,"weight")];ewc=Math.pow(w,W.settings.edgeWeightInfluence);xDist=NodeMatrix[np(n1,"x")]-NodeMatrix[np(n2,"x")];yDist=NodeMatrix[np(n1,"y")]-NodeMatrix[np(n2,"y")];if(W.settings.adjustSizes){distance=Math.sqrt(xDist*xDist+yDist*yDist-NodeMatrix[np(n1,"size")]-NodeMatrix[np(n2,"size")]);if(W.settings.linLogMode){if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance/NodeMatrix[np(n1,"mass")]}}else{if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance}}}else{if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc/NodeMatrix[np(n1,"mass")]}}else{if(distance>0){factor=-coefficient*ewc}}}}else{distance=Math.sqrt(xDist*xDist+yDist*yDist);if(W.settings.linLogMode){if(W.settings.outboundAttractionDistribution){if(distance>0){factor=-coefficient*ewc*Math.log(1+distance)/distance/NodeMatrix[np(n1,"mass")]}}else{if(distance>0)factor=-coefficient*ewc*Math.log(1+distance)/distance}}else{if(W.settings.outboundAttractionDistribution){distance=1;factor=-coefficient*ewc/NodeMatrix[np(n1,"mass")]}else{distance=1;factor=-coefficient*ewc}}}if(distance>0){NodeMatrix[np(n1,"dx")]+=xDist*factor;NodeMatrix[np(n1,"dy")]+=yDist*factor;NodeMatrix[np(n2,"dx")]-=xDist*factor;NodeMatrix[np(n2,"dy")]-=yDist*factor}}var force,swinging,traction,nodespeed,alldistance=0;if(W.settings.adjustSizes){for(n=0;n<W.nodesLength;n+=W.ppn){if(!NodeMatrix[np(n,"fixed")]){force=Math.sqrt(NodeMatrix[np(n,"dx")]*NodeMatrix[np(n,"dx")]+NodeMatrix[np(n,"dy")]*NodeMatrix[np(n,"dy")]);if(force>W.maxForce){NodeMatrix[np(n,"dx")]=NodeMatrix[np(n,"dx")]*W.maxForce/force;NodeMatrix[np(n,"dy")]=NodeMatrix[np(n,"dy")]*W.maxForce/force}swinging=NodeMatrix[np(n,"mass")]*Math.sqrt((NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")]));traction=Math.sqrt((NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")]))/2;nodespeed=.1*Math.log(1+traction)/(1+Math.sqrt(swinging));oldxDist=NodeMatrix[np(n,"x")];oldyDist=NodeMatrix[np(n,"y")];NodeMatrix[np(n,"x")]=NodeMatrix[np(n,"x")]+NodeMatrix[np(n,"dx")]*(nodespeed/W.settings.slowDown);NodeMatrix[np(n,"y")]=NodeMatrix[np(n,"y")]+NodeMatrix[np(n,"dy")]*(nodespeed/W.settings.slowDown);xDist=NodeMatrix[np(n,"x")];yDist=NodeMatrix[np(n,"y")];distance=Math.sqrt((xDist-oldxDist)*(xDist-oldxDist)+(yDist-oldyDist)*(yDist-oldyDist));alldistance+=distance}}}else{for(n=0;n<W.nodesLength;n+=W.ppn){if(!NodeMatrix[np(n,"fixed")]){swinging=NodeMatrix[np(n,"mass")]*Math.sqrt((NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]-NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]-NodeMatrix[np(n,"dy")]));traction=Math.sqrt((NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])*(NodeMatrix[np(n,"old_dx")]+NodeMatrix[np(n,"dx")])+(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")])*(NodeMatrix[np(n,"old_dy")]+NodeMatrix[np(n,"dy")]))/2;nodespeed=NodeMatrix[np(n,"convergence")]*Math.log(1+traction)/(1+Math.sqrt(swinging));NodeMatrix[np(n,"convergence")]=Math.min(1,Math.sqrt(nodespeed*(NodeMatrix[np(n,"dx")]*NodeMatrix[np(n,"dx")]+NodeMatrix[np(n,"dy")]*NodeMatrix[np(n,"dy")])/(1+Math.sqrt(swinging))));oldxDist=NodeMatrix[np(n,"x")];oldyDist=NodeMatrix[np(n,"y")];NodeMatrix[np(n,"x")]=NodeMatrix[np(n,"x")]+NodeMatrix[np(n,"dx")]*(nodespeed/W.settings.slowDown);NodeMatrix[np(n,"y")]=NodeMatrix[np(n,"y")]+NodeMatrix[np(n,"dy")]*(nodespeed/W.settings.slowDown);xDist=NodeMatrix[np(n,"x")];yDist=NodeMatrix[np(n,"y")];distance=Math.sqrt((xDist-oldxDist)*(xDist-oldxDist)+(yDist-oldyDist)*(yDist-oldyDist));alldistance+=distance}}}W.iterations++;if(W.settings.autoStop){W.converged=W.iterations>W.settings.maxIterations||alldistance/W.nodesLength<W.settings.avgDistanceThreshold;if(W.converged&&W.settings.alignNodeSiblings){var neighbors={},parallelNodes={},setKey,keysN;for(e=0;e<W.edgesLength;e+=W.ppe){n1=EdgeMatrix[ep(e,"source")];n2=EdgeMatrix[ep(e,"target")];if(n1===n2)continue;neighbors[n1]=neighbors[n1]||{};neighbors[n2]=neighbors[n2]||{};neighbors[n1][n2]=true;neighbors[n2][n1]=true}Object.keys(neighbors).forEach(function(n){n=~~n;keysN=Object.keys(neighbors[n]);if(keysN.length==2){setKey=keysN[0]+";"+keysN[1];if(setKey in parallelNodes){parallelNodes[setKey].push(n)}else{setKey=keysN[1]+";"+keysN[0];if(!parallelNodes[setKey]){parallelNodes[setKey]=[~~keysN[1],~~keysN[0]]}parallelNodes[setKey].push(n)}}});var setNodes,setSource,setTarget,degSource,degTarget,sX,sY,tX,tY,t,distSourceTarget,intersectionPoint,normalVector,nNormaleVector,angle,angleMin=W.settings.nodeSiblingsAngleMin;Object.keys(parallelNodes).forEach(function(key){setSource=parallelNodes[key].shift();setTarget=parallelNodes[key].shift();setNodes=parallelNodes[key];sX=NodeMatrix[np(setSource,"x")];sY=NodeMatrix[np(setSource,"y")];tX=NodeMatrix[np(setTarget,"x")];tY=NodeMatrix[np(setTarget,"y")];if(setNodes.length==1)return;degSource=Object.keys(neighbors[setSource]).length;degTarget=Object.keys(neighbors[setTarget]).length;t=scaleRange(degSource/(degSource+degTarget),0,1,1/4,3/4);intersectionPoint=getPointOnLineSegment(sX,sY,tX,tY,t);normalVector=getNormalVector(sX,sY,tX,tY);distSourceTarget=getDistance(sX,sY,tX,tY);nNormaleVector=getNormalizedVector(normalVector,distSourceTarget);angle=getVectorAngle(nNormaleVector);if(2*angleMin>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");if(angleMin>0){if(angle<angleMin||angle>Math.PI-angleMin&&angle<=Math.PI){nNormaleVector={x:Math.cos(Math.PI-angleMin)*2,y:Math.sin(Math.PI-angleMin)*2}}else if(angle>2*Math.PI-angleMin||angle>=Math.PI&&angle<Math.PI+angleMin){nNormaleVector={x:Math.cos(angleMin)*2,y:Math.sin(angleMin)*2}}}var start=0,sign=1,steps=1;if(setNodes.length%2==1){steps=0;start=1}for(var i=0;i<setNodes.length;i++){NodeMatrix[np(setNodes[i],"x")]=intersectionPoint.x+sign*nNormaleVector.x*steps*(start||i>=2?W.settings.nodeSiblingsScale:W.settings.nodeSiblingsScale*2/3);NodeMatrix[np(setNodes[i],"y")]=intersectionPoint.y+sign*nNormaleVector.y*steps*(start||i>=2?W.settings.nodeSiblingsScale:W.settings.nodeSiblingsScale*2/3);sign=-sign;steps+=(i+start)%2}})}}}var sendNewCoords;if(typeof window!=="undefined"&&window.document){sendNewCoords=function(){if(!W.autoStop||W.converged){var e;if(document.createEvent){e=document.createEvent("Event");e.initEvent("newCoords",true,false)}else{e=document.createEventObject();e.eventType="newCoords"}e.eventName="newCoords";e.data={nodes:NodeMatrix.buffer,converged:W.converged};requestAnimationFrame(function(){document.dispatchEvent(e)})}}}else{sendNewCoords=function(){if(!W.autoStop||W.converged){self.postMessage({nodes:NodeMatrix.buffer,converged:W.converged},[NodeMatrix.buffer])}}}function run(n){for(var i=0;i<n;i++)pass();sendNewCoords()}var listener=function(e){switch(e.data.action){case"start":init(new Float32Array(e.data.nodes),new Float32Array(e.data.edges),e.data.config);run(W.settings.startingIterations);break;case"loop":NodeMatrix=new Float32Array(e.data.nodes);run(W.settings.iterationsPerRender);break;case"config":configure(e.data.config);break;case"kill":__emptyObject(W);NodeMatrix=null;EdgeMatrix=null;RegionMatrix=null;self.removeEventListener("message",listener);break;default:}};self.addEventListener("message",listener)};function crush(fnString){var pattern,i,l;var np=["x","y","dx","dy","old_dx","old_dy","mass","convergence","size","fixed"];var ep=["source","target","weight"];var rp=["node","centerX","centerY","size","nextSibling","firstChild","mass","massCenterX","massCenterY"];for(i=0,l=rp.length;i<l;i++){pattern=new RegExp("rp\\(([^,]*), '"+rp[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}for(i=0,l=np.length;i<l;i++){pattern=new RegExp("np\\(([^,]*), '"+np[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}for(i=0,l=ep.length;i<l;i++){pattern=new RegExp("ep\\(([^,]*), '"+ep[i]+"'\\)","g");fnString=fnString.replace(pattern,i===0?"$1":"$1 + "+i)}return fnString}function getWorkerFn(){return";("+crush(Worker.toString())+").call(this);"}if(inWebWorker){eval(getWorkerFn())}else{if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.layouts.getForceLinkWorker=getWorkerFn}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.layouts.fruchtermanReingold");var settings={autoArea:true,area:1,gravity:10,speed:.1,iterations:1e3};var _instance={};var _eventEmitter={};function FruchtermanReingold(){var self=this;this.init=function(sigInst,options){options=options||{};this.sigInst=sigInst;this.config=sigma.utils.extend(options,settings);this.easing=options.easing;this.duration=options.duration;if(!sigma.plugins||typeof sigma.plugins.animate==="undefined"){throw new Error("sigma.plugins.animate is not declared")}this.running=false};this.atomicGo=function(){if(!this.running||this.iterCount<1)return false;var nodes=this.sigInst.graph.nodes(),edges=this.sigInst.graph.edges(),i,j,n,n2,e,xDist,yDist,dist,repulsiveF,nodesCount=nodes.length,edgesCount=edges.length;this.config.area=this.config.autoArea?nodesCount*nodesCount:this.config.area;this.iterCount--;this.running=this.iterCount>0;var maxDisplace=Math.sqrt(this.config.area)/10,k=Math.sqrt(this.config.area/(1+nodesCount));for(i=0;i<nodesCount;i++){n=nodes[i];if(!n.fr){n.fr_x=n.x;n.fr_y=n.y;n.fr={dx:0,dy:0}}for(j=0;j<nodesCount;j++){n2=nodes[j];if(n.id!=n2.id){xDist=n.fr_x-n2.fr_x;yDist=n.fr_y-n2.fr_y;dist=Math.sqrt(xDist*xDist+yDist*yDist)+.01;if(dist>0){repulsiveF=k*k/dist;n.fr.dx+=xDist/dist*repulsiveF;n.fr.dy+=yDist/dist*repulsiveF}}}}var nSource,nTarget,attractiveF;for(i=0;i<edgesCount;i++){e=edges[i];nSource=self.sigInst.graph.nodes(e.source);nTarget=self.sigInst.graph.nodes(e.target);xDist=nSource.fr_x-nTarget.fr_x;yDist=nSource.fr_y-nTarget.fr_y;dist=Math.sqrt(xDist*xDist+yDist*yDist)+.01;attractiveF=dist*dist/k;if(dist>0){nSource.fr.dx-=xDist/dist*attractiveF;nSource.fr.dy-=yDist/dist*attractiveF;nTarget.fr.dx+=xDist/dist*attractiveF;nTarget.fr.dy+=yDist/dist*attractiveF}}var d,gf,limitedDist;for(i=0;i<nodesCount;i++){n=nodes[i];d=Math.sqrt(n.fr_x*n.fr_x+n.fr_y*n.fr_y);gf=.01*k*self.config.gravity*d;n.fr.dx-=gf*n.fr_x/d;n.fr.dy-=gf*n.fr_y/d;n.fr.dx*=self.config.speed;n.fr.dy*=self.config.speed;if(!n.fixed){xDist=n.fr.dx;yDist=n.fr.dy;dist=Math.sqrt(xDist*xDist+yDist*yDist);if(dist>0){limitedDist=Math.min(maxDisplace*self.config.speed,dist);n.fr_x+=xDist/dist*limitedDist;n.fr_y+=yDist/dist*limitedDist}}}return this.running};this.go=function(){this.iterCount=this.config.iterations;while(this.running){this.atomicGo()}this.stop()};this.start=function(){if(this.running)return;var nodes=this.sigInst.graph.nodes();this.running=true;for(var i=0;i<nodes.length;i++){nodes[i].fr_x=nodes[i].x;nodes[i].fr_y=nodes[i].y;nodes[i].fr={dx:0,dy:0}}_eventEmitter[self.sigInst.id].dispatchEvent("start");this.go()};this.stop=function(){var nodes=this.sigInst.graph.nodes();this.running=false;if(this.easing){_eventEmitter[self.sigInst.id].dispatchEvent("interpolate");sigma.plugins.animate(self.sigInst,{x:"fr_x",y:"fr_y"},{easing:self.easing,onComplete:function(){self.sigInst.refresh();for(var i=0;i<nodes.length;i++){nodes[i].fr=null;nodes[i].fr_x=null;nodes[i].fr_y=null}_eventEmitter[self.sigInst.id].dispatchEvent("stop")},duration:self.duration})}else{for(var i=0;i<nodes.length;i++){nodes[i].x=nodes[i].fr_x;nodes[i].y=nodes[i].fr_y}this.sigInst.refresh();for(var i=0;i<nodes.length;i++){nodes[i].fr=null;nodes[i].fr_x=null;nodes[i].fr_y=null}_eventEmitter[self.sigInst.id].dispatchEvent("stop")}};this.kill=function(){this.sigInst=null;this.config=null;this.easing=null}}sigma.layouts.fruchtermanReingold.configure=function(sigInst,config){if(!sigInst)throw new Error('Missing argument: "sigInst"');if(!config)throw new Error('Missing argument: "config"');if(!_instance[sigInst.id]){_instance[sigInst.id]=new FruchtermanReingold;_eventEmitter[sigInst.id]={};sigma.classes.dispatcher.extend(_eventEmitter[sigInst.id]);sigInst.bind("kill",function(){_instance[sigInst.id].kill();_instance[sigInst.id]=null;_eventEmitter[sigInst.id]=null})}_instance[sigInst.id].init(sigInst,config);return _eventEmitter[sigInst.id]};sigma.layouts.fruchtermanReingold.start=function(sigInst,config){if(!sigInst)throw new Error('Missing argument: "sigInst"');if(config){this.configure(sigInst,config)}_instance[sigInst.id].start();return _eventEmitter[sigInst.id]};sigma.layouts.fruchtermanReingold.isRunning=function(sigInst){if(!sigInst)throw new Error('Missing argument: "sigInst"');return!!_instance[sigInst.id]&&_instance[sigInst.id].running};sigma.layouts.fruchtermanReingold.progress=function(sigInst){if(!sigInst)throw new Error('Missing argument: "sigInst"');return(_instance[sigInst.id].config.iterations-_instance[sigInst.id].iterCount)/_instance[sigInst.id].config.iterations}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.neo4j");sigma.utils.pkg("sigma.utils");sigma.utils.pkg("sigma.parsers");sigma.neo4j.send=function(neo4j,endpoint,method,data,callback){var xhr=sigma.utils.xhr(),url,user,password;url=neo4j;if(typeof neo4j==="object"){url=neo4j.url;user=neo4j.user;password=neo4j.password}if(!xhr)throw"XMLHttpRequest not supported, cannot load the file.";url+=endpoint;xhr.open(method,url,true);if(user&&password){xhr.setRequestHeader("Authorization","Basic "+btoa(user+":"+password))}xhr.setRequestHeader("Accept","application/json");xhr.setRequestHeader("Content-type","application/json; charset=utf-8");xhr.onreadystatechange=function(){if(xhr.readyState===4){callback(JSON.parse(xhr.responseText))}};xhr.send(data)};sigma.neo4j.cypher_parse=function(result){var graph={nodes:[],edges:[]},nodesMap={},edgesMap={},key;result.results[0].data.forEach(function(data){data.graph.nodes.forEach(function(node){var sigmaNode={id:node.id,label:node.id,x:Math.random(),y:Math.random(),size:1,neo4j_labels:node.labels,neo4j_data:node.properties};if(sigmaNode.id in nodesMap){}else{nodesMap[sigmaNode.id]=sigmaNode}});data.graph.relationships.forEach(function(edge){var sigmaEdge={id:edge.id,label:edge.type,source:edge.startNode,target:edge.endNode,neo4j_type:edge.type,neo4j_data:edge.properties};if(sigmaEdge.id in edgesMap){}else{edgesMap[sigmaEdge.id]=sigmaEdge}})});for(key in nodesMap){graph.nodes.push(nodesMap[key])}for(key in edgesMap){graph.edges.push(edgesMap[key])}return graph};sigma.neo4j.cypher=function(neo4j,cypher,sig,callback){var endpoint="/db/data/transaction/commit",data,cypherCallback;data=JSON.stringify({statements:[{statement:cypher,resultDataContents:["graph"],includeStats:false}]});cypherCallback=function(callback){return function(response){var graph={nodes:[],edges:[]};graph=sigma.neo4j.cypher_parse(response);if(sig instanceof sigma){sig.graph.clear();sig.graph.read(graph)}else if(typeof sig==="object"){sig=new sigma(sig);sig.graph.read(graph);sig.refresh()}else if(typeof sig==="function"){callback=sig;sig=null}if(callback)callback(sig||graph)}};sigma.neo4j.send(neo4j,endpoint,"POST",data,cypherCallback(callback))};sigma.neo4j.getLabels=function(neo4j,callback){sigma.neo4j.send(neo4j,"/db/data/labels","GET",null,callback)};sigma.neo4j.getTypes=function(neo4j,callback){sigma.neo4j.send(neo4j,"/db/data/relationship/types","GET",null,callback)}}).call(this);(function(undefined){"use strict";var _helpers={getModelTags:function(xml){var attributesTags=xml.getElementsByTagName("attributes"),modelTags={},l=attributesTags.length,i;for(i=0;i<l;i++)modelTags[attributesTags[i].getAttribute("class")]=attributesTags[i].childNodes;return modelTags},nodeListToArray:function(nodeList){var children=[];for(var i=0,len=nodeList.length;i<len;++i){if(nodeList[i].nodeName!=="#text")children.push(nodeList[i])}return children},nodeListEach:function(nodeList,func){for(var i=0,len=nodeList.length;i<len;++i){if(nodeList[i].nodeName!=="#text")func(nodeList[i])}},nodeListToHash:function(nodeList,filter){var children={};for(var i=0;i<nodeList.length;i++){if(nodeList[i].nodeName!=="#text"){var prop=filter(nodeList[i]);children[prop.key]=prop.value}}return children},namedNodeMapToObject:function(nodeMap){var attributes={};for(var i=0;i<nodeMap.length;i++){attributes[nodeMap[i].name]=nodeMap[i].value}return attributes},getFirstElementByTagNS:function(node,ns,tag){var el=node.getElementsByTagName(ns+":"+tag)[0];if(!el)el=node.getElementsByTagNameNS(ns,tag)[0];if(!el)el=node.getElementsByTagName(tag)[0];return el},getAttributeNS:function(node,ns,attribute){var attr_value=node.getAttribute(ns+":"+attribute);if(attr_value===undefined)attr_value=node.getAttributeNS(ns,attribute);if(attr_value===undefined)attr_value=node.getAttribute(attribute);return attr_value},enforceType:function(type,value){switch(type){case"boolean":value=value==="true";break;case"integer":case"long":case"float":case"double":value=+value;break;case"liststring":value=value?value.split("|"):[];break}return value},getRGB:function(values){return values[3]?"rgba("+values.join(",")+")":"rgb("+values.slice(0,-1).join(",")+")"}};function Node(properties){var node={id:properties.id,label:properties.label};if(properties.viz)node.viz=properties.viz;if(properties.attributes)node.attributes=properties.attributes;return node}function Edge(properties){var edge={id:properties.id,type:properties.type||"undirected",label:properties.label||"",source:properties.source,target:properties.target,weight:+properties.weight||1};if(properties.viz)edge.viz=properties.viz;if(properties.attributes)edge.attributes=properties.attributes;return edge}function Graph(xml){var _xml={};_xml.els={root:xml.getElementsByTagName("gexf")[0],graph:xml.getElementsByTagName("graph")[0],meta:xml.getElementsByTagName("meta")[0],nodes:xml.getElementsByTagName("node"),edges:xml.getElementsByTagName("edge"),model:_helpers.getModelTags(xml)};_xml.hasViz=!!_helpers.getAttributeNS(_xml.els.root,"xmlns","viz");_xml.version=_xml.els.root.getAttribute("version")||"1.0";_xml.mode=_xml.els.graph.getAttribute("mode")||"static";var edgeType=_xml.els.graph.getAttribute("defaultedgetype");_xml.defaultEdgetype=edgeType||"undirected";function _metaData(){var metas={};if(!_xml.els.meta)return metas;metas.lastmodifieddate=_xml.els.meta.getAttribute("lastmodifieddate");_helpers.nodeListEach(_xml.els.meta.childNodes,function(child){metas[child.tagName.toLowerCase()]=child.textContent});return metas}function _model(cls){var attributes=[];if(_xml.els.model[cls])_helpers.nodeListEach(_xml.els.model[cls],function(attr){var properties={id:attr.getAttribute("id")||attr.getAttribute("for"),type:attr.getAttribute("type")||"string",title:attr.getAttribute("title")||""};var default_el=_helpers.nodeListToArray(attr.childNodes);if(default_el.length>0)properties.defaultValue=default_el[0].textContent;attributes.push(properties)});return attributes.length>0?attributes:false}function _data(model,node_or_edge){var data={};var attvalues_els=node_or_edge.getElementsByTagName("attvalue");var ah=_helpers.nodeListToHash(attvalues_els,function(el){var attributes=_helpers.namedNodeMapToObject(el.attributes);var key=attributes.id||attributes["for"];return{key:key,value:attributes.value}});model.map(function(a){data[a.id]=!(a.id in ah)&&"defaultValue"in a?_helpers.enforceType(a.type,a.defaultValue):_helpers.enforceType(a.type,ah[a.id])});return data}function _nodes(model){var nodes=[];_helpers.nodeListEach(_xml.els.nodes,function(n){var properties={id:n.getAttribute("id"),label:n.getAttribute("label")||""};if(model)properties.attributes=_data(model,n);if(_xml.hasViz)properties.viz=_nodeViz(n);nodes.push(Node(properties))});return nodes}function _nodeViz(node){var viz={};var color_el=_helpers.getFirstElementByTagNS(node,"viz","color");if(color_el){var color=["r","g","b","a"].map(function(c){return color_el.getAttribute(c)});viz.color=_helpers.getRGB(color)}var pos_el=_helpers.getFirstElementByTagNS(node,"viz","position");if(pos_el){viz.position={};["x","y","z"].map(function(p){viz.position[p]=+pos_el.getAttribute(p)})}var size_el=_helpers.getFirstElementByTagNS(node,"viz","size");if(size_el)viz.size=+size_el.getAttribute("value");var shape_el=_helpers.getFirstElementByTagNS(node,"viz","shape");if(shape_el)viz.shape=shape_el.getAttribute("value");return viz}function _edges(model,default_type){var edges=[];_helpers.nodeListEach(_xml.els.edges,function(e){var properties=_helpers.namedNodeMapToObject(e.attributes);if(!("type"in properties)){properties.type=default_type}if(model)properties.attributes=_data(model,e);if(_xml.hasViz)properties.viz=_edgeViz(e);edges.push(Edge(properties))});return edges}function _edgeViz(edge){var viz={};var color_el=_helpers.getFirstElementByTagNS(edge,"viz","color");if(color_el){var color=["r","g","b","a"].map(function(c){return color_el.getAttribute(c)});viz.color=_helpers.getRGB(color)}var shape_el=_helpers.getFirstElementByTagNS(edge,"viz","shape");if(shape_el)viz.shape=shape_el.getAttribute("value");var thick_el=_helpers.getFirstElementByTagNS(edge,"viz","thickness");if(thick_el)viz.thickness=+thick_el.getAttribute("value");return viz}var nodeModel=_model("node"),edgeModel=_model("edge");var graph={version:_xml.version,mode:_xml.mode,defaultEdgeType:_xml.defaultEdgetype,meta:_metaData(),model:{},nodes:_nodes(nodeModel),edges:_edges(edgeModel,_xml.defaultEdgetype)};if(nodeModel)graph.model.node=nodeModel;if(edgeModel)graph.model.edge=edgeModel;return graph}function fetch(gexf_url,callback){var xhr=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;var names,i;if(window.ActiveXObject){names=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(i in names)try{return new ActiveXObject(names[i])}catch(e){}}return null}();if(!xhr)throw"XMLHttpRequest not supported, cannot load the file.";var async=typeof callback==="function",getResult;if(xhr.overrideMimeType){xhr.overrideMimeType("text/xml");getResult=function(r){return r.responseXML}}else{getResult=function(r){var p=new DOMParser;return p.parseFromString(r.responseText,"application/xml")}}xhr.open("GET",gexf_url,async);if(async)xhr.onreadystatechange=function(){if(xhr.readyState===4)callback(getResult(xhr))};xhr.send();return async?xhr:getResult(xhr)}function parse(gexf){return Graph(gexf)}function fetchAndParse(gexf_url,callback){if(typeof callback==="function"){return fetch(gexf_url,function(gexf){callback(Graph(gexf))})}else return Graph(fetch(gexf_url))}if(typeof this.gexf!=="undefined")throw'gexf: error - a variable called "gexf" already '+"exists in the global scope";this.gexf={parse:parse,fetch:fetchAndParse,version:"0.1.1"};if(typeof exports!=="undefined"&&this.exports!==exports)module.exports=this.gexf}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.parsers");var _id=0;function edgeId(){return"e"+_id++}sigma.parsers.gexf=function(target,sig,callback){var i,l,arr,obj;function parse(graph){arr=graph.nodes;for(i=0,l=arr.length;i<l;i++){obj=arr[i];obj.id=obj.id;if(obj.viz&&typeof obj.viz==="object"){if(obj.viz.position&&typeof obj.viz.position==="object"){obj.x=obj.viz.position.x;obj.y=-obj.viz.position.y}obj.size=obj.viz.size;obj.color=obj.viz.color}}arr=graph.edges;for(i=0,l=arr.length;i<l;i++){obj=arr[i];obj.id=typeof obj.id==="string"?obj.id:edgeId();obj.source=""+obj.source;obj.target=""+obj.target;if(obj.viz&&typeof obj.viz==="object"){obj.color=obj.viz.color;obj.size=obj.viz.thickness}obj.size=obj.weight;obj.direction=obj.type;delete obj.type}if(sig instanceof sigma){sig.graph.clear();arr=graph.nodes;for(i=0,l=arr.length;i<l;i++)sig.graph.addNode(arr[i]);arr=graph.edges;for(i=0,l=arr.length;i<l;i++)sig.graph.addEdge(arr[i])}else if(typeof sig==="object"){sig.graph=graph;sig=new sigma(sig)}else if(typeof sig==="function"){callback=sig;sig=null}if(callback){callback(sig||graph);return}else return graph}if(typeof target==="string")gexf.fetch(target,parse);else if(typeof target==="object")return parse(gexf.parse(target))}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.parsers");sigma.utils.pkg("sigma.utils");sigma.utils.xhr=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;var names,i;if(window.ActiveXObject){names=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(i in names)try{return new ActiveXObject(names[i])}catch(e){}}return null};sigma.parsers.json=function(url,sig,callback){var graph,xhr=sigma.utils.xhr();if(!xhr)throw"XMLHttpRequest not supported, cannot load the file.";xhr.open("GET",url,true);xhr.onreadystatechange=function(){if(xhr.readyState===4){graph=JSON.parse(xhr.responseText);if(sig instanceof sigma){sig.graph.clear();sig.graph.read(graph)}else if(typeof sig==="object"){sig.graph=graph;sig=new sigma(sig)}else if(typeof sig==="function"){callback=sig;sig=null}if(callback)callback(sig||graph)}};xhr.send()}}).call(this);(function(){"use strict";if(typeof sigma==="undefined"){throw"sigma is not declared"}var defaultPathLengthFunction=function(node1,node2,previousPathLength){var isEverythingDefined=node1!=undefined&&node2!=undefined&&node1.x!=undefined&&node1.y!=undefined&&node2.x!=undefined&&node2.y!=undefined;if(!isEverythingDefined){return undefined}return(previousPathLength||0)+Math.sqrt(Math.pow(node2.y-node1.y,2)+Math.pow(node2.x-node1.x,2))};sigma.classes.graph.addMethod("astar",function(srcId,destId,settings){var currentSettings=new sigma.classes.configurable({undirected:false,pathLengthFunction:defaultPathLengthFunction,heuristicLengthFunction:undefined},settings||{});var pathLengthFunction=currentSettings("pathLengthFunction"),heuristicLengthFunction=currentSettings("heuristicLengthFunction")||pathLengthFunction;var srcNode=this.nodes(srcId),destNode=this.nodes(destId);var closedList={},openList=[];var addToLists=function(node,previousNode,pathLength,heuristicLength){var nodeId=node.id;var newItem={pathLength:pathLength,heuristicLength:heuristicLength,node:node,nodeId:nodeId,previousNode:previousNode};if(closedList[nodeId]==undefined||closedList[nodeId].pathLenth>pathLength){closedList[nodeId]=newItem;var item;var i;for(i=0;i<openList.length;i++){item=openList[i];if(item.heuristicLength>heuristicLength){
break}}openList.splice(i,0,newItem)}};addToLists(srcNode,null,0,0);var pathFound=false;var allNeighbors;if(currentSettings("undirected")){allNeighbors=this.allNeighborsIndex}else{allNeighbors=this.outNeighborsIndex}var inspectedItem,neighbors,neighbor,pathLength,heuristicLength,i;while(openList.length>0){inspectedItem=openList.shift();if(inspectedItem.nodeId==destId){pathFound=true;break}neighbors=Object.keys(allNeighbors[inspectedItem.nodeId]);for(i=0;i<neighbors.length;i++){neighbor=this.nodes(neighbors[i]);pathLength=pathLengthFunction(inspectedItem.node,neighbor,inspectedItem.pathLength);heuristicLength=heuristicLengthFunction(neighbor,destNode);addToLists(neighbor,inspectedItem.node,pathLength,heuristicLength)}}if(pathFound){var path=[],currentNode=destNode;while(currentNode){path.unshift(currentNode);currentNode=closedList[currentNode.id].previousNode}return path}else{return undefined}})}).call(window);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var _instance=null,_activeNodesIndex,_activeEdgesIndex,_activeNodesCount,_activeEdgesCount,_g=null,_enableEvents=true;function initIndexes(){_activeNodesIndex=Object.create(null);_activeEdgesIndex=Object.create(null);_activeNodesCount=0;_activeEdgesCount=0}initIndexes();function dispatchNodeEvent(){if(_instance!==null&&_enableEvents){_instance.dispatchEvent("activeNodes")}}function dispatchEdgeEvent(){if(_instance!==null&&_enableEvents){_instance.dispatchEvent("activeEdges")}}sigma.classes.graph.attach("addNode","sigma.plugins.activeState.addNode",function(n){if(n.active){_activeNodesIndex[n.id]=this.nodesIndex[n.id];_activeNodesCount++;dispatchNodeEvent()}});sigma.classes.graph.attach("addEdge","sigma.plugins.activeState.addEdge",function(e){if(e.active){_activeEdgesIndex[e.id]=this.edgesIndex[e.id];dispatchEdgeEvent()}});sigma.classes.graph.attachBefore("dropNode","sigma.plugins.activeState.dropNode",function(id){if(this.nodesIndex[id]!==undefined&&this.nodesIndex[id].active){delete _activeNodesIndex[id];_activeNodesCount--;dispatchNodeEvent()}});sigma.classes.graph.attachBefore("dropEdge","sigma.plugins.activeState.dropEdge",function(id){if(this.edgesIndex[id]!==undefined&&this.edgesIndex[id].active){delete _activeEdgesIndex[id];_activeEdgesCount--;dispatchEdgeEvent()}});sigma.classes.graph.attachBefore("clear","sigma.plugins.activeState.clear",initIndexes);function ActiveState(s){_instance=this;_g=s.graph;if(_activeNodesIndex===null){_activeNodesIndex=Object.create(null);_activeNodesCount=0;_g.nodes().forEach(function(o){if(o.active){_activeNodesIndex[o.id]=o;_activeNodesCount++}})}if(_activeEdgesIndex===null){_activeEdgesIndex=Object.create(null);_activeEdgesCount=0;_g.edges().forEach(function(o){if(o.active){_activeEdgesIndex[o.id]=o;_activeEdgesCount++}})}sigma.classes.dispatcher.extend(this);s.bind("kill",function(){_instance.kill()})}ActiveState.prototype.kill=function(){this.unbind();_activeNodesIndex=null;_activeEdgesIndex=null;_activeNodesCount=0;_activeEdgesCount=0;_g=null;_instance=null};ActiveState.prototype.addNodes=function(v){var oldCount=_activeNodesCount,n;if(!arguments.length){_g.nodes().forEach(function(o){if(!o.hidden){o.active=true;_activeNodesIndex[o.id]=o}})}if(arguments.length>1){throw new TypeError("Too many arguments. Use an array instead.")}else if(typeof v==="string"||typeof v==="number"){n=_g.nodes(v);if(!n.hidden){n.active=true;_activeNodesIndex[v]=n}}else if(Array.isArray(v)){var i,l,a=[];for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number"){n=_g.nodes(v[i]);if(!n.hidden){n.active=true;_activeNodesIndex[v[i]]=n}}else throw new TypeError("Invalid argument: a node id is not a string or a number, was "+v[i])}_activeNodesCount=Object.keys(_activeNodesIndex).length;if(oldCount!=_activeNodesCount){dispatchNodeEvent()}return this};ActiveState.prototype.addEdges=function(v){var oldCount=_activeEdgesCount,e;if(!arguments.length){_g.edges().forEach(function(o){if(!o.hidden){o.active=true;_activeEdgesIndex[o.id]=o}})}if(arguments.length>1){throw new TypeError("Too many arguments. Use an array instead.")}else if(typeof v==="string"||typeof v==="number"){e=_g.edges(v);if(!e.hidden){e.active=true;_activeEdgesIndex[v]=e}}else if(Array.isArray(v)){var i,l,a=[];for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number"){e=_g.edges(v[i]);if(!e.hidden){e.active=true;_activeEdgesIndex[v[i]]=e}}else throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+v[i])}_activeEdgesCount=Object.keys(_activeEdgesIndex).length;if(oldCount!=_activeEdgesCount){dispatchEdgeEvent()}return this};ActiveState.prototype.dropNodes=function(v){var oldCount=_activeNodesCount;if(!arguments.length){_g.nodes().forEach(function(o){o.active=false;delete _activeNodesIndex[o.id]})}if(arguments.length>1){throw new TypeError("Too many arguments. Use an array instead.")}else if(typeof v==="string"||typeof v==="number"){_g.nodes(v).active=false;delete _activeNodesIndex[v]}else if(Array.isArray(v)){var i,l;for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number"){_g.nodes(v[i]).active=false;delete _activeNodesIndex[v[i]]}else throw new TypeError("Invalid argument: a node id is not a string or a number, was "+v[i])}_activeNodesCount=Object.keys(_activeNodesIndex).length;if(oldCount!=_activeNodesCount){dispatchNodeEvent()}return this};ActiveState.prototype.dropEdges=function(v){var oldCount=_activeEdgesCount;if(!arguments.length){_g.edges().forEach(function(o){o.active=false;delete _activeEdgesIndex[o.id]})}if(arguments.length>1){throw new TypeError("Too many arguments. Use an array instead.")}else if(typeof v==="string"||typeof v==="number"){_g.edges(v).active=false;delete _activeEdgesIndex[v]}else if(Array.isArray(v)){var i,l;for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="string"||typeof v[i]==="number"){_g.edges(v[i]).active=false;delete _activeEdgesIndex[v[i]]}else throw new TypeError("Invalid argument: an edge id is not a string or a number, was "+v[i])}_activeEdgesCount=Object.keys(_activeEdgesIndex).length;if(oldCount!=_activeEdgesCount){dispatchEdgeEvent()}return this};ActiveState.prototype.addNeighbors=function(){if(!("adjacentNodes"in _g))throw new Error("Missing method graph.adjacentNodes");var a,id;a=Object.keys(_activeNodesIndex);if(a.length){for(id in _activeNodesIndex){_g.adjacentNodes(id).forEach(function(adj){if(!adj.hidden)a.push(adj.id)})}_enableEvents=false;this.dropNodes().dropEdges();_enableEvents=true;this.addNodes(a)}return this};ActiveState.prototype.setNodesBy=function(fn){var a=[];_g.nodes().forEach(function(o){if(fn.call(_g,o)){if(!o.hidden)a.push(o.id)}});_enableEvents=false;this.dropNodes();_enableEvents=true;this.addNodes(a);return this};ActiveState.prototype.setEdgesBy=function(fn){var a=[];_g.edges().forEach(function(o){if(fn.call(_g,o)){if(!o.hidden)a.push(o.id)}});_enableEvents=false;this.dropEdges();_enableEvents=true;this.addEdges(a);return this};ActiveState.prototype.invertNodes=function(){var a=_g.nodes().filter(function(o){return!o.hidden&&!o.active}).map(function(o){return o.id});_enableEvents=false;this.dropNodes();_enableEvents=true;if(a.length){this.addNodes(a)}else{dispatchNodeEvent()}return this};ActiveState.prototype.invertEdges=function(){var a=_g.edges().filter(function(o){return!o.hidden&&!o.active}).map(function(o){return o.id});_enableEvents=false;this.dropEdges();_enableEvents=true;if(a.length){this.addEdges(a)}else{dispatchEdgeEvent()}return this};ActiveState.prototype.nodes=function(){var id,a=[];for(id in _activeNodesIndex){a.push(_activeNodesIndex[id])}return a};ActiveState.prototype.edges=function(){var id,a=[];for(id in _activeEdgesIndex){a.push(_activeEdgesIndex[id])}return a};sigma.plugins.activeState=function(s){if(!_instance){_instance=new ActiveState(s)}return _instance};sigma.plugins.killActiveState=function(){if(_instance instanceof ActiveState){_instance.kill();_instance=null}}}).call(this);(function(){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var _id=0,_cache={};function parseColor(val){if(_cache[val])return _cache[val];var result=[0,0,0];if(val.match(/^#/)){val=(val||"").replace(/^#/,"");result=val.length===3?[parseInt(val.charAt(0)+val.charAt(0),16),parseInt(val.charAt(1)+val.charAt(1),16),parseInt(val.charAt(2)+val.charAt(2),16)]:[parseInt(val.charAt(0)+val.charAt(1),16),parseInt(val.charAt(2)+val.charAt(3),16),parseInt(val.charAt(4)+val.charAt(5),16)]}else if(val.match(/^ *rgba? *\(/)){val=val.match(/^ *rgba? *\( *([0-9]*) *, *([0-9]*) *, *([0-9]*) *(,.*)?\) *$/);result=[+val[1],+val[2],+val[3]]}_cache[val]={r:result[0],g:result[1],b:result[2]};return _cache[val]}function interpolateColors(c1,c2,p){c1=parseColor(c1);c2=parseColor(c2);var c={r:c1.r*(1-p)+c2.r*p,g:c1.g*(1-p)+c2.g*p,b:c1.b*(1-p)+c2.b*p};return"rgb("+[c.r|0,c.g|0,c.b|0].join(",")+")"}sigma.plugins.animate=function(s,animate,options){var o=options||{},id=++_id,duration=o.duration||s.settings("animationsTime"),easing=typeof o.easing==="string"?sigma.utils.easings[o.easing]:typeof o.easing==="function"?o.easing:sigma.utils.easings.quadraticInOut,start=sigma.utils.dateNow(),nodes,startPositions;if(o.nodes&&o.nodes.length){if(typeof o.nodes[0]==="object")nodes=o.nodes;else nodes=s.graph.nodes(o.nodes)}else nodes=s.graph.nodes();startPositions=nodes.reduce(function(res,node){var k;res[node.id]={};for(k in animate)if(k in node)res[node.id][k]=node[k];return res},{});s.animations=s.animations||Object.create({});sigma.plugins.killAnimate(s);function step(){var p=(sigma.utils.dateNow()-start)/duration;if(p>=1){nodes.forEach(function(node){for(var k in animate)if(k in animate)node[k]=node[animate[k]]});s.refresh({skipIndexation:true});if(typeof o.onComplete==="function")o.onComplete()}else{p=easing(p);nodes.forEach(function(node){for(var k in animate)if(k in animate){if(k.match(/color$/))node[k]=interpolateColors(startPositions[node.id][k],node[animate[k]],p);else node[k]=node[animate[k]]*p+startPositions[node.id][k]*(1-p)}});s.refresh({skipIndexation:true});s.animations[id]=requestAnimationFrame(step)}}step()};sigma.plugins.killAnimate=function(s){for(var k in s.animations||{})cancelAnimationFrame(s.animations[k])}}).call(window);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");sigma.plugins.colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");function strToObjectRef(obj,str){return str.split(".").reduce(function(obj,i){return obj[i]},obj)}function emptyObject(obj){var k;for(k in obj)if(!("hasOwnProperty"in obj)||obj.hasOwnProperty(k))delete obj[k];return obj}function deepCopy(o){var copy=Object.create(null);for(var i in o){if(typeof o[i]==="object"&&o[i]!==null){copy[i]=deepCopy(o[i])}else if(typeof o[i]==="function"&&o[i]!==null){eval(" copy[i] = "+o[i].toString())}else copy[i]=o[i]}return copy}function baseHistogram(values,nbins){var numlist,min,max,bin,res={};if(!values.length)return res;numlist=values.map(function(val){return parseFloat(val)}).sort(function(a,b){return a-b});min=numlist[0];max=numlist[numlist.length-1];if(max-min!==0){numlist.forEach(function(num){bin=Math.floor(nbins*Math.abs(num-min)/Math.abs(max-min));bin-=bin==nbins?1:0;res[num]=bin})}else{numlist.forEach(function(num){res[num]=0})}return res}function histogram(h,p){var d=[],bins,maxOcc=0;if(h&&h[p]){Object.keys(h[p]).forEach(function(value){var bin=h[p][value];d[bin]=d[bin]||[];d[bin].push(+value)});bins=d.length!==1?d.length:7;for(var bin=0;bin<bins;bin++){if(d[bin]){maxOcc=maxOcc>d[bin].length?maxOcc:d[bin].length}}for(var bin=0;bin<bins;bin++){if(d[bin]===undefined){d[bin]=[]}d[bin]={bin:bin,values:d[bin],ratio:d[bin].length/maxOcc};if(d[bin].values.length){d[bin].min=Math.min.apply(null,d[bin].values);d[bin].max=Math.max.apply(null,d[bin].values)}}}return d}function Vision(s,datasetName,mappings,palette){var that=this;this.visualVars=null;this.mappings=null;this.palette=palette;this.idx=Object.create(null);this.histograms=Object.create(null);this.deprecated=Object.create(null);this.sigmaSettings=Object.create(null);this.dataTypes=Object.create(null);this.originalVisualVariable=Object.create(null);if(datasetName==="nodes"){this.visualVars=["color","size","label","type","icon","image"];this.mappings=mappings.nodes;this.dataset=function(){return s.graph.nodes()}}else if(datasetName==="edges"){this.visualVars=["color","size","label","type"];this.mappings=mappings.edges;this.dataset=function(){return s.graph.edges()}}else throw new Error('Invalid argument: "datasetName" is not "nodes" or "edges", was '+datasetName);this.update=function(key){var self=this;if(key===undefined)throw new Error('Missing argument: "key".');if(typeof key!=="string")throw new Error('Invalid argument: "key" is not a string, was '+key);var val,byFn,schemeFn,isSequential=undefined,isArray=true;byFn=function(item,key){return strToObjectRef(item,key)};schemeFn=function(palette,key){return strToObjectRef(palette,key)};function insertItem(val,item){if(self.idx[key][val]===undefined){self.idx[key][val]={key:val,items:[],styles:Object.create(null)}}self.idx[key][val].items.push(item);if(isSequential||isSequential===undefined){isSequential=typeof val==="number"}}this.idx[key]={};this.dataset().forEach(function(item){val=byFn(item,key);if(val!==undefined){if(isArray){isArray=Array.isArray(val)?isArray:false}if(isArray){if(val.length===1){insertItem(val[0],item)}else{val.forEach(function(v){insertItem(v,item)})}}else{insertItem(val,item)}}});this.dataTypes[key]={sequential:isSequential,
array:isArray};this.deprecated[key]=false;var maxOcc=0;for(val in this.idx[key]){maxOcc=maxOcc<this.idx[key][val].items.length?this.idx[key][val].items.length:maxOcc}Object.keys(this.idx[key]).forEach(function(val){self.idx[key][val].ratio=parseFloat(self.idx[key][val].items.length/maxOcc)});var format,colorHist,sizeHist,colorScheme,typeScheme,iconScheme,imageScheme,bins,visualVars,nset=0;visualVars=Object.keys(that.mappings).filter(function(visualVar){return that.mappings[visualVar]&&that.mappings[visualVar].by!==undefined&&that.mappings[visualVar].by.toString()==key});visualVars.forEach(function(visualVar){switch(visualVar){case"color":colorScheme=that.mappings.color.scheme;if(typeof colorScheme!=="string")throw new Error('color.scheme "'+colorScheme+'" is not a string.');if(isSequential){bins=that.mappings.color.bins||7;self.histograms.color=self.histograms.color||{};self.histograms.color[key]=baseHistogram(Object.keys(self.idx[key]),bins)}break;case"label":format=that.mappings.label.format||function(item){return typeof item==="string"?item:item.label};if(typeof format!=="function")throw new Error('label.format "'+format+'" is not a function.');break;case"size":if(!isSequential)throw new Error('One value of the property "'+key+'" is not a number.');self.histograms.size=self.histograms.size||{};self.histograms.size[key]=baseHistogram(Object.keys(self.idx[key]),that.mappings.size.bins||7);break;case"type":typeScheme=that.mappings.type.scheme;if(typeof typeScheme!=="string")throw new Error('type.scheme "'+typeScheme+'" is not a string.');break;case"icon":iconScheme=that.mappings.icon.scheme;if(typeof iconScheme!=="string")throw new Error('icon.scheme "'+iconScheme+'" is not a string.');break;case"image":imageScheme=that.mappings.image.scheme;if(typeof imageScheme!=="string")throw new Error('type.scheme "'+imageScheme+'" is not a string.');break}});Object.keys(this.idx[key]).forEach(function(val){visualVars.forEach(function(visualVar){switch(visualVar){case"color":if(isSequential){self.idx[key][val].styles.color=function(){var bin=self.histograms.color[key][val];return schemeFn(that.palette,colorScheme)[bins][bin]}}else{self.idx[key][val].styles.color=function(){if(schemeFn(that.palette,colorScheme)===undefined)throw new Error("Wrong or undefined color scheme.");if(that.mappings.color.set>0){var setItem=schemeFn(that.palette,colorScheme)[that.mappings.color.set][nset];nset=(nset+1)%that.mappings.color.set;return setItem}return schemeFn(that.palette,colorScheme)[val]}}break;case"label":self.idx[key][val].styles.label=function(item){return format(byFn(item,key))};break;case"size":self.idx[key][val].styles.size=function(){return 1+self.histograms.size[key][val]};break;case"type":self.idx[key][val].styles.type=function(){if(schemeFn(that.palette,typeScheme)===undefined)throw new Error("Wrong or undefined type scheme.");return schemeFn(that.palette,typeScheme)[val]};break;case"icon":self.idx[key][val].styles.icon=function(){if(schemeFn(that.palette,iconScheme)===undefined)throw new Error("Wrong or undefined icon scheme.");return schemeFn(that.palette,iconScheme)[val]};break;case"image":self.idx[key][val].styles.image=function(){if(schemeFn(that.palette,imageScheme)===undefined)throw new Error("Wrong or undefined image scheme.");return schemeFn(that.palette,imageScheme)[val]};break}})})};this.get=function(key){if(key===undefined)throw new TypeError('Missing argument: "key".');if(typeof key!=="string")throw new TypeError('Invalid argument: "key" is not a string, was '+key);if(this.deprecated[key])this.update(key);if(this.idx[key]===undefined)this.update(key);return this.idx[key]};this.applyStyle=function(visualVar,key){if(key===undefined)throw new TypeError('Missing argument: "key"');if(typeof key!=="string")throw new TypeError('Invalid argument: "key" is not a string, was '+key);if(this.visualVars.indexOf(visualVar)==-1)throw new Error('Unknown style "'+visualVar+'"');var self=this,idxp=this.get(key);if(visualVar==="color"&&self.dataTypes[key].array){this.dataset().forEach(function(item){delete item.colors});Object.keys(idxp).forEach(function(val){var o=idxp[val];o.items.forEach(function(item){item.colors=[]})})}Object.keys(idxp).forEach(function(val){var o=idxp[val];o.items.forEach(function(item){if(item!==undefined&&o.styles!==undefined&&typeof o.styles[visualVar]==="function"){if(!self.originalVisualVariable[item.id]){self.originalVisualVariable[item.id]={}}if(!(visualVar in self.originalVisualVariable[item.id])){Object.defineProperty(self.originalVisualVariable[item.id],visualVar,{enumerable:true,value:item[visualVar]})}var newVal=o.styles[visualVar](item);if(visualVar==="color"&&self.dataTypes[key].array){if(newVal!==undefined){item.color=newVal;item.colors.push(newVal)}}else if(newVal!==undefined){item[visualVar]=newVal}}else{if(typeof o.styles[visualVar]==="function")throw new TypeError(o.styles+"."+visualVar+"is not a function, was "+o.styles[visualVar])}})});if(visualVar==="size"){if(datasetName==="nodes"){if(this.mappings.size.min>this.mappings.size.max){throw new RangeError("nodes.size.min must be "+"lower or equal than nodes.size.max")}if(this.mappings.size.min){if(!this.sigmaSettings.minNodeSize){this.sigmaSettings.minNodeSize=s.settings("minNodeSize")}s.settings("minNodeSize",this.mappings.size.min)}if(this.mappings.size.max){if(!this.sigmaSettings.maxNodeSize){this.sigmaSettings.maxNodeSize=s.settings("maxNodeSize")}s.settings("maxNodeSize",this.mappings.size.max)}}else if(datasetName==="edges"){if(this.mappings.size.min>this.mappings.size.max){throw new RangeError("edges.size.min must be "+"lower or equal than edges.size.max")}if(this.mappings.size.min){if(!this.sigmaSettings.minEdgeSize){this.sigmaSettings.minEdgeSize=s.settings("minEdgeSize")}s.settings("minEdgeSize",this.mappings.size.min)}if(this.mappings.size.max){if(!this.sigmaSettings.maxEdgeSize){this.sigmaSettings.maxEdgeSize=s.settings("maxEdgeSize")}s.settings("maxEdgeSize",this.mappings.size.max)}}}};this.resetStyle=function(visualVar,key){if(key===undefined)throw new TypeError('Missing argument: "key"');if(typeof key!=="string")throw new TypeError('Invalid argument: "key" is not a string, was '+key);if(this.visualVars.indexOf(visualVar)==-1)throw new Error('Unknown style "'+visualVar+'".');if(this.idx[key]===undefined)return;var self=this,idxp=this.get(key);if(visualVar==="color"&&self.dataTypes[key].array){Object.keys(idxp).forEach(function(val){var o=idxp[val];o.items.forEach(function(item){delete item.colors})})}Object.keys(idxp).forEach(function(val){var o=idxp[val];o.items.forEach(function(item){if(item!==undefined&&item[visualVar]!==undefined){if(self.originalVisualVariable[item.id]===undefined||self.originalVisualVariable[item.id][visualVar]===undefined){if(self.key==="edges"&&visualVar==="size")item.size=1;else delete item[visualVar]}else item[visualVar]=self.originalVisualVariable[item.id][visualVar]}})});if(visualVar==="size"){if(datasetName==="nodes"){if(this.sigmaSettings.minNodeSize){s.settings("minNodeSize",this.sigmaSettings.minNodeSize)}if(this.sigmaSettings.maxNodeSize){s.settings("maxNodeSize",this.sigmaSettings.maxNodeSize)}}else if(datasetName==="edges"){if(this.sigmaSettings.minEdgeSize){s.settings("minEdgeSize",this.sigmaSettings.minEdgeSize)}if(this.sigmaSettings.maxEdgeSize){s.settings("maxEdgeSize",this.sigmaSettings.maxEdgeSize)}}}};this.clear=function(){this.visualVars.length=0;emptyObject(this.idx);emptyObject(this.histograms);emptyObject(this.deprecated);emptyObject(this.sigmaSettings);emptyObject(this.dataTypes);emptyObject(this.originalVisualVariable)};return this}function design(s,options){this.palette=(options||{}).palette||{};this.styles=sigma.utils.extend((options||{}).styles||{},{nodes:{},edges:{}});var self=this,_visionOnNodes=new Vision(s,"nodes",this.styles,this.palette),_visionOnEdges=new Vision(s,"edges",this.styles,this.palette);s.bind("kill",function(){sigma.plugins.killDesign(s)});this.setStyles=function(styles){this.styles=sigma.utils.extend(styles||{},{nodes:{},edges:{}});_visionOnNodes.mappings=this.styles.nodes;_visionOnEdges.mappings=this.styles.edges;this.deprecate();return this};this.nodesBy=function(visualVar,params){this.styles=sigma.utils.extend(this.styles||{},{nodes:{},edges:{}});this.styles.nodes[visualVar]=params;_visionOnNodes.mappings=this.styles.nodes;if(params.by){this.deprecate("nodes",params.by)}return this};this.edgesBy=function(visualVar,params){this.styles=sigma.utils.extend(this.styles||{},{nodes:{},edges:{}});this.styles.edges[visualVar]=params;_visionOnEdges.mappings=this.styles.edges;if(params.by){this.deprecate("edges",params.by)}return this};this.setPalette=function(palette){this.palette=palette;_visionOnNodes.palette=this.palette;_visionOnEdges.palette=this.palette;this.deprecate();return this};this.nodes=function(key){return _visionOnNodes.get(key)};this.edges=function(key){return _visionOnEdges.get(key)};this.inspect=function(){return{nodes:deepCopy(_visionOnNodes),edges:deepCopy(_visionOnEdges)}};function __apply(mappings,vision,visualVar){if(!visualVar){Object.keys(mappings).forEach(function(visuVar){mappings[visuVar].active=false;if(mappings[visuVar]&&mappings[visuVar].by){vision.applyStyle(visuVar,mappings[visuVar].by);mappings[visuVar].active=true}})}else if(mappings[visualVar]&&mappings[visualVar].by){vision.applyStyle(visualVar,mappings[visualVar].by);mappings[visualVar].active=true}if(s)s.refresh({skipIndexation:true})}this.apply=function(target,visualVar){if(!this.styles)return;if(!target){__apply(this.styles.nodes,_visionOnNodes,visualVar);__apply(this.styles.edges,_visionOnEdges,visualVar);return this}switch(target){case"nodes":__apply(this.styles.nodes,_visionOnNodes,visualVar);break;case"edges":__apply(this.styles.edges,_visionOnEdges,visualVar);break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target)}return this};function __reset(mappings,vision,visualVar){if(!visualVar){Object.keys(mappings).forEach(function(visuVar){if(mappings[visuVar].active){vision.resetStyle(visuVar,mappings[visuVar].by);mappings[visuVar].active=false}})}else if(mappings[visualVar]&&mappings[visualVar].active){vision.resetStyle(visualVar,mappings[visualVar].by);mappings[visualVar].active=false}if(s)s.refresh({skipIndexation:true})}this.reset=function(target,visualVar){if(!this.styles)return;if(!target){__reset(this.styles.nodes,_visionOnNodes,visualVar);__reset(this.styles.edges,_visionOnEdges,visualVar);return this}switch(target){case"nodes":__reset(this.styles.nodes,_visionOnNodes,visualVar);break;case"edges":__reset(this.styles.edges,_visionOnEdges,visualVar);break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target)}return this};this.deprecate=function(target,key){if(target){if(target!=="nodes"&&target!=="edges")throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target);if(key){if(target==="nodes"){_visionOnNodes.deprecated[key]=true}else if(target==="edges"){_visionOnEdges.deprecated[key]=true}}else{if(target==="nodes"){Object.keys(_visionOnNodes.deprecated).forEach(function(prop){_visionOnNodes.deprecated[prop]=true})}else if(target==="edges"){Object.keys(_visionOnEdges.deprecated).forEach(function(prop){_visionOnEdges.deprecated[prop]=true})}}}else{Object.keys(_visionOnNodes.deprecated).forEach(function(prop){_visionOnNodes.deprecated[prop]=true});Object.keys(_visionOnEdges.deprecated).forEach(function(prop){_visionOnEdges.deprecated[prop]=true})}return this};this.deletePropertyStylesFrom=function(target,id,key){if(id==null){throw new TypeError('Missing argument: "id".')}if(target!=="nodes"&&target!=="edges"){throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target)}if(key==null){throw new TypeError('Missing argument: "key".')}var computedStyles,computedStyle,appliedStyles,item;if(target==="nodes"){computedStyles=_visionOnNodes.get(key)}else{computedStyles=_visionOnEdges.get(key)}var values=Object.keys(computedStyles);for(var k=0;k<values.length;k++){computedStyle=computedStyles[values[k]];appliedStyles=Object.keys(computedStyle.styles);for(var i=0;i<computedStyle.items.length;i++){item=computedStyle.items[i];if(item.id===id){for(var j=0;j<appliedStyles.length;j++){if(appliedStyles[j]!=="label"&&appliedStyles[j]!=="size"){delete item[appliedStyles[j]]}else if(appliedStyles[j]==="size"){item.size=1}}this.deprecate(target,key);return this}}}return this};this.clear=function(){this.reset();this.styles={nodes:{},edges:{}};this.palette={};_visionOnNodes.clear();_visionOnEdges.clear();_visionOnNodes=new Vision(s,"nodes",this.styles,this.palette);_visionOnEdges=new Vision(s,"edges",this.styles,this.palette);if(s)s.refresh({skipIndexation:true});return this};this.kill=function(){delete this.styles;delete this.palette;_visionOnNodes.clear();_visionOnEdges.clear()};this.utils={};this.utils.isSequential=function(target,property){if(!target)throw new TypeError('Missing argument: "target"');var v;switch(target){case"nodes":v=_visionOnNodes;break;case"edges":v=_visionOnEdges;break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target)}if(property===undefined)throw new TypeError('Missing argument: "property"');if(typeof property!=="string")throw new TypeError('Invalid argument: "property" is not a string, was '+property);if(!(property in v.dataTypes)||v.dataTypes[property].sequential===undefined){var val,found=false,isSequential=true;v.dataset().forEach(function(item){val=strToObjectRef(item,property);if(val!==undefined){found=true;isSequential=typeof val==="number"?isSequential:false}});if(found){v.dataTypes[property]={sequential:isSequential}}}return(v.dataTypes[property]||{}).sequential};this.utils.histogram=function(target,visualVar,property){if(!target)throw new TypeError('Missing argument: "target"');var v;switch(target){case"nodes":v=_visionOnNodes;break;case"edges":v=_visionOnEdges;break;default:throw new Error('Invalid argument: "target" is not "nodes" or "edges", was '+target)}if(v.visualVars.indexOf(visualVar)==-1)throw new Error('Unknown visual variable "'+visualVar+'".');if(property===undefined)throw new TypeError('Missing argument: "property".');if(typeof property!=="string")throw new TypeError('Invalid argument: "property" is not a string, was'+property);var isSequential=this.isSequential(target,property);if(!isSequential)throw new Error('The property "'+property+'" is not sequential.');var h=histogram(v.histograms[visualVar],property);if(visualVar==="color"){if(!self.styles[target].color){throw new Error('Missing key "color" in '+target+" palette.")}var bins=h.length,o=strToObjectRef(self.palette,self.styles[target].color.scheme);if(!o)throw new Error('Color scheme "'+self.styles[target].color.scheme+'" not in '+target+" palette.");if(isSequential){for(var bin=0;bin<bins;bin++){if(!o[bins])throw new Error('Missing key "'+bins+'" in '+target+' palette " of color scheme '+self.styles[target].color.scheme+'".');h[bin][visualVar]=o[bins][bin]}}}return h}}var _instance={};sigma.plugins.design=function(s,options){if(!_instance[s.id]){_instance[s.id]=new design(s,options)}return _instance[s.id]};sigma.plugins.killDesign=function(s){if(_instance[s.id]instanceof design){_instance[s.id].kill()}delete _instance[s.id]}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.settings");var settings={dragNodeStickiness:0};sigma.settings=sigma.utils.extend(sigma.settings||{},settings)}).call(this);(function(){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");function DragNodes(s,renderer,a){sigma.classes.dispatcher.extend(this);if(sigma.renderers.webgl&&renderer instanceof sigma.renderers.webgl)throw new Error("The sigma.plugins.dragNodes is not compatible with the WebGL renderer");var _self=this,_s=s,_a=a,_body=document.body,_renderer=renderer,_mouse=renderer.container.lastChild,_camera=renderer.camera,_node=null,_draggingNode=null,_prefix=renderer.options.prefix,_hoverStack=[],_hoverIndex={},_isMouseDown=false,_isMouseOverCanvas=false,_drag=false,_stickiness=s.settings("dragNodeStickiness");if(renderer instanceof sigma.renderers.svg){_mouse=renderer.container.firstChild}renderer.bind("hovers",nodeMouseOver);renderer.bind("hovers",treatOutNode);renderer.bind("click",click);_s.bind("kill",function(){_self.unbindAll()});this.unbindAll=function(){_mouse.removeEventListener("mousedown",nodeMouseDown);_body.removeEventListener("mousemove",nodeMouseMove);_body.removeEventListener("mouseup",nodeMouseUp);_renderer.unbind("hovers",nodeMouseOver);_renderer.unbind("hovers",treatOutNode)};function calculateOffset(element){var style=window.getComputedStyle(element);var getCssProperty=function(prop){return parseInt(style.getPropertyValue(prop).replace("px",""))||0};return{left:element.getBoundingClientRect().left+getCssProperty("padding-left"),top:element.getBoundingClientRect().top+getCssProperty("padding-top")}}function click(event){_isMouseDown=false;_body.removeEventListener("mousemove",nodeMouseMove);_body.removeEventListener("mouseup",nodeMouseUp);if(!_hoverStack.length){_node=null}else{setTimeout(function(){_node=_hoverStack[_hoverStack.length-1];_mouse.addEventListener("mousedown",nodeMouseDown)},0)}}function nodeMouseOver(event){if(event.data.enter.nodes.length==0){return}var n=event.data.enter.nodes[0];if(_hoverIndex[n.id]){return}_hoverStack.push(n);_hoverIndex[n.id]=true;if(!_isMouseDown){_node=_hoverStack[_hoverStack.length-1];_mouse.addEventListener("mousedown",nodeMouseDown)}}function treatOutNode(event){if(event.data.leave.nodes.length==0){return}var n=event.data.leave.nodes[0];var indexCheck=_hoverStack.map(function(e){return e}).indexOf(n);_hoverStack.splice(indexCheck,1);delete _hoverIndex[n.id];if(_hoverStack.length&&!_isMouseDown){_node=_hoverStack[_hoverStack.length-1]}else{_mouse.removeEventListener("mousedown",nodeMouseDown)}}function nodeMouseDown(event){if(event.which==3)return;_isMouseDown=true;if(_node&&_s.graph.nodes().length>0){_mouse.removeEventListener("mousedown",nodeMouseDown);_body.addEventListener("mousemove",nodeMouseMove);_body.addEventListener("mouseup",nodeMouseUp);_renderer.settings({mouseEnabled:false,enableHovering:false});_self.dispatchEvent("startdrag",{node:_node,captor:event,renderer:_renderer})}}function nodeMouseUp(event){_isMouseDown=false;_mouse.addEventListener("mousedown",nodeMouseDown);_body.removeEventListener("mousemove",nodeMouseMove);_body.removeEventListener("mouseup",nodeMouseUp);_renderer.settings({mouseEnabled:true,enableHovering:true});if(_drag){_self.dispatchEvent("drop",{node:_node,captor:event,renderer:_renderer});if(_a){var activeNodes=_a.nodes();for(var i=0;i<activeNodes.length;i++){delete activeNodes[i].alphaX;delete activeNodes[i].alphaY}}_s.refresh()}_self.dispatchEvent("dragend",{node:_node,captor:event,renderer:_renderer});_drag=false;_node=null}function nodeMouseMove(event){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){clearTimeout(timeOut);var timeOut=setTimeout(executeNodeMouseMove,0)}else{executeNodeMouseMove()}function executeNodeMouseMove(){var offset=calculateOffset(_renderer.container),x=event.clientX-offset.left,y=event.clientY-offset.top,cos=Math.cos(_camera.angle),sin=Math.sin(_camera.angle),nodes=_s.graph.nodes(),ref=[],x2,y2,activeNodes,n,aux,isHoveredNodeActive,dist;if(nodes.length<2)return;for(var i=0;i<2;i++){n=nodes[i];if(n){aux={x:n.x*cos+n.y*sin,y:n.y*cos-n.x*sin,renX:n[_prefix+"x"],renY:n[_prefix+"y"]};ref.push(aux)}}x=(x-ref[0].renX)/(ref[1].renX-ref[0].renX)*(ref[1].x-ref[0].x)+ref[0].x;y=(y-ref[0].renY)/(ref[1].renY-ref[0].renY)*(ref[1].y-ref[0].y)+ref[0].y;x2=x*cos-y*sin;y2=y*cos+x*sin;if(_stickiness>0){dist=sigma.utils.getDistance(x2,y2,_node.x,_node.y);if(dist<_stickiness)return}if(_a){activeNodes=_a.nodes();isHoveredNodeActive=-1<activeNodes.map(function(node){return node.id}).indexOf(_node.id);if(isHoveredNodeActive){for(var i=0;i<activeNodes.length;i++){if(_draggingNode!=_node){activeNodes[i].alphaX=null;activeNodes[i].alphaY=null}if(!activeNodes[i].alphaX||!activeNodes[i].alphaY){activeNodes[i].alphaX=activeNodes[i].x-x;activeNodes[i].alphaY=activeNodes[i].y-y}activeNodes[i].x=_node.x+activeNodes[i].alphaX;activeNodes[i].y=_node.y+activeNodes[i].alphaY}}}_node.x=x2;_node.y=y2;_s.refresh({skipIndexation:true});_drag=true;_self.dispatchEvent("drag",{node:_node,captor:event,renderer:_renderer});_draggingNode=_node}}}var _instance={};sigma.plugins.dragNodes=function(s,renderer,a){if(!_instance[s.id]){_instance[s.id]=new DragNodes(s,renderer,a)}s.bind("kill",function(){sigma.plugins.killDragNodes(s)});return _instance[s.id]};sigma.plugins.killDragNodes=function(s){if(_instance[s.id]instanceof DragNodes){_instance[s.id].unbindAll();delete _instance[s.id]}}}).call(window);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");function deepCopy(o){var copy=Object.create(null);for(var i in o){if(typeof o[i]==="object"&&o[i]!==null){copy[i]=deepCopy(o[i])}else if(typeof o[i]==="function"&&o[i]!==null){eval(" copy[i] = "+o[i].toString())}else copy[i]=o[i]}return copy}function find(id){var sibling,edges,e;if(sibling=this.siblingEdgesIndex[id]){edges=this.allNeighborsIndex[sibling.source][sibling.target];if(Object.keys(edges).length===1){e=this.edges(Object.keys(edges)[0]);if(e.type!=="parallel")throw new Error('The sibling container must be of type "parallel", was '+e.type);if(e.siblings===undefined)throw new Error('The sibling container has no "siblings" key.');if(Object.keys(e.siblings).length<2)throw new Error("The sibling container must have more than one sibling, had "+Object.keys(e.siblings).length);if(e.siblings[id]===undefined)throw new Error("Sibling container found but the edge sibling is missing.");return e}else if(Object.keys(edges).length>1){var eid;for(eid in edges){e=this.edges(eid);if(e.type==="parallel"&&e.siblings!==undefined){if(Object.keys(e.siblings).length){if(e.siblings[id]!==undefined){return e}}else throw new Error("Edge sibling found but its container is missing.")}}throw new Error("Edge sibling found but its container is missing.")}else throw new Error("Edge sibling found but its container is missing.")}else return this.edgesIndex[id]}function get(v){if(!arguments.length||v===undefined)return this.edgesArray.slice(0);if(arguments.length>1)throw new Error("Too many arguments. Use an array instead.");if(typeof v==="number"||typeof v==="string"){return find.call(this,v)}if(Array.isArray(v)){var i,l,a=[];for(i=0,l=v.length;i<l;i++)if(typeof v[i]==="number"||typeof v[i]==="string"){a.push(find.call(this,v[i]))}else throw new Error("Invalid argument: an edge id is not a string or a number, was "+v[i]);return a}throw new Error('Invalid argument: "v" is not a string or an array, was '+v)}function add(c,s){if(!c.siblings){var copy=deepCopy(c);c.siblings={};c.siblings[c.id]=copy;delete c.color;delete c.label;c.size=1;c.type="parallel";this.siblingEdgesIndex[copy.id]=copy}c.siblings[s.id]=s;this.siblingEdgesIndex[s.id]=s}function drop(c,sid){delete c.siblings[sid];delete this.siblingEdgesIndex[sid];if(Object.keys(c.siblings).length===1){var e=c.siblings[Object.keys(c.siblings)[0]];this.dropEdge(c.id);this.addEdge(e);delete this.siblingEdgesIndex[c.id];delete this.siblingEdgesIndex[e.id]}}if(!sigma.classes.graph.hasMethod("edgeSiblings"))sigma.classes.graph.addMethod("edgeSiblings",function(v){return get.call(this,v)});if(!sigma.classes.graph.hasMethod("addEdgeSibling"))sigma.classes.graph.addMethod("addEdgeSibling",function(edge){if(arguments.length==0)throw new TypeError("Missing argument.");if(Object(edge)!==edge)throw new TypeError('Invalid argument: "edge" is not an object, was '+edge);if(typeof edge.id!=="number"&&typeof edge.id!=="string")throw new TypeError('Invalid argument key: "edge.id" is not a string or a number, was '+edge.id);if(typeof edge.source!=="number"&&typeof edge.source!=="string"||!this.nodesIndex[edge.source])throw new Error('Invalid argument key: "edge.source" is not an existing node id, was '+edge.source);if(typeof edge.target!=="number"&&typeof edge.target!=="string"||!this.nodesIndex[edge.target])throw new Error('Invalid argument key: "edge.target" is not an existing node id, was '+edge.target);if(this.edgesIndex[edge.id])throw new Error('Invalid argument: an edge of id "'+edge.id+'" already exists.');if(this.siblingEdgesIndex[edge.id])throw new Error('Invalid argument: an edge sibling of id "'+edge.id+'" already exists.');var edges=this.allNeighborsIndex[edge.source][edge.target];if(edges!==undefined&&Object.keys(edges).length){var otherEdge=this.edges(edges[Object.keys(edges)[0]].id);add.call(this,otherEdge,edge)}else{this.addEdge(edge)}return this});if(!sigma.classes.graph.hasMethod("dropEdgeSibling"))sigma.classes.graph.addMethod("dropEdgeSibling",function(id){if(arguments.length==0)throw new TypeError("Missing argument.");if(typeof id!=="number"&&typeof id!=="string")throw new TypeError('Invalid argument: "id" is not a string or a number, was '+id);if(this.siblingEdgesIndex[id]){var container=find.call(this,id);drop.call(this,container,id)}else this.dropEdge(id);return this});if(!sigma.classes.graph.hasMethod("readWithSiblings"))sigma.classes.graph.addMethod("readWithSiblings",function(g){var i,a,l;a=g.nodes||[];for(i=0,l=a.length;i<l;i++)this.addNode(a[i]);a=g.edges||[];for(i=0,l=a.length;i<l;i++)this.addEdgeSibling(a[i]);return this});sigma.classes.graph.addIndex("siblingEdgesIndex",{constructor:function(){this.siblingEdgesIndex=Object.create(null)}})}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var _contexts,_types,_canvas,_canvasContext;_contexts=["scene","edges","nodes","labels"];_types={png:"image/png",jpg:"image/jpeg",gif:"image/gif",tiff:"image/tiff"};function dataURLToBlob(dataURL){var BASE64_MARKER=";base64,";if(dataURL.indexOf(BASE64_MARKER)==-1){var parts=dataURL.split(",");var contentType=parts[0].split(":")[1];var raw=decodeURIComponent(parts[1]);return new Blob([raw],{type:contentType})}var parts=dataURL.split(BASE64_MARKER);var contentType=parts[0].split(":")[1];var raw=window.atob(parts[1]);var rawLength=raw.length;var uInt8Array=new Uint8Array(rawLength);for(var i=0;i<rawLength;++i){uInt8Array[i]=raw.charCodeAt(i)}return new Blob([uInt8Array],{type:contentType})}function download(dataUrl,extension,filename){filename=filename||"graph."+extension;if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(dataURLToBlob(dataUrl),filename)}else if(navigator.msSaveBlob){navigator.msSaveBlob(dataURLToBlob(dataUrl),filename)}else{var anchor=document.createElement("a");anchor.setAttribute("href",dataUrl);anchor.setAttribute("download",filename);document.body.appendChild(anchor);anchor.click();document.body.removeChild(anchor)}}function calculateAspectRatioFit(srcWidth,srcHeight,maxSize){var ratio=Math.min(maxSize/srcWidth,maxSize/srcHeight);return{width:srcWidth*ratio,height:srcHeight*ratio}}function calculateZoomedBoundaries(s,r,params){var bounds;bounds=sigma.utils.getBoundaries(s.graph,r.camera.readPrefix);bounds.minX/=params.zoomRatio;bounds.minY/=params.zoomRatio;bounds.maxX/=params.zoomRatio;bounds.maxY/=params.zoomRatio;return bounds}function calculateRatio(s,r,params){var boundaries,margin=params.margin||0,ratio={width:r.width,height:r.height};if(!params.clips&&!params.size){boundaries=calculateZoomedBoundaries(s,r,params);ratio={width:boundaries.maxX-boundaries.minX+boundaries.sizeMax*2,height:boundaries.maxY-boundaries.minY+boundaries.sizeMax*2}}else if(params.size&&params.size>=1){ratio=calculateAspectRatioFit(r.width,r.height,params.size)}ratio.width+=margin;ratio.height+=margin;return ratio}function Image(s,r,params){params=params||{};if(params.format&&!(params.format in _types))throw Error('sigma.renderers.image: unsupported format "'+params.format+'".');var ratio=calculateRatio(s,r,params);var batchEdgesDrawing=s.settings("batchEdgesDrawing");if(batchEdgesDrawing){s.settings("batchEdgesDrawing",false)}if(!params.clip)this.clone(s,params,ratio);var merged=this.draw(r,params,ratio);s.settings("batchEdgesDrawing",batchEdgesDrawing);var dataUrl=merged.toDataURL(_types[params.format||"png"]);if(params.download)download(dataUrl,params.format||"png",params.filename);return dataUrl}Image.prototype.clone=function(s,params,ratio){params.tmpContainer=params.tmpContainer||"image-container";var el=document.getElementById(params.tmpContainer);if(!el){el=document.createElement("div");el.id=params.tmpContainer;document.body.appendChild(el)}el.setAttribute("style","width:"+ratio.width+"px;"+"height:"+Math.round(ratio.height)+"px;");var renderer=s.addRenderer({container:document.getElementById(params.tmpContainer),type:"canvas",settings:{batchEdgesDrawing:true,drawLabels:!!params.labels}});renderer.camera.ratio=params.zoomRatio>0?params.zoomRatio:1;var webgl=renderer instanceof sigma.renderers.webgl,sized=false,doneContexts=[];_canvas=document.createElement("canvas");_canvasContext=_canvas.getContext("2d");s.refresh();_contexts.forEach(function(name){if(!renderer.contexts[name])return;if(params.labels===false&&name==="labels")return;var canvas=renderer.domElements[name]||renderer.domElements.scene,context=renderer.contexts[name];if(!sized){_canvas.width=ratio.width;_canvas.height=ratio.height;if(webgl&&context instanceof WebGLRenderingContext){_canvas.width*=.5;_canvas.height*=.5}sized=true}if(context instanceof WebGLRenderingContext)_canvasContext.drawImage(canvas,0,0,canvas.width/2,canvas.height/2);else _canvasContext.drawImage(canvas,0,0);if(~doneContexts.indexOf(context))return;doneContexts.push(context)});doneContexts=[];s.killRenderer(renderer);el.parentNode.removeChild(el)};Image.prototype.draw=function(r,params,ratio){if(!params.size||params.size<1)params.size=window.innerWidth;var webgl=r instanceof sigma.renderers.webgl,sized=false,doneContexts=[];var merged=document.createElement("canvas"),mergedContext=merged.getContext("2d");_contexts.forEach(function(name){if(!r.contexts[name])return;if(params.labels===false&&name==="labels")return;var canvas=r.domElements[name]||r.domElements.scene,context=r.contexts[name];if(~doneContexts.indexOf(context))return;if(!sized){var width,height;if(!params.clip){width=_canvas.width;height=_canvas.height}else{width=canvas.width;height=canvas.height;ratio=calculateAspectRatioFit(width,height,params.size)}merged.width=ratio.width;merged.height=ratio.height;if(!webgl&&!context instanceof WebGLRenderingContext){merged.width*=2;merged.height*=2}sized=true;if(params.background){mergedContext.rect(0,0,merged.width,merged.height);mergedContext.fillStyle=params.background;mergedContext.fill()}}if(params.clip)mergedContext.drawImage(canvas,0,0,merged.width,merged.height);else mergedContext.drawImage(_canvas,0,0,merged.width,merged.height);doneContexts.push(context)});doneContexts=[];return merged};var _instance=null;sigma.plugins.image=function(s,r,options){sigma.plugins.killImage();if(!_instance){_instance=new Image(s,r,options)}return _instance};sigma.plugins.killImage=function(){if(_instance instanceof Image){_instance=null;_canvas=null;_canvasContext=null}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var _instance={};if(!sigma.classes.graph.hasMethod("adjacentNodes"))sigma.classes.graph.addMethod("adjacentNodes",function(id){if(typeof id!=="number"&&typeof id!=="string")throw new TypeError('Invalid argument: "id" is not a string or a number, was '+id);var target,nodes=[];for(target in this.allNeighborsIndex[id]){nodes.push(this.nodesIndex[target])}return nodes});if(!sigma.classes.graph.hasMethod("adjacentEdges"))sigma.classes.graph.addMethod("adjacentEdges",function(id){if(typeof id!=="number"&&typeof id!=="string")throw new TypeError('Invalid argument: "id" is not a string or a number, was '+id);
var a=this.allNeighborsIndex[id],eid,target,edges=[];for(target in a){for(eid in a[target]){edges.push(a[target][eid])}}return edges});function deepCopy(o){var copy=Object.create(null);for(var i in o){if(typeof o[i]==="object"&&o[i]!==null){copy[i]=deepCopy(o[i])}else if(typeof o[i]==="function"&&o[i]!==null){eval(" copy[i] = "+o[i].toString())}else copy[i]=o[i]}return copy}function cloneChain(chain){var copy=chain.slice(0);for(var i=0,len=copy.length;i<len;i++){copy[i]=deepCopy(copy[i])}return copy}function strToObjectRef(obj,str){return str.split(".").reduce(function(obj,i){return obj[i]},obj)}var Processors={};Processors.nodes=function(g,fn,params){if(!g)return;var n=g.nodes(),ln=n.length,e=g.edges(),le=e.length;while(ln--)n[ln].hidden=!fn.call({graph:g,get:strToObjectRef},n[ln],params)||n[ln].hidden;while(le--)if(g.nodes(e[le].source).hidden||g.nodes(e[le].target).hidden)e[le].hidden=true};Processors.edges=function(g,fn,params){if(!g)return;var e=g.edges(),le=e.length;while(le--)e[le].hidden=!fn.call({graph:g,get:strToObjectRef},e[le],params)||e[le].hidden};Processors.neighbors=function(g,id){if(!g)return;var n=g.nodes(),ln=n.length,e=g.edges(),le=e.length,neighbors=g.adjacentNodes(id),nn=neighbors.length,no={};while(nn--)no[neighbors[nn].id]=true;while(ln--)if(n[ln].id!==id&&!(n[ln].id in no))n[ln].hidden=true;while(le--)if(g.nodes(e[le].source).hidden||g.nodes(e[le].target).hidden)e[le].hidden=true};Processors.undo=function(g){if(!g)return;var n=g.nodes(),ln=n.length,e=g.edges(),le=e.length;while(ln--)n[ln].hidden=false;while(le--)e[le].hidden=false};function Filter(s){var _self=this,_s=s,_g=s.graph,_chain=[],_keysIndex=Object.create(null);function register(processor,p,params,key){if(arguments[3]===undefined){if(typeof arguments[2]!=="object"){key=params;params=null}}if(key!==undefined&&typeof key!=="number"&&typeof key!=="string")throw new TypeError('Invalid argument: "key" is not a number or a string, was '+key);if(key!==undefined&&typeof key==="string"&&!key.length)throw new TypeError('Invalid argument: "key" is an empty string.');if(typeof processor!=="string")throw new TypeError('Invalid argument: "processor" is not a string, was '+processor);if("undo"===key)throw new Error('Invalid argument: "key" has value "undo", which is a reserved keyword.');if(_keysIndex[key])throw new Error('Invalid argument: the filter of key "'+key+'" already exists.');if(key)_keysIndex[key]=true;_chain.push({key:key,processor:processor,predicate:p,options:params||{}})}function unregister(o){_chain=_chain.filter(function(a){return!(a.key in o)});for(var key in o)delete _keysIndex[key]}this.has=function(key){return _keysIndex[key]};this.nodesBy=function(fn,params,key){register("nodes",fn,params,key);return this};this.edgesBy=function(fn,params,key){register("edges",fn,params,key);return this};this.neighborsOf=function(id,params,key){if(typeof id!=="number"&&typeof id!=="string")throw new TypeError("Invalid argument: id is not a string or a number, was "+id);if(typeof id==="string"&&!id.length)throw new TypeError("Invalid argument: id is an empty string.");register("neighbors",id,params,key);return this};this.apply=function(){for(var i=0,len=_chain.length;i<len;++i){switch(_chain[i].processor){case"nodes":Processors.nodes(_g,_chain[i].predicate,_chain[i].options);break;case"edges":Processors.edges(_g,_chain[i].predicate,_chain[i].options);break;case"neighbors":Processors.neighbors(_g,_chain[i].predicate);break;case"undo":Processors.undo(_g,_chain[i].predicate);break;default:throw new Error("Unknown processor "+_chain[i].processor)}}if(_chain[0]&&"undo"===_chain[0].key){_chain.shift()}if(_s)_s.refresh();return this};this.undo=function(v){var q=Object.create(null),la=arguments.length;if(la===1){if(Object.prototype.toString.call(v)==="[object Array]")for(var i=0,len=v.length;i<len;i++)q[v[i]]=true;else q[v]=true}else if(la>1){for(var i=0;i<la;i++)q[arguments[i]]=true}else this.clear();unregister(q);_chain.unshift({key:"undo",processor:"undo"});return this};this.clear=function(){_chain.length=0;_keysIndex=Object.create(null);return this};this.kill=function(){this.clear();delete _instance[_s.id];_g=null;_s=null;return this};this.serialize=function(){var copy=cloneChain(_chain);for(var i=0,len=copy.length;i<len;i++){copy[i].predicate=copy[i].predicate.toString().replace(/\s+/g," ").replace(/"use strict"; /,"")}return copy};this.load=function(chain){if(chain===undefined)throw new TypeError("Missing argument.");if(!Array.isArray(chain))throw new TypeError('Invalid argument: "chain" is not an array, was '+chain);this.clear();var copy=cloneChain(chain);for(var i=0,len=copy.length;i<len;i++){if(copy[i].predicate===undefined)throw new TypeError('Missing filter key: "predicate".');if(copy[i].processor===undefined)throw new TypeError('Missing filter key: "processor".');if(copy[i].key!=undefined&&typeof copy[i].key!=="string")throw new TypeError('Invalid filter key: "key" is not a string, was '+copy[i].key.toString());if(typeof copy[i].predicate==="string")eval(" copy[i].predicate = "+copy[i].predicate);if(typeof copy[i].predicate!=="function")throw new TypeError('Invalid filter key: "predicate" of key "'+copy[i].key+'" is not a function.');if(typeof copy[i].processor!=="string")throw new TypeError('Invalid filter key: "processor" of key "'+copy[i].key+'" is not a string.');if(copy[i].key)_keysIndex[copy[i].key]=true}_chain=copy;return this}}sigma.plugins.filter=function(s){if(!_instance[s.id]){_instance[s.id]=new Filter(s);s.bind("kill",function(){sigma.plugins.killFilter(s)})}return _instance[s.id]};sigma.plugins.killFilter=function(s){if(_instance[s.id]instanceof Filter){_instance[s.id].kill()}delete _instance[s.id]}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";var _self=null,_eventListenerElement=null;function toggleFullScreen(){if(!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(_self.container.requestFullscreen){_self.container.requestFullscreen()}else if(_self.container.msRequestFullscreen){_self.container.msRequestFullscreen()}else if(_self.container.mozRequestFullScreen){_self.container.mozRequestFullScreen()}else if(_self.container.webkitRequestFullscreen){_self.container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}else{if(document.exitFullscreen){document.exitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}function fullScreen(btn){_self=this,_eventListenerElement=null;if(btn){_eventListenerElement=document.getElementById(btn.id);_eventListenerElement.removeEventListener("click",toggleFullScreen);_eventListenerElement.addEventListener("click",toggleFullScreen)}else{toggleFullScreen()}}function killFullScreen(){toggleFullScreen();_self=null;if(_eventListenerElement)_eventListenerElement.removeEventListener("click",toggleFullScreen)}sigma.renderers.canvas.prototype.fullScreen=fullScreen;sigma.renderers.webgl.prototype.fullScreen=fullScreen;sigma.renderers.canvas.prototype.killFullScreen=killFullScreen;sigma.renderers.webgl.prototype.killFullScreen=killFullScreen}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");sigma.plugins.generators={};function isNumber(value){return value===value&&Object.prototype.toString.call(value)==="[object Number]"}function isObject(value){return typeof value==="object"&&!!value}sigma.plugins.generators.random=function(options){if(!options)throw new Error("Missing argument: options");if(!isObject(options))throw new TypeError("Invalid argument: options is not an object, was "+options);if(!isNumber(options.nbNodes)||options.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+options.nbNodes);if(!isNumber(options.nbEdges)||options.nbEdges<1)throw new TypeError("Invalid argument: options.nbEdges is not a number, was "+options.nbEdges);var i,N=options.nbNodes,E=options.nbEdges,g={nodes:[],edges:[]};for(i=0;i<N;i++)g.nodes.push({id:"n"+i,label:"Node "+i,x:Math.random(),y:Math.random(),size:1});for(i=0;i<E;i++)g.edges.push({id:"e"+i,label:"Edge "+i,source:"n"+(Math.random()*N|0),target:"n"+(Math.random()*N|0)});return g};sigma.plugins.generators.balancedTree=function(options){if(!options)throw new Error("Missing argument: options");if(!isObject(options))throw new TypeError("Invalid argument: options is not an object, was "+options);if(!isNumber(options.nbChildren)||options.nbChildren<1)throw new TypeError("Invalid argument: options.nbChildren is not a positive number, was "+options.nbChildren);if(!isNumber(options.height)||options.height<1)throw new TypeError("Invalid argument: options.height is not a positive number, was "+options.height);var v=0,m=0,R=options.nbChildren,H=options.height,graph={nodes:[{id:"n0",label:"Node 0",x:Math.random(),y:Math.random(),size:1,index:0}],edges:[]},newLeaves=[],i,j,height,node,leaves;for(i=0;i<R;i++){node={id:"n"+ ++v,label:"Node "+v,x:Math.random(),y:Math.random(),size:1,index:v-1};graph.nodes.push(node);newLeaves.push(node);graph.edges.push({id:"e"+m++,label:"Edge "+m,source:"n0",target:"n"+v})}for(height=1;height<H;height++){leaves=newLeaves;newLeaves=[];for(j=0;j<leaves.length;j++){for(i=0;i<R;i++){node={id:"n"+ ++v,label:"Node "+v,x:Math.random(),y:Math.random(),size:1,index:v-1};newLeaves.push(node);graph.nodes.push(node);graph.edges.push({id:"e"+m++,label:"Edge "+m,source:"n"+leaves[j].index,target:"n"+v})}}}return graph};sigma.plugins.generators.erdosRenyi=function(options){if(!options)throw new Error("Missing argument: options");if(!isObject(options))throw new TypeError("Invalid argument: options is not an object, was "+options);if(!isNumber(options.nbNodes)||options.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+options.nbNodes);if(options.nbNodes<3)throw new TypeError("Invalid argument: options.nbNodes is smaller than 3, was "+options.nbNodes);if("nbEdges"in options&&"p"in options)throw new TypeError("Invalid argument: choose between options.nbEdges and options.p");var graph={nodes:[],edges:[]},edge,i,j,k=0,N=options.nbNodes,P=options.p;if(options.p>=0){if(!isNumber(options.p)||options.p<0)throw new TypeError("Invalid argument: options.p is not a positive number, was "+options.p);for(i=0;i<N;i++){graph.nodes.push({id:"n"+i,label:"Node "+i,x:Math.random(),y:Math.random(),size:1});for(j=0;j<i;j++){if(Math.random()<P){graph.edges.push({id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+j})}}}}else{if(!isNumber(options.nbEdges)||options.nbEdges<1)throw new TypeError("Invalid argument: options.nbEdges is not a positive number, was "+options.nbEdges);var tmpEdges=[],M=options.nbEdges,k;for(i=0;i<N;i++){graph.nodes.push({id:"n"+i,label:"Node "+i,x:Math.random(),y:Math.random(),size:1});for(j=i+1;j<N;j++){tmpEdges.push({source:"n"+i,target:"n"+j})}}k=tmpEdges.length-1;for(i=0;i<M;i++){edge=tmpEdges.splice(Math.floor(Math.random()*k),1)[0];edge.id="e"+i;edge.label="Edge "+i;graph.edges.push(edge);k--}}return graph};sigma.plugins.generators.barabasiAlbert=function(options){if(!options)throw new Error("Missing argument: options");if(!isObject(options))throw new TypeError("Invalid argument: options is not an object, was "+options);if(!isNumber(options.nbNodes)||options.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+options.nbNodes);if(options.nbNodes<3)throw new TypeError("Invalid argument: options.nbNodes is smaller than 3, was "+options.nbNodes);if(!isNumber(options.m0)||options.m0<=0)throw new TypeError("Invalid argument: options.m0 is not a positive number, was "+options.m0);if(!isNumber(options.m)||options.m<=0)throw new TypeError("Invalid argument: options.m is not a positive number, was "+options.m);if(options.m0>=options.nbNode)throw new TypeError("Invalid argument: options.m0 is greater than options.nbNodes, was "+options.m0);if(options.m>options.m0)throw new TypeError("Invalid argument: options.m is strictly greater than options.m0, was "+options.m);var graph={nodes:[],edges:[]},edge_lut={},degrees=[],i,j,edge,sum,s,m,r,p,k=0,N=options.nbNodes,m0=options.m0,M=options.m;for(i=0;i<m0;i++){graph.nodes.push({id:"n"+i,label:"node "+i,x:Math.random(),y:Math.random(),size:1});degrees[i]=0}for(i=0;i<m0;i++){for(j=i+1;j<m0;j++){edge={id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+j};edge_lut[edge.source+"-"+edge.target]=edge;graph.edges.push(edge);degrees[i]++;degrees[j]++}}for(i=m0;i<N;i++){graph.nodes.push({id:"n"+i,label:"node "+i,x:Math.random(),y:Math.random(),size:1});degrees[i]=0;sum=0;for(j=0;j<i;j++)sum+=degrees[j];s=0;for(m=0;m<M;m++){r=Math.random();p=0;for(j=0;j<i;j++){if(edge_lut[i+"-"+j]||edge_lut[j+"-"+i])continue;if(i==1)p=1;else{p+=degrees[j]/sum+s/(i-m)}if(r<=p){s+=degrees[j]/sum;edge={id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+j};edge_lut[edge.source+"-"+edge.target]=edge;graph.edges.push(edge);degrees[i]++;degrees[j]++;break}}}}return graph};sigma.plugins.generators.wattsStrogatz=function(options){if(!options)throw new Error("Missing argument: options");if(!isObject(options))throw new TypeError("Invalid argument: options is not an object, was "+options);if(!isNumber(options.nbNodes)||options.nbNodes<1)throw new TypeError("Invalid argument: options.nbNodes is not a positive number, was "+options.nbNodes);if(options.nbNodes<3)throw new TypeError("Invalid argument: options.nbNodes is smaller than 3, was "+options.nbNodes);if(!isNumber(options.k)||options.k%2!=0)throw new TypeError("Invalid argument: options.k is not an even integer, was "+options.k);var graph={nodes:[],edges:[]},i,j,k=0,edge,edge_lut={},N=options.nbNodes,K=options.k;function calculateRij(i,j){if(i==j||edge_lut[i+"-"+j])return 0;var mij=calculatemij(i,j);if(mij>=K)return 1;if(mij===0)return p;return Math.pow(mij/K,options.alpha)*(1-p)+p}function calculatemij(i,j){var mij=0,l;for(l=0;l<N;l++){if(l!=i&&l!=j&&edge_lut[i+"-"+l]&&edge_lut[j+"-"+l]){mij++}}return mij}if("alpha"in options){if(!isNumber(options.alpha)||options.alpha<0||options.alpha>1)throw new TypeError("Invalid argument: options.alpha is not a number between [0,1], was "+options.alpha);var p=Math.pow(10,-10),ec=0,ids=[],nk_half=N*K/2,Rij,sumRij,r,pij;for(i=0;i<N;i++){graph.nodes.push({id:"n"+i,label:"Node "+i,x:Math.random(),y:Math.random(),size:1});edge={id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+(i+1)%N};edge_lut[edge.source+"-"+edge.target]=edge;graph.edges.push(edge);ec++}while(ec<nk_half){for(i=0;i<N;i++){ids.push(i)}while(ec<nk_half&&ids.length>0){i=ids.splice(Math.floor(Math.random()*ids.length),1)[0];Rij=[];sumRij=0;for(j=0;j<N;j++){Rij[j]=calculateRij(i,j);sumRij+=Rij[j]}r=Math.random();pij=0;for(j=0;j<N;j++){if(i!=j){pij+=Rij[j]/sumRij;if(r<=pij){edge={id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+j};graph.edges.push(edge);ec++;edge_lut[edge.source+"-"+edge.target]=edge}}}}}}else{if(!isNumber(options.beta)||options.beta<0||options.beta>1)throw new TypeError("Invalid argument: options.beta is not a number between [0,1], was "+options.beta);var t;K=K>>1;for(i=0;i<N;i++){graph.nodes.push({id:"n"+i,label:"node "+i,x:Math.random(),y:Math.random(),size:1});for(j=1;j<=K;j++){edge={id:"e"+k++,label:"Edge "+k,source:"n"+i,target:"n"+(i+j)%N};edge_lut[edge.source+"-"+edge.target]=edge;graph.edges.push(edge)}}for(i=0;i<N;i++){for(j=1;j<=K;j++){if(Math.random()<=options.beta){do{t=Math.floor(Math.random()*(N-1))}while(t==i||edge_lut["n"+i+"-n"+t]);var j_=(i+j)%N;edge_lut["n"+i+"-n"+j_].target="n"+t;edge_lut["n"+i+"-n"+t]=edge_lut["n"+i+"-n"+j_];delete edge_lut["n"+i+"-n"+j_]}}}}return graph};sigma.plugins.generators.path=function(length){if(!length||length<0){throw new TypeError('Invalid argument: "length" is not a positive number, was '+length)}var graph={nodes:[{id:"n0",label:"Node 0",x:Math.random(),y:Math.random(),size:1}],edges:[]};for(var i=1;i<length;++i){graph.nodes.push({id:"n"+i,label:"Node "+i,x:Math.random(),y:Math.random(),size:1});graph.edges.push({id:"e"+i,label:"Edge "+i,source:"n"+(i-1),target:"n"+i})}return graph};sigma.plugins.generators.grid=function(n,m){if(n<1)throw new TypeError('Invalid argument: "n" is not a positive integer, was '+n);if(m<1)throw new TypeError('Invalid argument: "m" is not a positive integer, was '+m);var graph={nodes:[],edges:[]},i,j,k=0,nodeids=[],source,target;nodeids.length=n*m;if(n===1&&m===1){graph.nodes.push({id:"n0",label:"Node 0",x:Math.random(),y:Math.random(),size:1});return graph}for(i=0;i<n;++i){for(j=0;j<m;++j){source=i+j*n;if(!nodeids[source]){graph.nodes.push({id:"n"+source,label:"Node "+source,x:Math.random(),y:Math.random(),size:1});nodeids[source]=true}if(i>0){target=i-1+j*n;if(!nodeids[target]){graph.nodes.push({id:"n"+target,label:"Node "+target,x:Math.random(),y:Math.random(),size:1});nodeids[target]=true}graph.edges.push({id:"e"+k++,label:"Edge "+k,source:"n"+source,target:"n"+target})}if(j>0){target=i+(j-1)*n;if(!nodeids[target]){graph.nodes.push({id:"n"+target,label:"Node "+target,x:Math.random(),y:Math.random(),size:1});nodeids[target]=true}graph.edges.push({id:"e"+k++,label:"Edge "+k,source:"n"+source,target:"n"+target})}}}return graph}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma.plugins.keyboard: sigma is not declared";sigma.utils.pkg("sigma.plugins");var settings={displacement:100,duration:200,zoomingRatio:1.7,autofocus:true,tabIndex:-1};var _instance={};function Keyboard(s,renderer,params){params=sigma.utils.extend(params,settings);params.zoomingRatio=params.zoomingRatio||s.settings("zoomingRatio");params.duration=params.duration||s.settings("mouseZoomDuration");this.domElt=renderer.container;this.keys={};this.currentEvents=null;var self=this;sigma.classes.dispatcher.extend(this);function camera(o){var ratio=Math.max(s.settings("zoomMin"),Math.min(s.settings("zoomMax"),s.camera.ratio*(o.ratio||1)));sigma.misc.animation.camera(s.camera,{x:s.camera.x+(o.x||0),y:s.camera.y+(o.y||0),ratio:ratio},{duration:o.duration})}function moveLeft(){camera({x:-params.displacement,duration:params.duration})}function moveTop(){camera({y:-params.displacement,duration:params.duration})}function moveRight(){camera({x:params.displacement,duration:params.duration})}function moveDown(){camera({y:params.displacement,duration:params.duration})}function zoomIn(){camera({ratio:1/params.zoomingRatio,duration:params.duration})}function zoomOut(){camera({ratio:params.zoomingRatio,duration:params.duration})}this.keyDown=function(event){if(event.which!==9&&event.which!==18&&event.which!==20&&!self.keys[event.which]){self.keys[event.which]=true;self.currentEvents=Object.keys(self.keys).join("+");self.dispatchEvent(self.currentEvents)}};this.keyUp=function(event){delete self.keys[event.which];self.currentEvents=null};this.focus=function(event){self.domElt.focus();return true};this.blur=function(event){self.domElt.blur();self.keys={};self.currentEvents=null;return true};this.domElt.tabIndex=params.tabIndex;if(params.autofocus){this.domElt.focus();this.domElt.addEventListener("mouseover",this.focus,false);this.domElt.addEventListener("mouseout",this.blur,false)}this.domElt.addEventListener("keydown",this.keyDown,false);this.domElt.addEventListener("keyup",this.keyUp,false);this.bind("37 18+37",moveLeft);this.bind("38 18+38",moveTop);this.bind("39 18+39",moveRight);this.bind("40 18+40",moveDown);this.bind("32+38 18+32+38",zoomIn);this.bind("32+40 18+32+40",zoomOut)}sigma.plugins.keyboard=function(s,renderer,options){if(!_instance[s.id]){_instance[s.id]=new Keyboard(s,renderer,options);s.bind("kill",function(){sigma.plugins.killKeyboard(s)})}return _instance[s.id]};sigma.plugins.killKeyboard=function(s){if(_instance[s.id]instanceof Keyboard){_instance[s.id].unbind();_instance[s.id].domElt.removeEventListener("mouseover",_instance[s.id].focus,false);_instance[s.id].domElt.removeEventListener("mouseout",_instance[s.id].blur,false);_instance[s.id].domElt.removeEventListener("keydown",_instance[s.id].keyDown,false);_instance[s.id].domElt.removeEventListener("keyup",_instance[s.id].keyUp,false);_instance[s.id].domElt=null;_instance[s.id].keys={};_instance[s.id].currentEvents=null;delete _instance[s.id]}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var _body=undefined,_instances={};function Lasso(sigmaInstance,renderer,settings){sigma.classes.dispatcher.extend(this);if(sigma.renderers.webgl&&renderer instanceof sigma.renderers.webgl)throw new Error("The sigma.plugins.lasso is not compatible with the WebGL renderer");this.sigmaInstance=sigmaInstance;this.renderer=renderer;this.drawingCanvas=undefined;this.drawingContext=undefined;this.drewPoints=[];this.selectedNodes=[];this.isActive=false;this.isDrawing=false;_body=document.body;this.settings=new sigma.classes.configurable({strokeStyle:"black",lineWidth:2,fillWhileDrawing:false,fillStyle:"rgba(200, 200, 200, 0.25)",cursor:"crosshair"},settings||{})}Lasso.prototype.clear=function(){this.deactivate();this.sigmaInstance=undefined;this.renderer=undefined;return this};Lasso.prototype.activate=function(){if(this.sigmaInstance&&!this.isActive){this.isActive=true;if(!this.renderer.domElements["lasso"]){this.renderer.initDOM("canvas","lasso");this.drawingCanvas=this.renderer.domElements["lasso"];this.drawingCanvas.width=this.renderer.container.offsetWidth;this.drawingCanvas.height=this.renderer.container.offsetHeight;this.renderer.container.appendChild(this.drawingCanvas);this.drawingContext=this.drawingCanvas.getContext("2d");this.drawingCanvas.style.cursor=this.settings("cursor")}_bindAll.apply(this)}return this};Lasso.prototype.deactivate=function(){if(this.sigmaInstance&&this.isActive){this.isActive=false;this.isDrawing=false;_unbindAll.apply(this);if(this.renderer.domElements["lasso"]){this.renderer.container.removeChild(this.renderer.domElements["lasso"]);delete this.renderer.domElements["lasso"];this.drawingCanvas.style.cursor="";this.drawingCanvas=undefined;this.drawingContext=undefined;this.drewPoints=[]}}return this};var _bindAll=function(){this.drawingCanvas.addEventListener("mousedown",onDrawingStart.bind(this));_body.addEventListener("mousemove",onDrawing.bind(this));_body.addEventListener("mouseup",onDrawingEnd.bind(this));this.drawingCanvas.addEventListener("touchstart",onDrawingStart.bind(this));_body.addEventListener("touchmove",onDrawing.bind(this));_body.addEventListener("touchcancel",onDrawingEnd.bind(this));_body.addEventListener("touchleave",onDrawingEnd.bind(this));_body.addEventListener("touchend",onDrawingEnd.bind(this))};var _unbindAll=function(){this.drawingCanvas.removeEventListener("mousedown",onDrawingStart.bind(this));_body.removeEventListener("mousemove",onDrawing.bind(this));_body.removeEventListener("mouseup",onDrawingEnd.bind(this));this.drawingCanvas.removeEventListener("touchstart",onDrawingStart.bind(this));this.drawingCanvas.removeEventListener("touchmove",onDrawing.bind(this));_body.removeEventListener("touchcancel",onDrawingEnd.bind(this));_body.removeEventListener("touchleave",onDrawingEnd.bind(this));_body.removeEventListener("touchend",onDrawingEnd.bind(this))};Lasso.prototype.getSelectedNodes=function(){return this.selectedNodes};function onDrawingStart(event){var drawingRectangle=this.drawingCanvas.getBoundingClientRect();if(this.isActive){this.isDrawing=true;this.drewPoints=[];this.selectedNodes=[];this.sigmaInstance.refresh();this.drewPoints.push({x:event.clientX-drawingRectangle.left,y:event.clientY-drawingRectangle.top});this.drawingCanvas.style.cursor=this.settings("cursor");event.stopPropagation()}}function onDrawing(event){if(this.isActive&&this.isDrawing){var x=0,y=0,drawingRectangle=this.drawingCanvas.getBoundingClientRect();switch(event.type){case"touchmove":x=event.touches[0].clientX;y=event.touches[0].clientY;break;default:x=event.clientX;y=event.clientY;break}this.drewPoints.push({x:x-drawingRectangle.left,y:y-drawingRectangle.top});this.drawingContext.lineWidth=this.settings("lineWidth");this.drawingContext.strokeStyle=this.settings("strokeStyle");this.drawingContext.fillStyle=this.settings("fillStyle");this.drawingContext.lineJoin="round";this.drawingContext.lineCap="round";this.drawingContext.clearRect(0,0,this.drawingContext.canvas.width,this.drawingContext.canvas.height);var sourcePoint=this.drewPoints[0],destinationPoint=this.drewPoints[1],pointsLength=this.drewPoints.length,getMiddlePointCoordinates=function(firstPoint,secondPoint){return{x:firstPoint.x+(secondPoint.x-firstPoint.x)/2,y:firstPoint.y+(secondPoint.y-firstPoint.y)/2}};this.drawingContext.beginPath();this.drawingContext.moveTo(sourcePoint.x,sourcePoint.y);for(var i=1;i<pointsLength;i++){var middlePoint=getMiddlePointCoordinates(sourcePoint,destinationPoint);this.drawingContext.quadraticCurveTo(sourcePoint.x,sourcePoint.y,middlePoint.x,middlePoint.y);sourcePoint=this.drewPoints[i];destinationPoint=this.drewPoints[i+1]}this.drawingContext.lineTo(sourcePoint.x,sourcePoint.y);this.drawingContext.stroke();if(this.settings("fillWhileDrawing")){this.drawingContext.fill()}event.stopPropagation()}}function onDrawingEnd(event){if(this.isActive&&this.isDrawing){this.isDrawing=false;var nodes=this.renderer.nodesOnScreen,nodesLength=nodes.length,i=0,prefix=this.renderer.options.prefix||"";while(nodesLength--){var node=nodes[nodesLength],x=node[prefix+"x"],y=node[prefix+"y"];if(this.drawingContext.isPointInPath(x,y)&&!node.hidden){this.selectedNodes.push(node)}}this.dispatchEvent("selectedNodes",this.selectedNodes);this.drawingContext.clearRect(0,0,this.drawingCanvas.width,this.drawingCanvas.height);this.drawingCanvas.style.cursor=this.settings("cursor");event.stopPropagation()}}sigma.plugins.lasso=function(sigmaInstance,renderer,settings){if(!_instances[sigmaInstance.id]){_instances[sigmaInstance.id]=new Lasso(sigmaInstance,renderer,settings)}sigmaInstance.bind("kill",function(){if(_instances[sigmaInstance.id]instanceof Lasso){_instances[sigmaInstance.id].clear();delete _instances[sigmaInstance.id]}});return _instances[sigmaInstance.id]}}).call(this);(function(){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var settings={animation:{node:{duration:300},edge:{duration:300},center:{duration:300}},padding:{top:0,right:0,bottom:0,left:0},focusOut:false,zoomDef:null};var _instance={};function getRescalePosition(s){var autoRescale=s.settings("autoRescale");if(autoRescale){if(Array.isArray(autoRescale)){return autoRescale.indexOf("nodePosition")!==-1}return true}return false}function getBoundaries(nodes,prefix){var i,l,sizeMax=-Infinity,minX=Infinity,minY=Infinity,maxX=-Infinity,maxY=-Infinity;for(i=0,l=nodes.length;i<l;i++){sizeMax=Math.max(nodes[i][prefix+"size"],sizeMax);maxX=Math.max(nodes[i][prefix+"x"],maxX);minX=Math.min(nodes[i][prefix+"x"],minX);maxY=Math.max(nodes[i][prefix+"y"],maxY);minY=Math.min(nodes[i][prefix+"y"],minY)}sizeMax=sizeMax||1;return{sizeMax:sizeMax,minX:minX,minY:minY,maxX:maxX,maxY:maxY}}function Locate(s,options){var self=this;this.s=s;this.settings=sigma.utils.extend(options,settings);this.settings.zoomDef=this.settings.zoomDef||this.s.settings("zoomMax");this.s.bind("kill",function(){sigma.plugins.killLocate(self.s)});function target(boundaries){var x,y,ratio,width,height,rendererWidth,rendererHeight;x=(boundaries.minX+boundaries.maxX)*.5;y=(boundaries.minY+boundaries.maxY)*.5;if(getRescalePosition(self.s)){var graphBoundaries,graphRect,graphWidth,graphHeight,rect;rect=self.s.camera.getRectangle(boundaries.maxX-boundaries.minX,boundaries.maxY-boundaries.minY);width=rect.x2-rect.x1||1;height=rect.height||1;graphBoundaries=sigma.utils.getBoundaries(self.s.graph,self.s.camera.readPrefix);graphRect=self.s.camera.getRectangle(graphBoundaries.maxX-graphBoundaries.minX,graphBoundaries.maxY-graphBoundaries.minY);graphWidth=graphRect.x2-graphRect.x1||1;graphHeight=graphRect.height||1;rendererWidth=graphWidth-self.settings.padding.left-self.settings.padding.right;rendererHeight=graphHeight-self.settings.padding.top-self.settings.padding.bottom;ratio=Math.max(width/rendererWidth,height/rendererHeight)}else{width=boundaries.maxX-boundaries.minX+boundaries.sizeMax*2;height=boundaries.maxY-boundaries.minY+boundaries.sizeMax*2;rendererWidth=self.s.renderers[0].width-self.settings.padding.left-self.settings.padding.right;rendererHeight=self.s.renderers[0].height-self.settings.padding.top-self.settings.padding.bottom;ratio=Math.max(width/rendererWidth,height/rendererHeight)}ratio=Math.max(self.s.settings("zoomMin"),Math.min(self.s.settings("zoomMax"),ratio));x+=(self.settings.padding.right-self.settings.padding.left)*ratio*.5;y+=(self.settings.padding.bottom-self.settings.padding.top)*ratio*.5;return{x:x,y:y,ratio:ratio}}this.nodes=function(v,options){if(arguments.length<1)throw new TypeError("Too few arguments.");if(arguments.length===3&&typeof options!=="object")throw new TypeError('Invalid argument: "options" is not an object, was '+options);var t,n,animationOpts=sigma.utils.extend(options,self.settings.animation.node),ratio=self.s.camera.ratio,rescalePosition=getRescalePosition(self.s);if(typeof v==="string"||typeof v==="number"){n=self.s.graph.nodes(v);if(n===undefined)throw new Error('Invalid argument: the node of id "'+v+'" does not exist.');t={x:n[self.s.camera.readPrefix+"x"],y:n[self.s.camera.readPrefix+"y"],ratio:rescalePosition?self.s.settings("zoomMin"):self.settings.zoomDef}}else if(Array.isArray(v)){var boundaries=getBoundaries(v.map(function(id){return self.s.graph.nodes(id)}),self.s.camera.readPrefix);t=target(boundaries)}else throw new TypeError('Invalid argument: "v" is not a string, a number, or an array, was '+v);if(self.settings.focusOut&&rescalePosition){sigma.misc.animation.camera(s.camera,{x:(self.s.camera.x+t.x)*.5,y:(self.s.camera.y+t.y)*.5,ratio:self.settings.zoomDef},{duration:animationOpts.duration,onComplete:function(){sigma.misc.animation.camera(self.s.camera,t,animationOpts)}})}else{sigma.misc.animation.camera(self.s.camera,t,animationOpts)}return self};this.edges=function(v,options){if(arguments.length<1)throw new TypeError("Too few arguments.");if(arguments.length===3&&typeof options!=="object")throw new TypeError('Invalid argument: "options" is not an object, was '+options);var t,e,boundaries,animationOpts=sigma.utils.extend(options,self.settings.animation.edge),ratio=self.s.camera.ratio,rescalePosition=getRescalePosition(self.s);if(typeof v==="string"||typeof v==="number"){e=self.s.graph.edges(v);if(e===undefined)throw new Error('Invalid argument: the edge of id "'+v+'" does not exist.');boundaries=getBoundaries([self.s.graph.nodes(e.source),self.s.graph.nodes(e.target)],self.s.camera.readPrefix);t=target(boundaries)}else if(Array.isArray(v)){var i,l,nodes=[];for(i=0,l=v.length;i<l;i++){e=self.s.graph.edges(v[i]);nodes.push(self.s.graph.nodes(e.source));nodes.push(self.s.graph.nodes(e.target))}boundaries=getBoundaries(nodes,self.s.camera.readPrefix);t=target(boundaries)}else throw new TypeError('Invalid argument: "v" is not a string or a number, or an array, was '+v);if(self.settings.focusOut&&rescalePosition){sigma.misc.animation.camera(s.camera,{x:(self.s.camera.x+t.x)*.5,y:(self.s.camera.y+t.y)*.5,ratio:self.settings.zoomDef},{duration:animationOpts.duration,onComplete:function(){sigma.misc.animation.camera(self.s.camera,t,animationOpts)}})}else{sigma.misc.animation.camera(self.s.camera,t,animationOpts)}return self};this.center=function(ratio,options){var animationOpts=sigma.utils.extend(options,self.settings.animation.center);if(self.s.graph.nodes().length){self.nodes(self.s.graph.nodes().map(function(n){return n.id}),animationOpts)}else{sigma.misc.animation.camera(self.s.camera,{x:0,y:0,
ratio:ratio},animationOpts)}return self};this.setPadding=function(options){self.settings.padding=sigma.utils.extend(options,self.settings.padding);return self};this.kill=function(){self.settings=null;self.s=null}}sigma.plugins.locate=function(s,options){if(!_instance[s.id]){_instance[s.id]=new Locate(s,options)}return _instance[s.id]};sigma.plugins.killLocate=function(s){if(_instance[s.id]instanceof Locate){_instance[s.id].kill()}delete _instance[s.id]}}).call(window);(function(){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.classes.graph.addMethod("neighborhood",function(centerId){var k1,k2,k3,node,center,localNodesIndex={},localEdgesIndex={},graph={nodes:[],edges:[]};if(!this.nodes(centerId))return graph;node=this.nodes(centerId);center={};center.center=true;for(k1 in node)center[k1]=node[k1];localNodesIndex[centerId]=true;graph.nodes.push(center);for(k1 in this.allNeighborsIndex[centerId]){if(!localNodesIndex[k1]){localNodesIndex[k1]=true;graph.nodes.push(this.nodesIndex[k1])}for(k2 in this.allNeighborsIndex[centerId][k1])if(!localEdgesIndex[k2]){localEdgesIndex[k2]=true;graph.edges.push(this.edgesIndex[k2])}}for(k1 in localNodesIndex)if(k1!==centerId)for(k2 in localNodesIndex)if(k2!==centerId&&k1!==k2&&this.allNeighborsIndex[k1][k2])for(k3 in this.allNeighborsIndex[k1][k2])if(!localEdgesIndex[k3]){localEdgesIndex[k3]=true;graph.edges.push(this.edgesIndex[k3])}return graph});sigma.utils.pkg("sigma.plugins");sigma.plugins.neighborhoods=function(){var ready=false,readyCallbacks=[],graph=new sigma.classes.graph;this.neighborhood=function(centerNodeID){return graph.neighborhood(centerNodeID)};this.load=function(path,callback){var xhr=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;var names,i;if(window.ActiveXObject){names=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(i in names)try{return new ActiveXObject(names[i])}catch(e){}}return null}();if(!xhr)throw"XMLHttpRequest not supported, cannot load the data.";xhr.open("GET",path,true);xhr.onreadystatechange=function(){if(xhr.readyState===4){graph.clear().read(JSON.parse(xhr.responseText));if(callback)callback()}};xhr.send();return this};this.read=function(g){graph.clear().read(g)}}}).call(window);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma.plugins.poweredBy: sigma not in scope.";sigma.utils.pkg("sigma.settings");var settings={poweredByHTML:"Powered by Linkurious.js",poweredByURL:"https://github.com/Linkurious/linkurious.js",poweredByPingURL:""};sigma.settings=sigma.utils.extend(sigma.settings||{},settings)}).call(this);(function(undefined){function poweredBy(options){options=options||{};var content,html=options.html||this.settings("poweredByHTML"),url=options.url||this.settings("poweredByURL"),pingURL=options.pingURL||this.settings("poweredByPingURL");if(!this.domElements["poweredby"]){this.initDOM("div","poweredby");if(url){content=['<a href="'+url+'" target="_blank" style="font-family:Lato,sans-serif;font-size:11px;color:#333;text-decoration:none;">'+html+"</a>"]}else{content=[html]}if(pingURL){var img=new Image;img.src=pingURL}this.domElements["poweredby"].innerHTML=content.join("");this.domElements["poweredby"].style.bottom="2px";this.domElements["poweredby"].style.right="1px";this.domElements["poweredby"].style.background="rgba(255, 255, 255, 0.8)";this.container.appendChild(this.domElements["poweredby"])}}sigma.renderers.canvas.prototype.poweredBy=poweredBy;sigma.renderers.webgl.prototype.poweredBy=poweredBy}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var _instance={},_body=null,_nodeReference=null,_spacebar=false,_doubleClickingNodes=false;function difference(array,values){var length=array?array.length:0;if(!length){return[]}var index=-1,result=[],valuesLength=values.length;outer:while(++index<length){var value=array[index];if(value===value){var valuesIndex=valuesLength;while(valuesIndex--){if(values[valuesIndex]===value){continue outer}}result.push(value)}else if(values.indexOf(value)<0){result.push(value)}}return result}function keyDown(event){_spacebar=event.which===32;_body.removeEventListener("keydown",keyDown,false);_body.addEventListener("keyup",keyUp,false)}function keyUp(event){_spacebar=false;_body.addEventListener("keydown",keyDown,false);_body.removeEventListener("keyup",keyUp,false)}function Select(s,a,r){var self=this,renderer=r||s.renderers[0],mousemoveCount=0,kbd=null,lasso=null;_body=_body||document.getElementsByTagName("body")[0];renderer.container.lastChild.addEventListener("mousedown",nodeMouseDown);renderer.container.lastChild.addEventListener("mouseup",nodeMouseUp);this.init=function(){var nodes=a.nodes();if(nodes.length){_nodeReference=nodes[0].id}};this.clickNodesHandler=function(event){if(mousemoveCount>1)return;var targets=event.data.node.map(function(n){return n.id});var actives=a.nodes().map(function(n){return n.id});var newTargets=difference(targets,actives);a.dropEdges();if(_spacebar){var existingTargets=difference(targets,newTargets);a.dropNodes(existingTargets)}else{if(actives.length>1){a.addNodes(targets)}var activeNode=a.nodes()[0];if(activeNode!=null){if(_nodeReference===activeNode.id){if(newTargets.length){a.dropNodes();_nodeReference=null}else{setTimeout(function(){if(!_doubleClickingNodes){a.dropNodes();_nodeReference=null;s.refresh({skipIndexation:true})}},s.settings("doubleClickTimeout"))}}else{_nodeReference=activeNode.id}}}a.addNodes(newTargets);s.refresh({skipIndexation:true})};this.doubleClickNodesHandler=function(event){_doubleClickingNodes=true;setTimeout(function(){_doubleClickingNodes=false},100+s.settings("doubleClickTimeout"))};this.clickEdgesHandler=function(event){if(mousemoveCount>1)return;var targets=event.data.edge.map(function(e){return e.id});var actives=a.edges().map(function(e){return e.id});var newTargets=difference(targets,actives);a.dropNodes();if(_spacebar){var existingTargets=difference(targets,newTargets);a.dropEdges(existingTargets)}else{a.dropEdges();if(actives.length>1){a.addEdges(targets)}}a.addEdges(newTargets);s.refresh({skipIndexation:true})};function spaceA(){a.dropEdges();if(a.nodes().length===s.graph.nodes().length){a.dropNodes()}else{a.addNodes()}s.refresh({skipIndexation:true})}function nodeMouseMove(){mousemoveCount++}function nodeMouseDown(){mousemoveCount=0;renderer.container.lastChild.addEventListener("mousemove",nodeMouseMove)}function nodeMouseUp(){setTimeout(function(){mousemoveCount=0;var n=a.nodes()[0];if(n&&_nodeReference===null){_nodeReference=n.id}},1);renderer.container.lastChild.removeEventListener("mousemove",nodeMouseMove)}function spaceU(){a.dropEdges();a.dropNodes();s.refresh({skipIndexation:true})}function spaceDel(){var nodes=a.nodes().map(function(n){return n.id}),edges=a.edges().map(function(e){return e.id});a.dropEdges(edges);a.dropNodes(nodes);if(nodes.length==s.graph.nodes().length){s.graph.clear()}else{s.graph.dropEdges(edges);s.graph.dropNodes(nodes)}s.refresh()}function spaceE(){a.addNeighbors();s.refresh({skipIndexation:true})}function spaceI(){a.dropEdges();a.setNodesBy(function(n){return s.graph.degree(n.id)===0});s.refresh({skipIndexation:true})}function spaceL(){a.dropEdges();a.setNodesBy(function(n){return s.graph.adjacentNodes(n.id).length===1});s.refresh({skipIndexation:true})}s.bind("clickNodes",this.clickNodesHandler);s.bind("doubleClickNodes",this.doubleClickNodesHandler);s.bind("clickEdges",this.clickEdgesHandler);_body.addEventListener("keydown",keyDown,false);this.bindKeyboard=function(keyboard){if(!keyboard)throw new Error('Missing argument: "keyboard"');kbd=keyboard;kbd.bind("32+65 18+32+65",spaceA);kbd.bind("32+85 18+32+85",spaceU);kbd.bind("32+46 18+32+46",spaceDel);kbd.bind("32+69 18+32+69",spaceE);kbd.bind("32+73 18+32+73",spaceI);kbd.bind("32+76 18+32+76",spaceL);return this};this.unbindKeyboard=function(){if(kbd){kbd.unbind("32+65 18+32+65",spaceA);kbd.unbind("32+85 18+32+85",spaceU);kbd.unbind("32+46 18+32+46",spaceDel);kbd.unbind("32+69 18+32+69",spaceE);kbd.unbind("32+73 18+32+73",spaceI);kbd.unbind("32+76 18+32+76",spaceL);kbd=null}return this};function lassoHandler(event){var nodes=event.data;if(!nodes.length){a.dropNodes();_nodeReference=null}else{a.dropEdges();a.addNodes(nodes.map(function(n){return n.id}));_nodeReference=a.nodes()[0].id}}this.bindLasso=function(lassoInstance){if(!lassoInstance)throw new Error('Missing argument: "lassoInstance"');lasso=lassoInstance;lasso.bind("selectedNodes",lassoHandler)};this.unbindLasso=function(){if(lasso){lasso.unbind("selectedNodes",lassoHandler)}};this.clear=function(){s.unbind("clickNodes",self.clickNodesHandler);s.unbind("doubleClickNodes",self.doubleClickNodesHandler);s.unbind("clickEdges",self.clickEdgesHandler);self.unbindKeyboard();self.unbindLasso();renderer.container.lastChild.removeEventListener("mousedown",nodeMouseDown);renderer.container.lastChild.removeEventListener("mouseup",nodeMouseUp);renderer.container.lastChild.removeEventListener("mousemove",nodeMouseMove);renderer=null;kbd=null}}sigma.plugins.select=function(s,a,renderer){if(!_instance[s.id]){_instance[s.id]=new Select(s,a);s.bind("kill",function(){sigma.plugins.killSelect(s)})}return _instance[s.id]};sigma.plugins.killSelect=function(s){if(_instance[s.id]instanceof Select){_instance[s.id].clear();delete _instance[s.id]}if(!_instance.length&&_body){_body.removeEventListener("keydown",keyDown,false);_body.removeEventListener("keyup",keyUp,false);_body=null}}}).call(this);(function(){"use strict";if(typeof sigma==="undefined")throw new Error("sigma is not declared");sigma.utils.pkg("sigma.plugins");var settings={stage:{show:"rightClickStage",hide:"clickStage",cssClass:"sigma-tooltip",position:"",autoadjust:false,delay:0,hideDelay:0,template:"",renderer:null},node:{show:"clickNode",hide:"clickStage",cssClass:"sigma-tooltip",position:"",autoadjust:false,delay:0,hideDelay:0,template:"",renderer:null},edge:{show:"clickEdge",hide:"clickStage",cssClass:"sigma-tooltip",position:"",autoadjust:false,delay:0,hideDelay:0,template:"",renderer:null},doubleClickDelay:800};function Tooltips(s,renderer,options){var self=this,so=sigma.utils.extend(options.stage,settings.stage),no=sigma.utils.extend(options.node,settings.node),eo=sigma.utils.extend(options.edge,settings.edge),_tooltip,_timeoutHandle,_timeoutHideHandle,_mouseOverTooltip=false,_doubleClick=false;sigma.classes.dispatcher.extend(this);s.bind("kill",function(){sigma.plugins.killTooltips(s)});function contextmenuListener(event){event.preventDefault()}this.open=function(o,options,x,y,onComplete){remove();_tooltip=document.createElement("div");if(options.renderer){var clone=Object.create(null),tooltipRenderer,type,k;for(k in o)clone[k]=o[k];tooltipRenderer=options.renderer.call(s.graph,clone,options.template);type=typeof tooltipRenderer;if(type==="undefined")return;if(type==="string"){_tooltip.innerHTML=tooltipRenderer}else{_tooltip.appendChild(tooltipRenderer)}}else{_tooltip.innerHTML=options.template}var containerPosition=window.getComputedStyle(renderer.container).position;if(containerPosition!=="static"){_tooltip.style.position="absolute";var containerRect=renderer.container.getBoundingClientRect();x=~~(x-containerRect.left);y=~~(y-containerRect.top)}_tooltip.className=options.cssClass;if(options.position!=="css"){if(containerPosition==="static"){_tooltip.style.position="absolute"}_tooltip.style.left=x+"px";_tooltip.style.top=y+"px"}_tooltip.addEventListener("mouseenter",function(){_mouseOverTooltip=true},false);_tooltip.addEventListener("mouseleave",function(){_mouseOverTooltip=false},false);setTimeout(function(){if(!_tooltip)return;renderer.container.appendChild(_tooltip);var bodyRect=document.body.getBoundingClientRect(),tooltipRect=_tooltip.getBoundingClientRect(),offsetTop=tooltipRect.top-bodyRect.top,offsetBottom=bodyRect.bottom-tooltipRect.bottom,offsetLeft=tooltipRect.left-bodyRect.left,offsetRight=bodyRect.right-tooltipRect.right;if(options.position==="top"){_tooltip.className=options.cssClass+" top";_tooltip.style.left=x-tooltipRect.width/2+"px";_tooltip.style.top=y-tooltipRect.height+"px"}else if(options.position==="bottom"){_tooltip.className=options.cssClass+" bottom";_tooltip.style.left=x-tooltipRect.width/2+"px";_tooltip.style.top=y+"px"}else if(options.position==="left"){_tooltip.className=options.cssClass+" left";_tooltip.style.left=x-tooltipRect.width+"px";_tooltip.style.top=y-tooltipRect.height/2+"px"}else if(options.position==="right"){_tooltip.className=options.cssClass+" right";_tooltip.style.left=x+"px";_tooltip.style.top=y-tooltipRect.height/2+"px"}if(options.autoadjust){tooltipRect=_tooltip.getBoundingClientRect();offsetTop=tooltipRect.top-bodyRect.top;offsetBottom=bodyRect.bottom-tooltipRect.bottom;offsetLeft=tooltipRect.left-bodyRect.left;offsetRight=bodyRect.right-tooltipRect.right;if(offsetBottom<0){_tooltip.className=options.cssClass;if(options.position==="top"||options.position==="bottom"){_tooltip.className=options.cssClass+" top"}_tooltip.style.top=y-tooltipRect.height+"px"}else if(offsetTop<0){_tooltip.className=options.cssClass;if(options.position==="top"||options.position==="bottom"){_tooltip.className=options.cssClass+" bottom"}_tooltip.style.top=y+"px"}if(offsetRight<0){_tooltip.className=options.cssClass;if(options.position==="left"||options.position==="right"){_tooltip.className=options.cssClass+" left"}_tooltip.style.left=x-tooltipRect.width+"px"}else if(offsetLeft<0){_tooltip.className=options.cssClass;if(options.position==="left"||options.position==="right"){_tooltip.className=options.cssClass+" right"}_tooltip.style.left=x+"px"}}if(onComplete)onComplete()},0)};function remove(){if(_tooltip&&_tooltip.parentNode){_tooltip.parentNode.removeChild(_tooltip);_tooltip=null}}function cancel(){clearTimeout(_timeoutHandle);clearTimeout(_timeoutHideHandle);_timeoutHandle=false;_timeoutHideHandle=false;remove()}function delayedCancel(delay){clearTimeout(_timeoutHandle);clearTimeout(_timeoutHideHandle);_timeoutHandle=false;_timeoutHideHandle=setTimeout(function(){if(!_mouseOverTooltip)remove()},delay)}this.close=function(){cancel();this.dispatchEvent("hidden");return this};this.kill=function(){this.unbindEvents();clearTimeout(_timeoutHandle);clearTimeout(_timeoutHideHandle);_tooltip=null;_timeoutHandle=null;_timeoutHideHandle=null;_doubleClick=false};this.unbindEvents=function(){if(options.stage){s.unbind(so.show);s.unbind(so.hide);if(so.show!=="doubleClickStage"){s.unbind("doubleClickStage")}}if(options.node){s.unbind(no.show);s.unbind(no.hide);if(no.show!=="doubleClickNode"){s.unbind("doubleClickNode")}}if(options.edge){s.unbind(eo.show);s.unbind(eo.hide);if(eo.show!=="doubleClickEdge"){s.unbind("doubleClickEdge")}}if(no.show==="rightClickNode"||eo.show==="rightClickEdge"){renderer.container.removeEventListener("contextmenu",contextmenuListener)}};if(options.stage){if(options.stage.renderer!==undefined&&typeof options.stage.renderer!=="function")throw new TypeError('"options.stage.renderer" is not a function, was '+options.stage.renderer);if(options.stage.position!==undefined){if(options.stage.position!=="top"&&options.stage.position!=="bottom"&&options.stage.position!=="left"&&options.stage.position!=="right"&&options.stage.position!=="css"){throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+options.position)}}s.bind(so.show,function(event){if(so.show!=="doubleClickStage"&&_doubleClick){return}var clientX=event.data.captor.clientX,clientY=event.data.captor.clientY;clearTimeout(_timeoutHandle);_timeoutHandle=setTimeout(function(){self.open(null,so,clientX,clientY,self.dispatchEvent.bind(self,"shown",event.data))},so.delay)});s.bind(so.hide,function(event){var p=_tooltip;delayedCancel(settings.stage.hideDelay);if(p)self.dispatchEvent("hidden",event.data)});if(so.show!=="doubleClickStage"){s.bind("doubleClickStage",function(event){cancel();_doubleClick=true;self.dispatchEvent("hidden",event.data);setTimeout(function(){_doubleClick=false},settings.doubleClickDelay)})}}if(options.node){if(options.node.renderer!==undefined&&typeof options.node.renderer!=="function")throw new TypeError('"options.node.renderer" is not a function, was '+options.node.renderer);if(options.node.position!==undefined){if(options.node.position!=="top"&&options.node.position!=="bottom"&&options.node.position!=="left"&&options.node.position!=="right"&&options.node.position!=="css"){throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+options.position)}}s.bind(no.show,function(event){if(no.show!=="doubleClickNode"&&_doubleClick){return}var n=event.data.node;if(!n&&event.data.enter){n=event.data.enter.nodes[0]}if(n==undefined)return;var clientX=event.data.captor.clientX,clientY=event.data.captor.clientY;clearTimeout(_timeoutHandle);_timeoutHandle=setTimeout(function(){self.open(n,no,clientX,clientY,self.dispatchEvent.bind(self,"shown",event.data))},no.delay)});s.bind(no.hide,function(event){if(event.data.leave&&event.data.leave.nodes.length==0)return;var p=_tooltip;delayedCancel(settings.node.hideDelay);if(p)self.dispatchEvent("hidden",event.data)});if(no.show!=="doubleClickNode"){s.bind("doubleClickNode",function(event){cancel();_doubleClick=true;self.dispatchEvent("hidden",event.data);setTimeout(function(){_doubleClick=false},settings.doubleClickDelay)})}}if(options.edge){if(options.edge.renderer!==undefined&&typeof options.edge.renderer!=="function")throw new TypeError('"options.edge.renderer" is not a function, was '+options.edge.renderer);if(options.edge.position!==undefined){if(options.edge.position!=="top"&&options.edge.position!=="bottom"&&options.edge.position!=="left"&&options.edge.position!=="right"&&options.edge.position!=="css"){throw new Error('"options.position" is not "top", "bottom", "left", "right", or "css", was '+options.position)}}s.bind(eo.show,function(event){if(eo.show!=="doubleClickEdge"&&_doubleClick){return}var e=event.data.edge;if(!e&&event.data.enter){e=event.data.enter.edges[0]}if(e==undefined)return;var clientX=event.data.captor.clientX,clientY=event.data.captor.clientY;clearTimeout(_timeoutHandle);_timeoutHandle=setTimeout(function(){self.open(e,eo,clientX,clientY,self.dispatchEvent.bind(self,"shown",event.data))},eo.delay)});s.bind(eo.hide,function(event){if(event.data.leave&&event.data.leave.edges.length==0)return;var p=_tooltip;delayedCancel(settings.edge.hideDelay);if(p)self.dispatchEvent("hidden",event.data)});if(eo.show!=="doubleClickEdge"){s.bind("doubleClickEdge",function(event){cancel();_doubleClick=true;self.dispatchEvent("hidden",event.data);setTimeout(function(){_doubleClick=false},settings.doubleClickDelay)})}}if(no.show==="rightClickNode"||eo.show==="rightClickEdge"){renderer.container.addEventListener("contextmenu",contextmenuListener)}}var _instance={};sigma.plugins.tooltips=function(s,renderer,options){if(!_instance[s.id]){_instance[s.id]=new Tooltips(s,renderer,options)}return _instance[s.id]};sigma.plugins.killTooltips=function(s){if(_instance[s.id]instanceof Tooltips){_instance[s.id].kill()}delete _instance[s.id]}}).call(window);(function(){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var _id=0,_cache={};sigma.plugins.relativeSize=function(s,initialSize){var nodes=s.graph.nodes();for(var i=0;i<nodes.length;i++){var degree=s.graph.degree(nodes[i].id);nodes[i].size=initialSize*Math.sqrt(degree)}s.refresh()}}).call(window);(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.dashed=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel");if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.setLineDash([8,3]);context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.dotted=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel");if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.setLineDash([2]);context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.parallel=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],c,d,dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);d=sigma.utils.getCircleIntersection(tX,tY,size,sX,sY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(c.xi,c.yi);context.lineTo(d.xi_prime,d.yi_prime);context.closePath();context.stroke();context.beginPath();context.moveTo(c.xi_prime,c.yi_prime);context.lineTo(d.xi,d.yi);context.closePath();context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.tapered=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),prefix=settings("prefix")||"",defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");var c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.globalAlpha=.65;context.fillStyle=color;context.beginPath();context.moveTo(tX,tY);context.lineTo(c.xi,c.yi);context.lineTo(c.xi_prime,c.yi_prime);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.dashed=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level;if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.setLineDash([8,3]);context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.dotted=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level;if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.setLineDash([2]);context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.parallel=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],c,d,dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);d=sigma.utils.getCircleIntersection(tX,tY,size,sX,sY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;
context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(c.xi,c.yi);context.lineTo(d.xi_prime,d.yi_prime);context.closePath();context.stroke();context.beginPath();context.moveTo(c.xi_prime,c.yi_prime);context.lineTo(d.xi,d.yi);context.closePath();context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.tapered=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),prefix=settings("prefix")||"",defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}var c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.fillStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.fillStyle=color}context.globalAlpha=.65;context.beginPath();context.moveTo(tX,tY);context.lineTo(c.xi,c.yi);context.lineTo(c.xi_prime,c.yi_prime);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.settings");var settings={defaultEdgeLabelColor:"#000",defaultEdgeLabelActiveColor:"#000",defaultEdgeLabelSize:10,edgeLabelSize:"fixed",edgeLabelAlignment:"auto",edgeLabelSizePowRatio:1,edgeLabelThreshold:1,defaultEdgeHoverLabelBGColor:"#fff",edgeLabelHoverBGColor:"default",edgeLabelHoverShadow:"default",edgeLabelHoverShadowColor:"#000"};sigma.settings=sigma.utils.extend(sigma.settings||{},settings);sigma.settings.drawEdgeLabels=true}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels");sigma.canvas.edges.labels.curve=function(edge,source,target,context,settings){if(typeof edge.label!=="string")return;var prefix=settings("prefix")||"",size=edge[prefix+"size"]||1;if(size<settings("edgeLabelThreshold")&&!edge.hover)return;if(0===settings("edgeLabelSizePowRatio"))throw new Error('Invalid setting: "edgeLabelSizePowRatio" is equal to 0.');var fontSize,sSize=source[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dX=tX-sX,dY=tY-sY,sign=sX<tX?1:-1,cp={},c,angle=0,t=.5,fontStyle=edge.hover?settings("hoverFontStyle")||settings("fontStyle"):settings("fontStyle");if(source.id===target.id){cp=sigma.utils.getSelfLoopControlPoints(sX,sY,sSize);c=sigma.utils.getPointOnBezierCurve(t,sX,sY,tX,tY,cp.x1,cp.y1,cp.x2,cp.y2)}else{cp=sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);c=sigma.utils.getPointOnQuadraticCurve(t,sX,sY,tX,tY,cp.x,cp.y)}fontSize=settings("edgeLabelSize")==="fixed"?settings("defaultEdgeLabelSize"):settings("defaultEdgeLabelSize")*size*Math.pow(size,-1/settings("edgeLabelSizePowRatio"));context.save();if(edge.active){context.font=[settings("activeFontStyle")||settings("fontStyle"),fontSize+"px",settings("activeFont")||settings("font")].join(" ")}else{context.font=[fontStyle,fontSize+"px",settings("font")].join(" ")}context.textAlign="center";context.textBaseline="alphabetic";if("auto"===settings("edgeLabelAlignment")){if(source.id===target.id){angle=Math.atan2(1,1)}else{var labelWidth=sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,edge.label),edgeLength=sigma.utils.getDistance(source[prefix+"x"],source[prefix+"y"],target[prefix+"x"],target[prefix+"y"]);edgeLength=edgeLength-source[prefix+"size"]-target[prefix+"size"]-10;if(labelWidth<edgeLength){angle=Math.atan2(dY*sign,dX*sign)}}}if(edge.hover){context.fillStyle=settings("edgeLabelHoverBGColor")==="edge"?edge.color||settings("defaultEdgeColor"):settings("defaultEdgeHoverLabelBGColor");if(settings("edgeLabelHoverShadow")){context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowBlur=8;context.shadowColor=settings("edgeLabelHoverShadowColor")}drawBackground(angle,context,fontSize,size,edge.label,c.x,c.y);if(settings("edgeLabelHoverShadow")){context.shadowBlur=0;context.shadowColor="#000"}}if(edge.active){context.fillStyle=settings("edgeActiveColor")==="edge"?edge.active_color||settings("defaultEdgeActiveColor"):settings("defaultEdgeLabelActiveColor")}else{context.fillStyle=settings("edgeLabelColor")==="edge"?edge.color||settings("defaultEdgeColor"):settings("defaultEdgeLabelColor")}context.translate(c.x,c.y);context.rotate(angle);context.fillText(edge.label,0,-size/2-3);context.restore();function drawBackground(angle,context,fontSize,size,label,x,y){var w=Math.round(sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,label)+size+1.5+fontSize/3),h=fontSize+4;context.save();context.beginPath();context.translate(x,y);context.rotate(angle);context.rect(-w/2,-h-size/2,w,h);context.closePath();context.fill();context.restore()}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels");sigma.canvas.edges.labels.curvedArrow=function(edge,source,target,context,settings){sigma.canvas.edges.labels.curve(edge,source,target,context,settings)}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels");sigma.canvas.edges.labels.def=function(edge,source,target,context,settings,infos){if(typeof edge.label!=="string"||source==target)return;var prefix=settings("prefix")||"",size=edge[prefix+"size"]||1;if(size<settings("edgeLabelThreshold")&&!edge.hover)return;if(0===settings("edgeLabelSizePowRatio"))throw new Error('Invalid setting: "edgeLabelSizePowRatio" is equal to 0.');var fontSize,angle=0,fontStyle=edge.hover?settings("hoverFontStyle")||settings("fontStyle"):settings("fontStyle"),x=(source[prefix+"x"]+target[prefix+"x"])/2,y=(source[prefix+"y"]+target[prefix+"y"])/2,dX,dY,sign;fontSize=settings("edgeLabelSize")==="fixed"?settings("defaultEdgeLabelSize"):settings("defaultEdgeLabelSize")*size*Math.pow(size,-1/settings("edgeLabelSizePowRatio"));var new_font=[fontStyle,fontSize+"px",settings("font")].join(" ");if(edge.active){new_font=[settings("activeFontStyle")||settings("fontStyle"),fontSize+"px",settings("activeFont")||settings("font")].join(" ")}if(infos&&infos.ctx.font!=new_font){context.font=new_font;infos.ctx.font=new_font}else{context.font=new_font}context.textAlign="center";context.textBaseline="alphabetic";if("auto"===settings("edgeLabelAlignment")){var labelWidth=sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,edge.label);var edgeLength=sigma.utils.getDistance(source[prefix+"x"],source[prefix+"y"],target[prefix+"x"],target[prefix+"y"]);edgeLength=edgeLength-source[prefix+"size"]-target[prefix+"size"]-10;if(labelWidth<edgeLength){dX=target[prefix+"x"]-source[prefix+"x"];dY=target[prefix+"y"]-source[prefix+"y"];sign=source[prefix+"x"]<target[prefix+"x"]?1:-1;angle=Math.atan2(dY*sign,dX*sign)}}if(edge.hover){context.fillStyle=settings("edgeLabelHoverBGColor")==="edge"?edge.color||settings("defaultEdgeColor"):settings("defaultEdgeHoverLabelBGColor");if(settings("edgeLabelHoverShadow")){context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowBlur=8;context.shadowColor=settings("edgeLabelHoverShadowColor")}drawBackground(angle,context,fontSize,size,edge.label,x,y);if(settings("edgeLabelHoverShadow")){context.shadowBlur=0;context.shadowColor="#000"}}if(edge.active){context.fillStyle=settings("edgeActiveColor")==="edge"?edge.active_color||settings("defaultEdgeActiveColor"):settings("defaultEdgeLabelActiveColor")}else{context.fillStyle=settings("edgeLabelColor")==="edge"?edge.color||settings("defaultEdgeColor"):settings("defaultEdgeLabelColor")}context.translate(x,y);context.rotate(angle);context.fillText(edge.label,0,-size/2-3);context.rotate(-angle);context.translate(-x,-y);function drawBackground(angle,context,fontSize,size,label,x,y){var w=Math.round(sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,label)+size+1.5+fontSize/3),h=fontSize+4;context.save();context.beginPath();context.translate(x,y);context.rotate(angle);context.rect(-w/2,-h-size/2,w,h);context.closePath();context.fill();context.restore()}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma.renderers.glyphs: sigma not in scope.";sigma.utils.pkg("sigma.settings");var settings={glyphScale:.5,glyphFillColor:"white",glyphTextColor:"black",glyphStrokeColor:"black",glyphLineWidth:2,glyphFont:"Arial",glyphFontStyle:"normal",glyphFontScale:1,glyphTextThreshold:7,glyphStrokeIfText:false,glyphThreshold:1,drawGlyphs:true};sigma.settings=sigma.utils.extend(sigma.settings||{},settings)}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined"){throw"sigma is not declared"}function degreesToRadians(degrees){return degrees*Math.PI/180}function resolve(param,thisArg){if(typeof param==="function"){return param.call(thisArg)}return param}function glyphs(params){params=params||{};var defFont=params.font||this.settings("glyphFont"),defFontStyle=params.fontStyle||this.settings("glyphFontStyle"),defFontScale=params.fontScale||this.settings("glyphFontScale"),defStrokeColor=params.strokeColor||this.settings("glyphStrokeColor"),defLineWidth=params.lineWidth||this.settings("glyphLineWidth"),defFillColor=params.fillColor||this.settings("glyphFillColor"),defScale=params.scale||this.settings("glyphScale"),defTextColor=params.textColor||this.settings("glyphTextColor"),defTextThreshold=params.textThreshold||this.settings("glyphTextThreshold"),defStrokeIfText="strokeIfText"in params?params.strokeIfText:this.settings("glyphStrokeIfText"),defThreshold=params.threshold||this.settings("glyphThreshold"),defDraw="draw"in params?params.draw:this.settings("drawGlyphs");if(!defDraw){return}if(!this.domElements["glyphs"]){this.initDOM("canvas","glyphs");this.domElements["glyphs"].width=this.container.offsetWidth;this.domElements["glyphs"].height=this.container.offsetHeight;this.container.insertBefore(this.domElements["glyphs"],this.domElements["glyphs"].previousSibling)}this.drawingContext=this.domElements["glyphs"].getContext("2d");this.drawingContext.textAlign="center";this.drawingContext.textBaseline="middle";this.drawingContext.lineWidth=defLineWidth;this.drawingContext.strokeStyle=defStrokeColor;var self=this,nodes=this.nodesOnScreen||[],prefix=this.options.prefix||"",cos45=Math.cos(degreesToRadians(45)),sin45=Math.sin(degreesToRadians(45)),cos135=Math.cos(degreesToRadians(135)),sin135=Math.sin(degreesToRadians(135)),cos225=Math.cos(degreesToRadians(225)),sin225=Math.sin(degreesToRadians(225)),cos315=Math.cos(degreesToRadians(315)),sin315=Math.sin(degreesToRadians(315));function draw(o,context){if(o.draw&&o.x&&o.y&&o.radius>o.threshold){var x=o.x,y=o.y;switch(o.position){case"top-right":x+=o.nodeSize*cos315;y+=o.nodeSize*sin315;break;case"top-left":x+=o.nodeSize*cos225;y+=o.nodeSize*sin225;break;case"bottom-left":x+=o.nodeSize*cos135;y+=o.nodeSize*sin135;break;case"bottom-right":x+=o.nodeSize*cos45;y+=o.nodeSize*sin45;break}context.fillStyle=o.fillColor;if(o.strokeColor!==context.strokeStyle){context.strokeStyle=o.strokeColor}context.beginPath();context.arc(x,y,o.radius,2*Math.PI,false);context.closePath();if(!o.strokeIfText||o.radius>o.textThreshold){context.stroke()}context.fill();if(o.radius>o.textThreshold){var fontSize=Math.round(o.fontScale*o.radius);var font=o.fontStyle+" "+fontSize+"px "+o.font;if(font!==context.font){context.font=font}context.fillStyle=o.textColor;context.fillText(o.content,x,y)}}}var display;nodes.forEach(function(node){if(node.glyphs){node.glyphs.forEach(function(glyph){display=!node.hidden;if(display&&"draw"in glyph){display=glyph.draw}draw({x:node[prefix+"x"],y:node[prefix+"y"],nodeSize:node[prefix+"size"]||0,position:glyph.position,radius:glyph.size||node[prefix+"size"]*defScale,content:(glyph.content||"").toString()||"",lineWidth:glyph.lineWidth||defLineWidth,fillColor:resolve(glyph.fillColor,node)||defFillColor,textColor:resolve(glyph.textColor,node)||defTextColor,strokeColor:resolve(glyph.strokeColor,node)||defStrokeColor,strokeIfText:"strokeIfText"in glyph?glyph.strokeIfText:defStrokeIfText,fontStyle:glyph.fontStyle||defFontStyle,font:glyph.font||defFont,fontScale:glyph.fontScale||defFontScale,threshold:glyph.threshold||defThreshold,textThreshold:glyph.textThreshold||defTextThreshold,draw:display},self.drawingContext)})}})}sigma.renderers.canvas.prototype.glyphs=glyphs}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.settings");var settings={nodeHaloColor:"#fff",nodeHaloStroke:false,nodeHaloStrokeColor:"#000",nodeHaloStrokeWidth:.5,nodeHaloSize:50,nodeHaloClustering:false,nodeHaloClusteringMaxRadius:1e3,edgeHaloColor:"#fff",edgeHaloSize:10,drawHalo:true};sigma.settings=sigma.utils.extend(sigma.settings||{},settings)}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma not in scope.");function intersection(){var args=[],argsIndex=-1,argsLength=arguments.length;while(++argsIndex<argsLength){var value=arguments[argsIndex];args.push(value)}var array=args[0],index=-1,length=array?array.length:0,result=[];outer:while(++index<length){value=array[index];if(result.indexOf(value)<0){var argsIndex=argsLength;while(--argsIndex){if(args[argsIndex].indexOf(value)<0){continue outer}}result.push(value)}}return result}function drawCircles(circles,context,onlyStroke){for(var i=0;i<circles.length;i++){if(circles[i]==null)continue;context.beginPath();context.arc(circles[i].x,circles[i].y,circles[i].radius,0,Math.PI*2,true);context.closePath();if(onlyStroke){context.stroke()}else{context.fill()}}}function clusterCircles(circles,margin,maxRadius){maxRadius=maxRadius||Number.POSITIVE_INFINITY;if(circles.length>1){var intersecting=true,centroid,d,points;while(intersecting){intersecting=false;for(var i=0;i<circles.length;i++){if(circles[i]===null)continue;for(var j=i+1;j<circles.length;j++){if(circles[j]===null)continue;d=sigma.utils.getDistance(circles[i].x,circles[i].y,circles[j].x,circles[j].y);if(d<maxRadius&&d<circles[i].radius+circles[j].radius){intersecting=true;points=[{x:circles[i].x,y:circles[i].y,radius:circles[i].radius},{x:circles[j].x,y:circles[j].y,radius:circles[j].radius}];if(circles[i].points){points=points.concat(circles[i].points)}if(circles[j].points){points=points.concat(circles[j].points)}centroid={x:0,y:0};for(var p=0;p<points.length;p++){centroid.x+=points[p].x;centroid.y+=points[p].y}centroid.x/=points.length;centroid.y/=points.length;centroid.radius=Math.max.apply(null,points.map(function(point){return margin+sigma.utils.getDistance(centroid.x,centroid.y,point.x,point.y)}));circles.push({x:centroid.x,y:centroid.y,radius:centroid.radius,points:points});circles[i]=circles[j]=null;break}}}}}return circles}function halo(params){params=params||{};var pixelRatio=sigma.utils.getPixelRatio();if(!this.domElements["background"]){this.initDOM("canvas","background");this.domElements["background"].width=this.container.offsetWidth*pixelRatio;this.domElements["background"].height=this.container.offsetHeight*pixelRatio;this.container.insertBefore(this.domElements["background"],this.container.firstChild)}var self=this,context=self.contexts.background,webgl=this instanceof sigma.renderers.webgl,ePrefix=self.options.prefix,nPrefix=webgl?ePrefix.substr(5):ePrefix,nHaloClustering=params.nodeHaloClustering||self.settings("nodeHaloClustering"),nHaloClusteringMaxRadius=params.nodeHaloClusteringMaxRadius||self.settings("nodeHaloClusteringMaxRadius"),nHaloColor=params.nodeHaloColor||self.settings("nodeHaloColor"),nHaloSize=params.nodeHaloSize||self.settings("nodeHaloSize"),nHaloStroke=params.nodeHaloStroke||self.settings("nodeHaloStroke"),nHaloStrokeColor=params.nodeHaloStrokeColor||self.settings("nodeHaloStrokeColor"),nHaloStrokeWidth=params.nodeHaloStrokeWidth||self.settings("nodeHaloStrokeWidth"),borderSize=self.settings("borderSize")||0,outerBorderSize=self.settings("outerBorderSize")||0,eHaloColor=params.edgeHaloColor||self.settings("edgeHaloColor"),eHaloSize=params.edgeHaloSize||self.settings("edgeHaloSize"),drawHalo=params.drawHalo||self.settings("drawHalo"),nodes=params.nodes||[],edges=params.edges||[],source,target,cp,sSize,sX,sY,tX,tY,margin,circles;if(!drawHalo){return}nodes=webgl?nodes:intersection(params.nodes,self.nodesOnScreen);edges=webgl?edges:intersection(params.edges,self.edgesOnScreen);context.clearRect(0,0,context.canvas.width,context.canvas.height);context.save();context.strokeStyle=eHaloColor;edges.forEach(function(edge){source=self.graph.nodes(edge.source);target=self.graph.nodes(edge.target);context.lineWidth=(edge[ePrefix+"size"]||1)+eHaloSize;context.beginPath();cp={};sSize=source[nPrefix+"size"];sX=source[nPrefix+"x"];sY=source[nPrefix+"y"];tX=target[nPrefix+"x"];tY=target[nPrefix+"y"];context.moveTo(sX,sY);if(edge.type==="curve"||edge.type==="curvedArrow"){if(edge.source===edge.target){cp=sigma.utils.getSelfLoopControlPoints(sX,sY,sSize);context.bezierCurveTo(cp.x1,cp.y1,cp.x2,cp.y2,tX,tY)}else{cp=sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);context.quadraticCurveTo(cp.x,cp.y,tX,tY)}}else{context.moveTo(sX,sY);context.lineTo(tX,tY)}context.stroke();context.closePath()});context.fillStyle=nHaloColor;if(nHaloStroke){context.lineWidth=nHaloStrokeWidth;context.strokeStyle=nHaloStrokeColor}margin=borderSize+outerBorderSize+nHaloSize;circles=nodes.filter(function(node){return!node.hidden}).map(function(node){return{x:node[nPrefix+"x"],y:node[nPrefix+"y"],radius:node[nPrefix+"size"]+margin}});if(nHaloClustering){circles=clusterCircles(circles,margin,nHaloClusteringMaxRadius)}if(nHaloStroke){drawCircles(circles,context,true)}drawCircles(circles,context);context.restore()}sigma.renderers.canvas.prototype.halo=halo;sigma.renderers.webgl.prototype.halo=halo}).call(this);(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.arrow=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),size=edge[prefix+"size"]||1,tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];size=edge.hover?settings("edgeHoverSizeRatio")*size:size;var aSize=size*2.5,d=Math.sqrt(Math.pow(tX-sX,2)+Math.pow(tY-sY,2)),aX=sX+(tX-sX)*(d-aSize-tSize)/d,aY=sY+(tY-sY)*(d-aSize-tSize)/d,vX=(tX-sX)*aSize/d,vY=(tY-sY)*aSize/d;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);context.lineTo(aX,aY);context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(sigma.canvas.edges.labels.arrow){edge.hover=true;sigma.canvas.edges.labels.arrow(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.curve=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=settings("edgeHoverSizeRatio")*(edge[prefix+"size"]||1),edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),cp={},sSize=source[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,sSize):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x1,cp.y1,cp.x2,cp.y2,tX,tY)}else{context.quadraticCurveTo(cp.x,cp.y,tX,tY)}context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(sigma.canvas.edges.labels.curve){edge.hover=true;sigma.canvas.edges.labels.curve(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.curvedArrow=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),cp={},size=settings("edgeHoverSizeRatio")*(edge[prefix+"size"]||1),tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],d,aSize,aX,aY,vX,vY;cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,tSize):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);if(source.id===target.id){d=Math.sqrt(Math.pow(tX-cp.x1,2)+Math.pow(tY-cp.y1,2));aSize=size*2.5;aX=cp.x1+(tX-cp.x1)*(d-aSize-tSize)/d;aY=cp.y1+(tY-cp.y1)*(d-aSize-tSize)/d;vX=(tX-cp.x1)*aSize/d;vY=(tY-cp.y1)*aSize/d}else{d=Math.sqrt(Math.pow(tX-cp.x,2)+Math.pow(tY-cp.y,2));aSize=size*2.5;aX=cp.x+(tX-cp.x)*(d-aSize-tSize)/d;aY=cp.y+(tY-cp.y)*(d-aSize-tSize)/d;vX=(tX-cp.x)*aSize/d;vY=(tY-cp.y)*aSize/d}if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x2,cp.y2,cp.x1,cp.y1,aX,aY)}else{context.quadraticCurveTo(cp.x,cp.y,aX,aY)}context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(sigma.canvas.edges.labels.curvedArrow){edge.hover=true;var def=sigma.canvas.edges.labels.curvedArrow;(def.render||def)(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.dashed=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel");if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.setLineDash([8,3]);context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.def=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel");if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(sigma.canvas.edges.labels.def){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.dotted=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel");if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.setLineDash([2]);context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;var def=sigma.canvas.edges.labels.def;(def.render||def)(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.parallel=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],c,d,dist=sigma.utils.getDistance(sX,sY,tX,tY);
if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);d=sigma.utils.getCircleIntersection(tX,tY,size,sX,sY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(c.xi,c.yi);context.lineTo(d.xi_prime,d.yi_prime);context.closePath();context.stroke();context.beginPath();context.moveTo(c.xi_prime,c.yi_prime);context.lineTo(d.xi,d.yi);context.closePath();context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.tapered=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),prefix=settings("prefix")||"",defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=settings("edgeHoverLevel"),sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}size*=settings("edgeHoverSizeRatio");var c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}context.globalAlpha=.65;context.fillStyle=color;context.beginPath();context.moveTo(tX,tY);context.lineTo(c.xi,c.yi);context.lineTo(c.xi_prime,c.yi_prime);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore();if(sigma.canvas.edges.labels){edge.hover=true;sigma.canvas.edges.labels.def(edge,source,target,context,settings);edge.hover=false}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.arrow=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,size=edge[prefix+"size"]||1,tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];var aSize=size*2.5,d=Math.sqrt(Math.pow(tX-sX,2)+Math.pow(tY-sY,2)),aX=sX+(tX-sX)*(d-aSize-tSize)/d,aY=sY+(tY-sY)*(d-aSize-tSize)/d,vX=(tX-sX)*aSize/d,vY=(tY-sY)*aSize/d;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);context.lineTo(aX,aY);context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.curve=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,cp={},sSize=source[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,sSize):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x1,cp.y1,cp.x2,cp.y2,tX,tY)}else{context.quadraticCurveTo(cp.x,cp.y,tX,tY)}context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.curvedArrow=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,cp={},size=edge[prefix+"size"]||1,tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],d,aSize,aX,aY,vX,vY;cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,tSize):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY);if(source.id===target.id){d=Math.sqrt(Math.pow(tX-cp.x1,2)+Math.pow(tY-cp.y1,2));aSize=size*2.5;aX=cp.x1+(tX-cp.x1)*(d-aSize-tSize)/d;aY=cp.y1+(tY-cp.y1)*(d-aSize-tSize)/d;vX=(tX-cp.x1)*aSize/d;vY=(tY-cp.y1)*aSize/d}else{d=Math.sqrt(Math.pow(tX-cp.x,2)+Math.pow(tY-cp.y,2));aSize=size*2.5;aX=cp.x+(tX-cp.x)*(d-aSize-tSize)/d;aY=cp.y+(tY-cp.y)*(d-aSize-tSize)/d;vX=(tX-cp.x)*aSize/d;vY=(tY-cp.y)*aSize/d}if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x2,cp.y2,cp.x1,cp.y1,aX,aY)}else{context.quadraticCurveTo(cp.x,cp.y,aX,aY)}context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.dashed=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level;if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.setLineDash([8,3]);context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.def=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.dotted=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level;if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.setLineDash([2]);context.lineWidth=size;context.beginPath();context.moveTo(source[prefix+"x"],source[prefix+"y"]);context.lineTo(target[prefix+"x"],target[prefix+"y"]);context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.parallel=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],c,d,dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);d=sigma.utils.getCircleIntersection(tX,tY,size,sX,sY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.strokeStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.strokeStyle=color}context.lineWidth=size;context.beginPath();context.moveTo(c.xi,c.yi);context.lineTo(d.xi_prime,d.yi_prime);context.closePath();context.stroke();context.beginPath();context.moveTo(c.xi_prime,c.yi_prime);context.lineTo(d.xi,d.yi);context.closePath();context.stroke();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.tapered=function(edge,source,target,context,settings){var color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,edgeColor=settings("edgeColor"),prefix=settings("prefix")||"",defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),level=edge.active?settings("edgeActiveLevel"):edge.level,sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dist=sigma.utils.getDistance(sX,sY,tX,tY);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}var c=sigma.utils.getCircleIntersection(sX,sY,size,tX,tY,dist);context.save();if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(edge.active){context.fillStyle=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}else{context.fillStyle=color}context.globalAlpha=.65;context.beginPath();context.moveTo(tX,tY);context.lineTo(c.xi,c.yi);context.lineTo(c.xi_prime,c.yi_prime);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}context.restore()}})();(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.extremities");sigma.canvas.extremities.def=function(edge,source,target,context,settings){(sigma.canvas.hovers[source.type]||sigma.canvas.hovers.def)(source,context,settings);(sigma.canvas.hovers[target.type]||sigma.canvas.hovers.def)(target,context,settings)}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.hovers");sigma.canvas.hovers.def=function(node,context,settings){var x,y,w,h,e,fontStyle=settings("hoverFontStyle")||settings("fontStyle"),prefix=settings("prefix")||"",size=node[prefix+"size"]||1,defaultNodeColor=settings("defaultNodeColor"),borderSize=settings("borderSize"),alignment=settings("labelAlignment"),fontSize=settings("labelSize")==="fixed"?settings("defaultLabelSize"):settings("labelSizeRatio")*size,color=settings("nodeHoverColor")==="node"?node.color||defaultNodeColor:settings("defaultNodeHoverColor"),level=settings("nodeHoverLevel");if(alignment!=="center"){prepareLabelBackground(context);drawHoverBorder(alignment,context,fontSize,node)}if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?node.color||defaultNodeColor:settings("defaultNodeBorderColor");context.arc(node[prefix+"x"],node[prefix+"y"],size+borderSize,0,Math.PI*2,true);context.closePath();context.fill()}var nodeRenderer=sigma.canvas.nodes[node.type]||sigma.canvas.nodes.def;nodeRenderer(node,context,settings,{color:color});if(level){context.shadowOffsetY=0;context.shadowBlur=0}if(alignment==="center"){prepareLabelBackground(context);drawHoverBorder(alignment,context,fontSize,node)}if(typeof node.label==="string"){context.fillStyle=settings("labelHoverColor")==="node"?node.color||defaultNodeColor:settings("defaultLabelHoverColor");var labelOffsetX=0,labelOffsetY=fontSize/3,labelWidth;context.textAlign="center";switch(alignment){case"bottom":labelOffsetY=+size+4*fontSize/3;break;case"center":break;case"left":context.textAlign="right";labelOffsetX=-size-borderSize-settings("outerBorderSize")-3-labelWidth;break;case"top":labelOffsetY=-size-2*fontSize/3;break;case"inside":labelWidth=getTextWidth(node.label);if(labelWidth<=(size+fontSize/3)*2){break}case"right":default:labelOffsetX=size+borderSize+settings("outerBorderSize")+3;context.textAlign="left";break}context.fillText(node.label,Math.round(node[prefix+"x"]+labelOffsetX),Math.round(node[prefix+"y"]+labelOffsetY))}function prepareLabelBackground(context){context.font=(fontStyle?fontStyle+" ":"")+fontSize+"px "+(settings("hoverFont")||settings("font"));context.beginPath();context.fillStyle=settings("labelHoverBGColor")==="node"?node.color||defaultNodeColor:settings("defaultHoverLabelBGColor");if(node.label&&settings("labelHoverShadow")){context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowBlur=8;context.shadowColor=settings("labelHoverShadowColor")}}function drawHoverBorder(alignment,context,fontSize,node){var x=Math.round(node[prefix+"x"]),y=Math.round(node[prefix+"y"]),labelWidth=sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,node.label),w=Math.round(labelWidth+4),h=fontSize+4,e=Math.round(size+fontSize*.25);if(node.label&&typeof node.label==="string"){switch(alignment){case"center":y=Math.round(node[prefix+"y"]-fontSize*.5-2);context.rect(x-w*.5,y,w,h);break;case"left":x=Math.round(node[prefix+"x"]+fontSize*.5+2);y=Math.round(node[prefix+"y"]-fontSize*.5-2);w+=size*.5+fontSize*.5;context.moveTo(x,y+e);context.arcTo(x,y,x-e,y,e);context.lineTo(x-w-borderSize-e,y);context.lineTo(x-w-borderSize-e,y+h);context.lineTo(x-e,y+h);context.arcTo(x,y+h,x,y+h-e,e);context.lineTo(x,y+e);break;case"top":context.rect(x-w*.5,y-e-h,w,h);break;case"bottom":context.rect(x-w*.5,y+e,w,h);break;case"inside":if(labelWidth<=e*2){break}case"right":default:x=Math.round(node[prefix+"x"]-fontSize*.5-2);y=Math.round(node[prefix+"y"]-fontSize*.5-2);w+=size*.5+fontSize*.5;context.moveTo(x,y+e);context.arcTo(x,y,x+e,y,e);context.lineTo(x+w+borderSize+e,y);context.lineTo(x+w+borderSize+e,y+h);context.lineTo(x+e,y+h);context.arcTo(x,y+h,x,y+h-e,e);context.lineTo(x,y+e);break}}context.closePath();context.fill();context.shadowOffsetY=0;context.shadowBlur=0}}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.labels");sigma.canvas.labels.def=function(node,context,settings,infos){var fontSize,prefix=settings("prefix")||"",size=node[prefix+"size"]||1,fontStyle=node.active?settings("activeFontStyle"):settings("fontStyle"),borderSize=node.active?settings("borderSize")+settings("outerBorderSize"):0,labelWidth,labelOffsetX,labelOffsetY,alignment=settings("labelAlignment");if(size<settings("labelThreshold"))return;if(!node.label||typeof node.label!=="string")return;fontSize=settings("labelSize")==="fixed"?settings("defaultLabelSize"):settings("labelSizeRatio")*size;var new_font=(fontStyle?fontStyle+" ":"")+fontSize+"px "+(node.active?settings("activeFont")||settings("font"):settings("font"));if(infos&&infos.ctx.font!=new_font){context.font=new_font;infos.ctx.font=new_font}else{context.font=new_font}if(node.active)context.fillStyle=settings("labelActiveColor")==="node"?node.active_color||settings("defaultNodeActiveColor"):settings("defaultLabelActiveColor");else context.fillStyle=settings("labelColor")==="node"?node.color||settings("defaultNodeColor"):settings("defaultLabelColor");labelOffsetX=0;labelOffsetY=fontSize/3;context.textAlign="center";switch(alignment){case"bottom":labelOffsetY=+size+4*fontSize/3;break;case"center":break;case"left":context.textAlign="right";labelOffsetX=-size-borderSize-3;break;case"top":labelOffsetY=-size-2*fontSize/3;break;case"inside":labelWidth=sigma.utils.canvas.getTextWidth(context,settings("approximateLabelWidth"),fontSize,node.label);if(labelWidth<=(size+fontSize/3)*2){break}case"right":default:labelOffsetX=size+borderSize+3;context.textAlign="left";break}context.fillText(node.label,Math.round(node[prefix+"x"]+labelOffsetX),Math.round(node[prefix+"y"]+labelOffsetY))}}).call(this);(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawCross=function(node,x,y,size,context){var lineWeight=node.cross&&node.cross.lineWeight||1;context.moveTo(x-size,y-lineWeight);context.lineTo(x-size,y+lineWeight);context.lineTo(x-lineWeight,y+lineWeight);context.lineTo(x-lineWeight,y+size);context.lineTo(x+lineWeight,y+size);context.lineTo(x+lineWeight,y+lineWeight);context.lineTo(x+size,y+lineWeight);context.lineTo(x+size,y-lineWeight);context.lineTo(x+lineWeight,y-lineWeight);context.lineTo(x+lineWeight,y-size);context.lineTo(x-lineWeight,y-size);context.lineTo(x-lineWeight,y-lineWeight)};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();drawCross(node,x,y,size,context);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.cross=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}}if(node.active){if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");drawCross(node,x,y,size+borderSize+outerBorderSize,context);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");drawCross(node,x,y,size+borderSize,context);context.closePath();context.fill()}}context.fillStyle=color;context.beginPath();drawCross(node,x,y,size,context);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();context.arc(x,y,size*clip,0,Math.PI*2,true);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.def=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";
break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");context.arc(x,y,size+borderSize+outerBorderSize,0,Math.PI*2,true);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");context.arc(x,y,size+borderSize,0,Math.PI*2,true);context.closePath();context.fill()}}if((!node.active||node.active&&settings("nodeActiveColor")==="node")&&node.colors&&node.colors.length){var i,l=node.colors.length,j=1/l,lastend=0;for(i=0;i<l;i++){context.fillStyle=node.colors[i];context.beginPath();context.moveTo(x,y);context.arc(x,y,size,lastend,lastend+Math.PI*2*j,false);context.lineTo(x,y);context.closePath();context.fill();lastend+=Math.PI*2*j}}else{context.fillStyle=color;context.beginPath();context.arc(x,y,size,0,Math.PI*2,true);context.closePath();context.fill()}if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawDiamond=function(node,x,y,size,context){context.moveTo(x-size,y);context.lineTo(x,y-size);context.lineTo(x+size,y);context.lineTo(x,y+size)};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();drawDiamond(node,x,y,size,context);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.diamond=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");drawDiamond(node,x,y,size+borderSize+outerBorderSize,context);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");drawDiamond(node,x,y,size+borderSize,context);context.closePath();context.fill()}}context.fillStyle=color;context.beginPath();drawDiamond(node,x,y,size,context);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawEquilateral=function(node,x,y,size,context){var pcount=node.equilateral&&node.equilateral.numPoints||5;var rotate=node.equilateral&&node.equilateral.rotate||0;var radius=size;rotate+=Math.PI/pcount;context.moveTo(x+radius*Math.sin(rotate),y-radius*Math.cos(rotate));for(var i=1;i<pcount;i++){context.lineTo(x+Math.sin(rotate+2*Math.PI*i/pcount)*radius,y-Math.cos(rotate+2*Math.PI*i/pcount)*radius)}};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();drawEquilateral(node,x,y,size,context);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.equilateral=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");drawEquilateral(node,x,y,size+borderSize+outerBorderSize,context);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");drawEquilateral(node,x,y,size+borderSize,context);context.closePath();context.fill()}}context.fillStyle=color;context.beginPath();drawEquilateral(node,x,y,size,context);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawSquare=function(node,x,y,size,context){var rotate=Math.PI*45/180;context.moveTo(x+size*Math.sin(rotate),y-size*Math.cos(rotate));for(var i=1;i<4;i++){context.lineTo(x+Math.sin(rotate+2*Math.PI*i/4)*size,y-Math.cos(rotate+2*Math.PI*i/4)*size)}};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();drawSquare(node,x,y,size,context);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.square=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");drawSquare(node,x,y,size+borderSize+outerBorderSize,context);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");drawSquare(node,x,y,size+borderSize,context);context.closePath();context.fill()}}context.fillStyle=color;context.beginPath();drawSquare(node,x,y,size,context);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.nodes");var imgCache={};var drawStar=function(node,x,y,size,context){var pcount=node.star&&node.star.numPoints||5,inRatio=node.star&&node.star.innerRatio||.5,outR=size,inR=size*inRatio,angleOffset=Math.PI/pcount;context.moveTo(x,y-size);for(var i=0;i<pcount;i++){context.lineTo(x+Math.sin(angleOffset+2*Math.PI*i/pcount)*inR,y-Math.cos(angleOffset+2*Math.PI*i/pcount)*inR);context.lineTo(x+Math.sin(2*Math.PI*(i+1)/pcount)*outR,y-Math.cos(2*Math.PI*(i+1)/pcount)*outR)}};var drawImage=function(node,x,y,size,context,imgCrossOrigin,threshold){if(!node.image||!node.image.url||size<threshold)return;var url=node.image.url;var ih=node.image.h||1;var iw=node.image.w||1;var scale=node.image.scale||1;var clip=node.image.clip||1;var image=imgCache[url];if(!image){image=document.createElement("IMG");image.setAttribute("crossOrigin",imgCrossOrigin);image.src=url;image.onload=function(){window.dispatchEvent(new Event("resize"))};imgCache[url]=image}var xratio=iw<ih?iw/ih:1;var yratio=ih<iw?ih/iw:1;var r=size*scale;context.save();context.beginPath();drawStar(node,x,y,size,context);context.closePath();context.clip();context.drawImage(image,x+Math.sin(-3.142/4)*r*xratio,y-Math.cos(-3.142/4)*r*yratio,r*xratio*2*Math.sin(-3.142/4)*-1,r*yratio*2*Math.cos(-3.142/4));context.restore()};var drawIcon=function(node,x,y,size,context,threshold){if(!node.icon||size<threshold)return;var font=node.icon.font||"Arial",fgColor=node.icon.color||"#F00",text=node.icon.content||"?",px=node.icon.x||.5,py=node.icon.y||.5,height=size,width=size;var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))}var fontSize=Math.round(fontSizeRatio*height);context.save();context.fillStyle=fgColor;context.font=""+fontSize+"px "+font;context.textAlign="center";context.textBaseline="middle";context.fillText(text,x,y);context.restore()};sigma.canvas.nodes.star=function(node,context,settings,options){var o=options||{},prefix=settings("prefix")||"",size=node[prefix+"size"]||1,x=node[prefix+"x"],y=node[prefix+"y"],defaultNodeColor=settings("defaultNodeColor"),imgCrossOrigin=settings("imgCrossOrigin")||"anonymous",borderSize=settings("borderSize"),outerBorderSize=settings("outerBorderSize"),color=o.color||node.color||defaultNodeColor,level=node.active?settings("nodeActiveLevel"):node.level;if(level){context.shadowOffsetX=0;switch(level){case 1:context.shadowOffsetY=1.5;context.shadowBlur=4;context.shadowColor="rgba(0,0,0,0.36)";break;case 2:context.shadowOffsetY=3;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.39)";break;case 3:context.shadowOffsetY=6;context.shadowBlur=12;context.shadowColor="rgba(0,0,0,0.42)";break;case 4:context.shadowOffsetY=10;context.shadowBlur=20;context.shadowColor="rgba(0,0,0,0.47)";break;case 5:context.shadowOffsetY=15;context.shadowBlur=24;context.shadowColor="rgba(0,0,0,0.52)";break}}if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}if(outerBorderSize>0){context.beginPath();context.fillStyle=settings("nodeOuterBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeOuterBorderColor");drawStar(node,x,y,size+borderSize+outerBorderSize*2,context);context.closePath();context.fill()}if(borderSize>0){context.beginPath();context.fillStyle=settings("nodeBorderColor")==="node"?color||defaultNodeColor:settings("defaultNodeBorderColor");drawStar(node,x,y,size+borderSize,context);context.closePath();context.fill()}}context.fillStyle=color;context.beginPath();drawStar(node,x,y,size,context);context.closePath();context.fill();if(level){context.shadowOffsetY=0;context.shadowBlur=0;context.shadowColor="#000000"}if(node.image){drawImage(node,x,y,size,context,imgCrossOrigin,settings("imageThreshold"))}if(node.icon){drawIcon(node,x,y,size,context,settings("iconThreshold"))}}})();(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.settings");var settings={defaultLabelActiveColor:"#000",activeFont:"",activeFontStyle:"",labelActiveColor:"default",nodeActiveColor:"node",defaultNodeActiveColor:"rgb(236, 81, 72)",edgeActiveColor:"edge",defaultEdgeActiveColor:"rgb(236, 81, 72)",nodeBorderColor:"node,",nodeOuterBorderColor:"",outerBorderSize:0,defaultNodeOuterBorderColor:"#000",nodeActiveLevel:0,nodeHoverLevel:0,edgeActiveLevel:0,edgeHoverLevel:0,iconThreshold:8,imageThreshold:8,imgCrossOrigin:"anonymous"};sigma.settings=sigma.utils.extend(sigma.settings||{},settings)}).call(this);(function(){"use strict";sigma.utils.pkg("sigma.webgl.edges");sigma.webgl.edges.arrow={POINTS:9,ATTRIBUTES:11,addEdge:function(edge,source,target,data,i,prefix,settings){var w=(edge[prefix+"size"]||1)/2,x1=source[prefix+"x"],y1=source[prefix+"y"],x2=target[prefix+"x"],y2=target[prefix+"y"],targetSize=target[prefix+"size"],color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color;if(!color)switch(settings("edgeColor")){case"source":color=source.color||settings("defaultNodeColor");break;case"target":color=target.color||settings("defaultNodeColor");break;default:color=settings("defaultEdgeColor");break}if(edge.active){color=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}color=sigma.utils.floatColor(color);data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=targetSize;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=1;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=targetSize;data[i++]=0;data[i++]=1;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=targetSize;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=0;data[i++]=1;data[i++]=-1;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=0;data[i++]=1;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=targetSize;data[i++]=1;data[i++]=0;data[i++]=1;data[i++]=1;data[i++]=color},render:function(gl,program,data,params){var buffer;var positionLocation1=gl.getAttribLocation(program,"a_pos1"),positionLocation2=gl.getAttribLocation(program,"a_pos2"),thicknessLocation=gl.getAttribLocation(program,"a_thickness"),targetSizeLocation=gl.getAttribLocation(program,"a_tSize"),delayLocation=gl.getAttribLocation(program,"a_delay"),minusLocation=gl.getAttribLocation(program,"a_minus"),headLocation=gl.getAttribLocation(program,"a_head"),headPositionLocation=gl.getAttribLocation(program,"a_headPosition"),colorLocation=gl.getAttribLocation(program,"a_color"),resolutionLocation=gl.getUniformLocation(program,"u_resolution"),matrixLocation=gl.getUniformLocation(program,"u_matrix"),matrixHalfPiLocation=gl.getUniformLocation(program,"u_matrixHalfPi"),matrixHalfPiMinusLocation=gl.getUniformLocation(program,"u_matrixHalfPiMinus"),ratioLocation=gl.getUniformLocation(program,"u_ratio"),nodeRatioLocation=gl.getUniformLocation(program,"u_nodeRatio"),arrowHeadLocation=gl.getUniformLocation(program,"u_arrowHead"),scaleLocation=gl.getUniformLocation(program,"u_scale");buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer);gl.bufferData(gl.ARRAY_BUFFER,data,gl.STATIC_DRAW);gl.uniform2f(resolutionLocation,params.width,params.height);gl.uniform1f(ratioLocation,params.ratio/Math.pow(params.ratio,params.settings("edgesPowRatio")));gl.uniform1f(nodeRatioLocation,Math.pow(params.ratio,params.settings("nodesPowRatio"))/params.ratio);gl.uniform1f(arrowHeadLocation,5);gl.uniform1f(scaleLocation,params.scalingRatio);gl.uniformMatrix3fv(matrixLocation,false,params.matrix);gl.uniformMatrix2fv(matrixHalfPiLocation,false,sigma.utils.matrices.rotation(Math.PI/2,true));gl.uniformMatrix2fv(matrixHalfPiMinusLocation,false,sigma.utils.matrices.rotation(-Math.PI/2,true));gl.enableVertexAttribArray(positionLocation1);gl.enableVertexAttribArray(positionLocation2);gl.enableVertexAttribArray(thicknessLocation);gl.enableVertexAttribArray(targetSizeLocation);gl.enableVertexAttribArray(delayLocation);gl.enableVertexAttribArray(minusLocation);gl.enableVertexAttribArray(headLocation);gl.enableVertexAttribArray(headPositionLocation);gl.enableVertexAttribArray(colorLocation);gl.vertexAttribPointer(positionLocation1,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0);gl.vertexAttribPointer(positionLocation2,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8);gl.vertexAttribPointer(thicknessLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16);gl.vertexAttribPointer(targetSizeLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20);gl.vertexAttribPointer(delayLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24);gl.vertexAttribPointer(minusLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,28);gl.vertexAttribPointer(headLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,32);gl.vertexAttribPointer(headPositionLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,36);gl.vertexAttribPointer(colorLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,40);gl.drawArrays(gl.TRIANGLES,params.start||0,params.count||data.length/this.ATTRIBUTES)},initProgram:function(gl){var vertexShader,fragmentShader,program;vertexShader=sigma.utils.loadShader(gl,["attribute vec2 a_pos1;","attribute vec2 a_pos2;","attribute float a_thickness;","attribute float a_tSize;","attribute float a_delay;","attribute float a_minus;","attribute float a_head;","attribute float a_headPosition;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_nodeRatio;","uniform float u_arrowHead;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 pos = normalize(a_pos2 - a_pos1);","mat2 matrix = (1.0 - a_head) *","(","a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi",") + a_head * (","a_headPosition * u_matrixHalfPiMinus * 0.6 +","(a_headPosition * a_headPosition - 1.0) * mat2(1.0)",");","pos = a_pos1 + (","(1.0 - a_head) * a_thickness * u_ratio * matrix * pos +","a_head * u_arrowHead * a_thickness * u_ratio * matrix * pos +","a_delay * pos * (","a_tSize / u_nodeRatio +","u_arrowHead * a_thickness * u_ratio",")",");","gl_Position = vec4(","((u_matrix * vec3(pos, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),gl.VERTEX_SHADER);fragmentShader=sigma.utils.loadShader(gl,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),gl.FRAGMENT_SHADER);program=sigma.utils.loadProgram(gl,[vertexShader,fragmentShader]);return program}}})();(function(){"use strict";sigma.utils.pkg("sigma.webgl.edges");sigma.webgl.edges.def={POINTS:6,ATTRIBUTES:7,addEdge:function(edge,source,target,data,i,prefix,settings){var w=(edge[prefix+"size"]||1)/2,x1=source[prefix+"x"],y1=source[prefix+"y"],x2=target[prefix+"x"],y2=target[prefix+"y"],color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color;if(!color)switch(settings("edgeColor")){case"source":color=source.color||settings("defaultNodeColor");break;case"target":color=target.color||settings("defaultNodeColor");break;default:color=settings("defaultEdgeColor");break}if(edge.active){color=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}color=sigma.utils.floatColor(color);data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=1;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=0;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=x1;data[i++]=y1;data[i++]=w;data[i++]=0;data[i++]=color;data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=1;data[i++]=color;data[i++]=x1;data[i++]=y1;data[i++]=x2;data[i++]=y2;data[i++]=w;data[i++]=0;data[i++]=color},render:function(gl,program,data,params){var buffer;var colorLocation=gl.getAttribLocation(program,"a_color"),positionLocation1=gl.getAttribLocation(program,"a_position1"),positionLocation2=gl.getAttribLocation(program,"a_position2"),thicknessLocation=gl.getAttribLocation(program,"a_thickness"),minusLocation=gl.getAttribLocation(program,"a_minus"),resolutionLocation=gl.getUniformLocation(program,"u_resolution"),matrixLocation=gl.getUniformLocation(program,"u_matrix"),matrixHalfPiLocation=gl.getUniformLocation(program,"u_matrixHalfPi"),matrixHalfPiMinusLocation=gl.getUniformLocation(program,"u_matrixHalfPiMinus"),ratioLocation=gl.getUniformLocation(program,"u_ratio"),scaleLocation=gl.getUniformLocation(program,"u_scale");buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer);gl.bufferData(gl.ARRAY_BUFFER,data,gl.STATIC_DRAW);gl.uniform2f(resolutionLocation,params.width,params.height);gl.uniform1f(ratioLocation,params.ratio/Math.pow(params.ratio,params.settings("edgesPowRatio")));gl.uniform1f(scaleLocation,params.scalingRatio);gl.uniformMatrix3fv(matrixLocation,false,params.matrix);gl.uniformMatrix2fv(matrixHalfPiLocation,false,sigma.utils.matrices.rotation(Math.PI/2,true));gl.uniformMatrix2fv(matrixHalfPiMinusLocation,false,sigma.utils.matrices.rotation(-Math.PI/2,true));gl.enableVertexAttribArray(colorLocation);gl.enableVertexAttribArray(positionLocation1);gl.enableVertexAttribArray(positionLocation2);gl.enableVertexAttribArray(thicknessLocation);gl.enableVertexAttribArray(minusLocation);gl.vertexAttribPointer(positionLocation1,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0);gl.vertexAttribPointer(positionLocation2,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8);gl.vertexAttribPointer(thicknessLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16);gl.vertexAttribPointer(minusLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20);gl.vertexAttribPointer(colorLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,24);gl.drawArrays(gl.TRIANGLES,params.start||0,params.count||data.length/this.ATTRIBUTES)},initProgram:function(gl){var vertexShader,fragmentShader,program;vertexShader=sigma.utils.loadShader(gl,["attribute vec2 a_position1;","attribute vec2 a_position2;","attribute float a_thickness;","attribute float a_minus;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","uniform mat2 u_matrixHalfPi;","uniform mat2 u_matrixHalfPiMinus;","varying vec4 color;","void main() {","vec2 position = a_thickness * u_ratio *","normalize(a_position2 - a_position1);","mat2 matrix = a_minus * u_matrixHalfPiMinus +","(1.0 - a_minus) * u_matrixHalfPi;","position = matrix * position + a_position1;","gl_Position = vec4(","((u_matrix * vec3(position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),gl.VERTEX_SHADER);fragmentShader=sigma.utils.loadShader(gl,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),gl.FRAGMENT_SHADER);program=sigma.utils.loadProgram(gl,[vertexShader,fragmentShader]);return program}}})();(function(){"use strict";sigma.utils.pkg("sigma.webgl.edges");sigma.webgl.edges.fast={POINTS:2,ATTRIBUTES:3,addEdge:function(edge,source,target,data,i,prefix,settings){var w=(edge[prefix+"size"]||1)/2,x1=source[prefix+"x"],y1=source[prefix+"y"],x2=target[prefix+"x"],y2=target[prefix+"y"],color=edge.active?edge.active_color||settings("defaultEdgeActiveColor"):edge.color;if(!color)switch(settings("edgeColor")){case"source":color=source.color||settings("defaultNodeColor");break;case"target":color=target.color||settings("defaultNodeColor");break;default:color=settings("defaultEdgeColor");break}if(edge.active){color=settings("edgeActiveColor")==="edge"?color||defaultEdgeColor:settings("defaultEdgeActiveColor")}color=sigma.utils.floatColor(color);data[i++]=x1;data[i++]=y1;data[i++]=color;data[i++]=x2;data[i++]=y2;data[i++]=color},render:function(gl,program,data,params){var buffer;var colorLocation=gl.getAttribLocation(program,"a_color"),positionLocation=gl.getAttribLocation(program,"a_position"),resolutionLocation=gl.getUniformLocation(program,"u_resolution"),matrixLocation=gl.getUniformLocation(program,"u_matrix");buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer);gl.bufferData(gl.ARRAY_BUFFER,data,gl.DYNAMIC_DRAW);gl.uniform2f(resolutionLocation,params.width,params.height);gl.uniformMatrix3fv(matrixLocation,false,params.matrix);gl.enableVertexAttribArray(positionLocation);gl.enableVertexAttribArray(colorLocation);gl.vertexAttribPointer(positionLocation,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0);gl.vertexAttribPointer(colorLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8);gl.lineWidth(3);gl.drawArrays(gl.LINES,params.start||0,params.count||data.length/this.ATTRIBUTES)},initProgram:function(gl){var vertexShader,fragmentShader,program;vertexShader=sigma.utils.loadShader(gl,["attribute vec2 a_position;","attribute float a_color;","uniform vec2 u_resolution;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),gl.VERTEX_SHADER);fragmentShader=sigma.utils.loadShader(gl,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),gl.FRAGMENT_SHADER);program=sigma.utils.loadProgram(gl,[vertexShader,fragmentShader]);return program}}})();(function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes");sigma.webgl.nodes.def={POINTS:3,ATTRIBUTES:12,addNode:function(node,data,i,prefix,settings){var self=this;var trueColor=node.color||settings("defaultNodeColor");var imgCrossOrigin=settings("imgCrossOrigin")||"anonymous";if(node.active){
if(settings("nodeActiveColor")==="node"){trueColor=node.active_color||trueColor}else{trueColor=settings("defaultNodeActiveColor")||trueColor}}var color=sigma.utils.floatColor(trueColor||settings("defaultNodeColor"));if(typeof self.spriteSheet==="undefined"){self.createSpriteSheet(settings)}var imageIndex=-1;var scale=.7;var numPoints=999;var imageScaleW=1;var imageScaleH=1;var isConvex=1;var shapeRotation=0;switch(node.type||"circle"){case"circle":case"disc":case"disk":isConvex=1;numPoints=999;scale=1;break;case"square":isConvex=0;numPoints=4;scale=.7;if(typeof node.square!=="undefined"){if(typeof node.square.rotate==="number"){shapeRotation=node.square.rotate}}break;case"diamond":isConvex=0;numPoints=4;scale=.7;shapeRotation=45*Math.PI/180;if(typeof node.diamond!=="undefined"){if(typeof node.diamond.rotate==="number"){shapeRotation=node.diamond.rotate}}break;case"triangle":isConvex=0;numPoints=3;scale=.5;shapeRotation=Math.PI;if(typeof node.triangle!=="undefined"){if(typeof node.triangle.rotate==="number"){shapeRotation=node.triangle.rotate}}break;case"star":isConvex=1;scale=.7;numPoints=5;if(typeof node.star!=="undefined"){if(typeof node.star.numPoints==="number"){numPoints=node.star.numPoints}if(typeof node.star.rotate==="number"){shapeRotation=node.star.rotate}}break;case"seastar":isConvex=2;scale=.5;numPoints=5;if(typeof node.seastar!=="undefined"){if(typeof node.seastar.numPoints==="number"){numPoints=node.seastar.numPoints}if(typeof node.seastar.rotate==="number"){shapeRotation=node.seastar.rotate}}break;case"equilateral":isConvex=0;numPoints=7;scale=.7;shapeRotation=0;if(typeof node.equilateral!=="undefined"){if(typeof node.equilateral.numPoints==="number"){numPoints=node.equilateral.numPoints}if(typeof node.equilateral.rotate==="number"){shapeRotation=node.equilateral.rotate}}break;case"hexagon":isConvex=0;numPoints=6;scale=.7;if(typeof node.hexagon!=="undefined"){if(typeof node.hexagon.rotate==="number"){shapeRotation=node.hexagon.rotate}}break;case"polygon":isConvex=1;numPoints=5;scale=.5;shapeRotation=0;if(typeof node.polygon!=="undefined"){if(typeof node.polygon.type==="string"){isConvex=node.polygon.type=="convex"?1:0}if(typeof node.polygon.angles==="number"){numPoints=Math.round(Math.max(3,Math.min(8,node.polygon.angles)))}if(typeof node.polygon.scale==="number"){scale=node.polygon.scale||(isConvex?.5:.7)}if(typeof node.polygon.rotate==="number"){shapeRotation=node.polygon.rotate}}break;case"cross":isConvex=0;numPoints=9;scale=.1;if(typeof node.cross!=="undefined"){if(typeof node.cross.lineWeight==="number"){scale=Math.max(.1,Math.min(.5,node.cross.lineWeight*.1))}if(typeof node.rotate==="number"){shapeRotation=node.cross.rotate}}break}if(typeof node.image!=="undefined"){var url=node.image.url||"";if(url.length>0){imageIndex=self.getImage(url,imgCrossOrigin);imageScaleW=node.image.w||1;imageScaleH=node.image.h||1}}if(typeof node.icon!=="undefined"){var font="Arial";if(typeof node.icon.font==="string"){font=node.icon.font}var content="";if(typeof node.icon.content==="string"){content=node.icon.content}var fontSizeRatio=.7;if(typeof node.icon.scale==="number"){fontSizeRatio=Math.abs(Math.max(.01,node.icon.scale))*.5}var fgColor=node.icon.color||trueColor;var bgColor=node.color||trueColor;var px=.5,py=.5;if(typeof node.icon.x==="number"){px=node.icon.x}if(typeof node.icon.y==="number"){py=node.icon.y}imageIndex=self.getText(font,bgColor,fgColor,fontSizeRatio,px,py,content)}data[i++]=node[prefix+"x"];data[i++]=node[prefix+"y"];data[i++]=node[prefix+"size"];data[i++]=color;data[i++]=0;data[i++]=isConvex;data[i++]=numPoints;data[i++]=scale;data[i++]=shapeRotation;data[i++]=imageIndex;data[i++]=imageScaleW;data[i++]=imageScaleH;data[i++]=node[prefix+"x"];data[i++]=node[prefix+"y"];data[i++]=node[prefix+"size"];data[i++]=color;data[i++]=2*Math.PI/3;data[i++]=isConvex;data[i++]=numPoints;data[i++]=scale;data[i++]=shapeRotation;data[i++]=imageIndex;data[i++]=imageScaleW;data[i++]=imageScaleH;data[i++]=node[prefix+"x"];data[i++]=node[prefix+"y"];data[i++]=node[prefix+"size"];data[i++]=color;data[i++]=4*Math.PI/3;data[i++]=isConvex;data[i++]=numPoints;data[i++]=scale;data[i++]=shapeRotation;data[i++]=imageIndex;data[i++]=imageScaleW;data[i++]=imageScaleH},render:function(gl,program,data,params){var buffer,self=this,args=arguments;if(typeof self.spriteSheet==="undefined"){self.createSpriteSheet()}var positionLocation=gl.getAttribLocation(program,"a_position"),sizeLocation=gl.getAttribLocation(program,"a_size"),colorLocation=gl.getAttribLocation(program,"a_color"),angleLocation=gl.getAttribLocation(program,"a_angle"),imageLocation=gl.getAttribLocation(program,"a_image"),shapeLocation=gl.getAttribLocation(program,"a_shape"),resolutionLocation=gl.getUniformLocation(program,"u_resolution"),matrixLocation=gl.getUniformLocation(program,"u_matrix"),ratioLocation=gl.getUniformLocation(program,"u_ratio"),scaleLocation=gl.getUniformLocation(program,"u_scale"),spriteDimLocation=gl.getUniformLocation(program,"u_sprite_dim"),textureDimLocation=gl.getUniformLocation(program,"u_texture_dim"),samplerUniformLocation=gl.getUniformLocation(program,"u_sampler");buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer);gl.bufferData(gl.ARRAY_BUFFER,data,gl.DYNAMIC_DRAW);gl.uniform2f(resolutionLocation,params.width,params.height);gl.uniform1f(ratioLocation,1/Math.pow(params.ratio,params.settings("nodesPowRatio")));gl.uniform1f(scaleLocation,params.scalingRatio);gl.uniformMatrix3fv(matrixLocation,false,params.matrix);gl.uniform2f(spriteDimLocation,self.spriteSheet.spriteWidth,self.spriteSheet.spriteHeight);gl.uniform2f(textureDimLocation,self.spriteSheet.maxWidth,self.spriteSheet.maxHeight);gl.enableVertexAttribArray(positionLocation);gl.enableVertexAttribArray(sizeLocation);gl.enableVertexAttribArray(colorLocation);gl.enableVertexAttribArray(angleLocation);gl.enableVertexAttribArray(shapeLocation);gl.enableVertexAttribArray(imageLocation);gl.vertexAttribPointer(positionLocation,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0);gl.vertexAttribPointer(sizeLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8);gl.vertexAttribPointer(colorLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12);gl.vertexAttribPointer(angleLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,16);gl.vertexAttribPointer(shapeLocation,4,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,20);gl.vertexAttribPointer(imageLocation,3,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,36);if(typeof self.texture==="undefined"){self.texture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,self.texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,self.spriteSheet.canvas);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);gl.enable(gl.BLEND);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.generateMipmap(gl.TEXTURE_2D)}if(typeof self.texture!=="undefined"){gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,self.texture);if(self.updateNeeded){self.updateNeeded=false;gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,false);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,self.spriteSheet.canvas)}gl.uniform1i(gl.getUniformLocation(program,"u_sampler"),0)}gl.drawArrays(gl.TRIANGLES,params.start||0,params.count||data.length/this.ATTRIBUTES)},initProgram:function(gl){var vertexShader,fragmentShader,program;vertexShader=sigma.utils.loadShader(gl,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","attribute float a_angle;","attribute vec4 a_shape;","attribute vec3 a_image;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","uniform vec2 u_sprite_dim;","uniform vec2 u_texture_dim;","varying vec4 shape;","varying highp vec4 v_sprite;","varying vec4 color;","varying vec2 center;","varying float radius;","varying vec3 image;","void main() {","radius = a_size * u_ratio;","vec2 position = (u_matrix * vec3(a_position, 1)).xy;","center = position * u_scale;","center = vec2(center.x, u_scale * u_resolution.y - center.y);","position = position +","2.0 * radius * vec2(cos(a_angle), sin(a_angle));","position = (position / u_resolution * 2.0 - 1.0) * vec2(1, -1);","radius = radius * u_scale;","shape = a_shape;","image = a_image;","highp vec2 sp = ","vec2(mod((a_image.s * u_sprite_dim.x), u_texture_dim.x),","floor((a_image.s * u_sprite_dim.x) / u_texture_dim.y) * u_sprite_dim.y);","sp = vec2(sp.x + (u_sprite_dim.x * 0.5),"," sp.y + (u_sprite_dim.y * 0.5));","v_sprite = vec4(","sp.x / u_texture_dim.x,","sp.y / u_texture_dim.y,","u_sprite_dim.x / u_texture_dim.x,","- u_sprite_dim.y / u_texture_dim.y",");","gl_Position = vec4(position, 0, 1);","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),gl.VERTEX_SHADER);fragmentShader=sigma.utils.loadShader(gl,["#ifdef GL_ES","precision mediump float;","#endif","#define PI_2 6.283185307179586","#define MAX_ANGLES 8","varying vec4 shape;","varying highp vec4 v_sprite;","varying vec4 color;","varying vec2 center;","varying float radius;","varying vec3 image;","uniform sampler2D u_sampler;","void main(void) {","int angles = int(shape.t);","int convex = int(shape.s);","vec2 m = gl_FragCoord.xy - center;","vec2 p = m.xy/radius;","float theta = atan(p.y,p.x);","vec4 color0 = vec4(0.0, 0.0, 0.0, 0.0);","vec4 color1 = (image.s >= 0.0) ?"," texture2D(u_sampler, ","vec2(","(v_sprite.s + v_sprite.p * p.x * 0.5 * image.t),","(v_sprite.t + v_sprite.q * p.y * 0.5 * image.p)","))"," : color",";","mat2 shapeRot = mat2(cos(shape.q),sin(shape.q),-sin(shape.q),cos(shape.q));","p = p * shapeRot;","if (angles > 9) {","gl_FragColor = ","((radius - sqrt(m.x * m.x + m.y * m.y)) > 0.0)","? color1 : color0;","} else if (angles > 8){","gl_FragColor = (","(abs(p.x) > 0.0 && abs(p.x) < (1.0 - sin(shape.p)) && abs(p.y) < shape.p)","|| (abs(p.y) > 0.0 && abs(p.y) < (1.0 - sin(shape.p)) && abs(p.x) < shape.p)",") ? color1 : color0;","} else {","float scale = (convex > 0) ? shape.p * 0.5 : shape.p;","float angle = PI_2 / shape.t;","mat2 t = mat2(cos(angle),sin(angle),-sin(angle),cos(angle));","int q = 0;","for (int i=0;i<MAX_ANGLES;i++) {","if (i >= angles) break;","if (p.y < scale) q++;","p *= t;","}","gl_FragColor =","((convex > 0)","? (q > angles - (angles - 1) / 2)",": (q > angles - 1))","? color1 : color0;","}","}"].join("\n"),gl.FRAGMENT_SHADER);program=sigma.utils.loadProgram(gl,[vertexShader,fragmentShader]);return program},createSpriteSheet:function(settings){var self=this;var config={maxWidth:settings("spriteSheetResolution")||2048,maxHeight:settings("spriteSheetResolution")||2048,maxSprites:settings("spriteSheetMaxSprites")||256};var spriteWidth=config.maxWidth/Math.sqrt(config.maxSprites);var spriteHeight=config.maxHeight/Math.sqrt(config.maxSprites);var canvas=document.createElement("canvas");canvas.width=config.maxWidth;canvas.height=config.maxHeight;var ctx=canvas.getContext("2d");self.spriteSheet={canvas:canvas,maxWidth:config.maxWidth,maxHeight:config.maxHeight,maxSprites:config.maxSprite,spriteWidth:spriteWidth,spriteHeight:spriteHeight,currentIndex:1,urlToIndex:{}}},getText:function(font,bgColor,fgColor,fontSizeRatio,px,py,text){var self=this;var fontSize=Math.round(fontSizeRatio*self.spriteSheet.spriteHeight);var pwx=px*self.spriteSheet.spriteWidth;var phy=py*self.spriteSheet.spriteHeight;var uid=font+":"+bgColor+":"+fgColor+":"+fontSize+":"+text+":"+pwx+":"+phy;if(uid in self.spriteSheet.urlToIndex){return self.spriteSheet.urlToIndex[uid]}var index=self.spriteSheet.currentIndex;self.spriteSheet.currentIndex+=1;self.spriteSheet.urlToIndex[uid]=index;var x=index*self.spriteSheet.spriteWidth%self.spriteSheet.maxWidth;var y=Math.floor(index*self.spriteSheet.spriteWidth/self.spriteSheet.maxWidth)*self.spriteSheet.spriteHeight;var ctx=self.spriteSheet.canvas.getContext("2d");ctx.beginPath();ctx.rect(x,y,self.spriteSheet.spriteWidth,self.spriteSheet.spriteHeight);ctx.fillStyle=bgColor;ctx.fill();ctx.beginPath();ctx.fillStyle=fgColor;ctx.font=""+fontSize+"px "+font;ctx.textAlign="center";ctx.textBaseline="middle";ctx.fillText(text,x+pwx,y+phy);self.updateNeeded=true;return index},getImage:function(url,imgCrossOrigin){var self=this;var ctx=self.spriteSheet.canvas.getContext("2d");if(url.length<1){return-1}if(url in self.spriteSheet.urlToIndex){return self.spriteSheet.urlToIndex[url]}var index=self.spriteSheet.currentIndex;if(index>self.spriteSheet.maxSprites){return-1}self.spriteSheet.currentIndex+=1;self.spriteSheet.urlToIndex[url]=index;var img=new Image;img.setAttribute("crossOrigin",imgCrossOrigin);img.onload=function(){var x=index*self.spriteSheet.spriteWidth%self.spriteSheet.maxWidth;var y=Math.floor(index*self.spriteSheet.spriteWidth/self.spriteSheet.maxWidth)*self.spriteSheet.spriteHeight;ctx.drawImage(img,0,0,img.width,img.height,x,y,self.spriteSheet.spriteWidth,self.spriteSheet.spriteHeight);self.updateNeeded=true};img.src=url;return index}}})();(function(){"use strict";sigma.utils.pkg("sigma.webgl.nodes");sigma.webgl.nodes.fast={POINTS:1,ATTRIBUTES:4,addNode:function(node,data,i,prefix,settings){var color=node.color||settings("defaultNodeColor");if(node.active){if(settings("nodeActiveColor")==="node"){color=node.active_color||color}else{color=settings("defaultNodeActiveColor")||color}}color=sigma.utils.floatColor(color||settings("defaultNodeColor"));data[i++]=node[prefix+"x"];data[i++]=node[prefix+"y"];data[i++]=node[prefix+"size"]||1;data[i++]=sigma.utils.floatColor(color||settings("defaultNodeColor"))},render:function(gl,program,data,params){var buffer;var positionLocation=gl.getAttribLocation(program,"a_position"),sizeLocation=gl.getAttribLocation(program,"a_size"),colorLocation=gl.getAttribLocation(program,"a_color"),resolutionLocation=gl.getUniformLocation(program,"u_resolution"),matrixLocation=gl.getUniformLocation(program,"u_matrix"),ratioLocation=gl.getUniformLocation(program,"u_ratio"),scaleLocation=gl.getUniformLocation(program,"u_scale");buffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,buffer);gl.bufferData(gl.ARRAY_BUFFER,data,gl.DYNAMIC_DRAW);gl.uniform2f(resolutionLocation,params.width,params.height);gl.uniform1f(ratioLocation,1/Math.pow(params.ratio,params.settings("nodesPowRatio")));gl.uniform1f(scaleLocation,params.scalingRatio);gl.uniformMatrix3fv(matrixLocation,false,params.matrix);gl.enableVertexAttribArray(positionLocation);gl.enableVertexAttribArray(sizeLocation);gl.enableVertexAttribArray(colorLocation);gl.vertexAttribPointer(positionLocation,2,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,0);gl.vertexAttribPointer(sizeLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,8);gl.vertexAttribPointer(colorLocation,1,gl.FLOAT,false,this.ATTRIBUTES*Float32Array.BYTES_PER_ELEMENT,12);gl.drawArrays(gl.POINTS,params.start||0,params.count||data.length/this.ATTRIBUTES)},initProgram:function(gl){var vertexShader,fragmentShader,program;vertexShader=sigma.utils.loadShader(gl,["attribute vec2 a_position;","attribute float a_size;","attribute float a_color;","uniform vec2 u_resolution;","uniform float u_ratio;","uniform float u_scale;","uniform mat3 u_matrix;","varying vec4 color;","void main() {","gl_Position = vec4(","((u_matrix * vec3(a_position, 1)).xy /","u_resolution * 2.0 - 1.0) * vec2(1, -1),","0,","1",");","gl_PointSize = a_size * u_ratio * u_scale * 2.0;","float c = a_color;","color.b = mod(c, 256.0); c = floor(c / 256.0);","color.g = mod(c, 256.0); c = floor(c / 256.0);","color.r = mod(c, 256.0); c = floor(c / 256.0); color /= 255.0;","color.a = 1.0;","}"].join("\n"),gl.VERTEX_SHADER);fragmentShader=sigma.utils.loadShader(gl,["precision mediump float;","varying vec4 color;","void main(void) {","gl_FragColor = color;","}"].join("\n"),gl.FRAGMENT_SHADER);program=sigma.utils.loadProgram(gl,[vertexShader,fragmentShader]);return program}}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.curve=function(edge,source,target,context,settings){var color=edge.color,prefix=settings("prefix")||"",size=settings("edgeHoverSizeRatio")*(edge[prefix+"size"]||1),count=edge.count||0,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),cp={},sSize=source[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,sSize,count):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY,count);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x1,cp.y1,cp.x2,cp.y2,tX,tY)}else{context.quadraticCurveTo(cp.x,cp.y,tX,tY)}context.stroke()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edgehovers");sigma.canvas.edgehovers.curvedArrow=function(edge,source,target,context,settings){var color=edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),cp={},size=settings("edgeHoverSizeRatio")*(edge[prefix+"size"]||1),count=edge.count||0,tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],d,aSize,aX,aY,vX,vY;cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,tSize,count):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY,count);if(source.id===target.id){d=Math.sqrt(Math.pow(tX-cp.x1,2)+Math.pow(tY-cp.y1,2));aSize=size*2.5;aX=cp.x1+(tX-cp.x1)*(d-aSize-tSize)/d;aY=cp.y1+(tY-cp.y1)*(d-aSize-tSize)/d;vX=(tX-cp.x1)*aSize/d;vY=(tY-cp.y1)*aSize/d}else{d=Math.sqrt(Math.pow(tX-cp.x,2)+Math.pow(tY-cp.y,2));aSize=size*2.5;aX=cp.x+(tX-cp.x)*(d-aSize-tSize)/d;aY=cp.y+(tY-cp.y)*(d-aSize-tSize)/d;vX=(tX-cp.x)*aSize/d;vY=(tY-cp.y)*aSize/d}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}if(settings("edgeHoverColor")==="edge"){color=edge.hover_color||color}else{color=edge.hover_color||settings("defaultEdgeHoverColor")||color}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x2,cp.y2,cp.x1,cp.y1,aX,aY)}else{context.quadraticCurveTo(cp.x,cp.y,aX,aY)}context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.curve=function(edge,source,target,context,settings){var color=edge.color,prefix=settings("prefix")||"",size=edge[prefix+"size"]||1,count=edge.count||0,edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),cp={},sSize=source[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"];cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,sSize,count):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY,count);if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x1,cp.y1,cp.x2,cp.y2,tX,tY)}else{context.quadraticCurveTo(cp.x,cp.y,tX,tY)}context.stroke()}})();(function(){"use strict";sigma.utils.pkg("sigma.canvas.edges");sigma.canvas.edges.curvedArrow=function(edge,source,target,context,settings){var color=edge.color,prefix=settings("prefix")||"",edgeColor=settings("edgeColor"),defaultNodeColor=settings("defaultNodeColor"),defaultEdgeColor=settings("defaultEdgeColor"),cp={},size=edge[prefix+"size"]||1,count=edge.count||0,tSize=target[prefix+"size"],sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],aSize=Math.max(size*2.5,settings("minArrowSize")),d,aX,aY,vX,vY;cp=source.id===target.id?sigma.utils.getSelfLoopControlPoints(sX,sY,tSize,count):sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY,count);if(source.id===target.id){d=Math.sqrt(Math.pow(tX-cp.x1,2)+Math.pow(tY-cp.y1,2));aX=cp.x1+(tX-cp.x1)*(d-aSize-tSize)/d;aY=cp.y1+(tY-cp.y1)*(d-aSize-tSize)/d;vX=(tX-cp.x1)*aSize/d;vY=(tY-cp.y1)*aSize/d}else{d=Math.sqrt(Math.pow(tX-cp.x,2)+Math.pow(tY-cp.y,2));aX=cp.x+(tX-cp.x)*(d-aSize-tSize)/d;aY=cp.y+(tY-cp.y)*(d-aSize-tSize)/d;vX=(tX-cp.x)*aSize/d;vY=(tY-cp.y)*aSize/d}if(!color)switch(edgeColor){case"source":color=source.color||defaultNodeColor;break;case"target":color=target.color||defaultNodeColor;break;default:color=defaultEdgeColor;break}context.strokeStyle=color;context.lineWidth=size;context.beginPath();context.moveTo(sX,sY);if(source.id===target.id){context.bezierCurveTo(cp.x2,cp.y2,cp.x1,cp.y1,aX,aY)}else{context.quadraticCurveTo(cp.x,cp.y,aX,aY)}context.stroke();context.fillStyle=color;context.beginPath();context.moveTo(aX+vX,aY+vY);context.lineTo(aX+vY*.6,aY-vX*.6);context.lineTo(aX-vY*.6,aY+vX*.6);context.lineTo(aX+vX,aY+vY);context.closePath();context.fill()}})();(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.utils.pkg("sigma.canvas.edges.labels");sigma.canvas.edges.labels.curve=function(edge,source,target,context,settings){if(typeof edge.label!=="string")return;var prefix=settings("prefix")||"",size=edge[prefix+"size"]||1;if(size<settings("edgeLabelThreshold"))return;var fontSize,sSize=source[prefix+"size"],count=edge.count||0,sX=source[prefix+"x"],sY=source[prefix+"y"],tX=target[prefix+"x"],tY=target[prefix+"y"],dX=tX-sX,dY=tY-sY,sign=sX<tX?1:-1,cp={},c,angle,t=.5;if(source.id===target.id){cp=sigma.utils.getSelfLoopControlPoints(sX,sY,sSize,count);c=sigma.utils.getPointOnBezierCurve(t,sX,sY,tX,tY,cp.x1,cp.y1,cp.x2,cp.y2);angle=Math.atan2(1,1)}else{cp=sigma.utils.getQuadraticControlPoint(sX,sY,tX,tY,count);c=sigma.utils.getPointOnQuadraticCurve(t,sX,sY,tX,tY,cp.x,cp.y);angle=Math.atan2(dY*sign,dX*sign)}fontSize=settings("edgeLabelSize")==="fixed"?settings("defaultEdgeLabelSize"):settings("defaultEdgeLabelSize")*size*Math.pow(size,-1/settings("edgeLabelSizePowRatio"));context.save();if(edge.active){context.font=[settings("activeFontStyle"),fontSize+"px",settings("activeFont")||settings("font")].join(" ");context.fillStyle=settings("edgeActiveColor")==="edge"?edge.active_color||settings("defaultEdgeActiveColor"):settings("defaultEdgeLabelActiveColor")}else{context.font=[settings("fontStyle"),fontSize+"px",settings("font")].join(" ");context.fillStyle=settings("edgeLabelColor")==="edge"?edge.color||settings("defaultEdgeColor"):settings("defaultEdgeLabelColor")}context.textAlign="center";context.textBaseline="alphabetic";context.translate(c.x,c.y);context.rotate(angle);context.fillText(edge.label,0,-size/2-3);context.restore()}}).call(this);(function(undefined){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";var _root=this;sigma.utils=sigma.utils||{};sigma.utils.getQuadraticControlPoint=function(x1,y1,x2,y2,a){a=a||0;return{x:(x1+x2)/2+(y2-y1)/(60/(15+a)),y:(y1+y2)/2+(x1-x2)/(60/(15+a))}};sigma.utils.getSelfLoopControlPoints=function(x,y,size,a){a=a||0;return{x1:x-(size+a)*7,y1:y,x2:x,y2:y+(size+a)*7}}}).call(this);(function(){"use strict";if(typeof sigma==="undefined")throw"sigma is not declared";sigma.classes.graph.addMethod("HITS",function(isUndirected){var res={},epsilon=1e-4,hubList=[],authList=[],nodes=this.nodes(),nodesCount=nodes.length,tempRes={};if(!isUndirected)isUndirected=false;for(var i in nodes){if(isUndirected){hubList.push(nodes[i]);authList.push(nodes[i])}else{if(this.degree(nodes[i].id,"out")>0)hubList.push(nodes[i]);if(this.degree(nodes[i].id,"in")>0)authList.push(nodes[i])}res[nodes[i].id]={authority:1,hub:1}}var done;while(true){done=true;var authSum=0,hubSum=0;for(var i in authList){tempRes[authList[i].id]={authority:1,hub:0};var connectedNodes=[];if(isUndirected)connectedNodes=this.allNeighborsIndex[authList[i].id];else connectedNodes=this.inNeighborsIndex[authList[i].id];for(var j in connectedNodes){if(j!=authList[i].id)tempRes[authList[i].id].authority+=res[j].hub}authSum+=tempRes[authList[i].id].authority}for(var i in hubList){if(tempRes[hubList[i].id])tempRes[hubList[i].id].hub=1;else tempRes[hubList[i].id]={authority:0,hub:1};var connectedNodes=[];if(isUndirected)connectedNodes=this.allNeighborsIndex[hubList[i].id];else connectedNodes=this.outNeighborsIndex[hubList[i].id];for(var j in connectedNodes){if(j!=hubList[i].id)tempRes[hubList[i].id].hub+=res[j].authority}hubSum+=tempRes[hubList[i].id].hub}for(var i in authList){tempRes[authList[i].id].authority/=authSum;if(Math.abs((tempRes[authList[i].id].authority-res[authList[i].id].authority)/res[authList[i].id].authority)>=epsilon)done=false}for(var i in hubList){tempRes[hubList[i].id].hub/=hubSum;if(Math.abs((tempRes[hubList[i].id].hub-res[hubList[i].id].hub)/res[hubList[i].id].hub)>=epsilon)done=false}res=tempRes;tempRes={};if(done)break}return res})}).call(window);(function(undefined){"use strict";if(typeof sigma==="undefined")throw new Error("sigma not in scope.");sigma.utils.pkg("sigma.plugins");var jLouvain=function(graph,partitions){var __PASS_MAX=-1,__MIN=1e-7;var status={},dendogram=[],original_graph,partition_init;original_graph={nodes:graph.nodes().map(function(n){return n.id}),edges:graph.edges(),_assoc_mat:make_assoc_mat(graph.edges())};partition_init=partitions;function make_set(array){var set={};array.forEach(function(d,i){set[d]=true});return Object.keys(set)}function obj_values(obj){var vals=[];for(var key in obj){if(obj.hasOwnProperty(key)){vals.push(obj[key])}}return vals}function get_degree_for_node(graph,node){var neighbours=graph._assoc_mat[node]?Object.keys(graph._assoc_mat[node]):[];var weight=0;neighbours.forEach(function(neighbour,i){var value=graph._assoc_mat[node][neighbour]||1;if(node==neighbour)value*=2;weight+=value});return weight}function get_neighbours_of_node(graph,node){if(typeof graph._assoc_mat[node]=="undefined")return[];var neighbours=Object.keys(graph._assoc_mat[node]);return neighbours}function get_edge_weight(graph,node1,node2){return graph._assoc_mat[node1]?graph._assoc_mat[node1][node2]:undefined}function get_graph_size(graph){var size=0;graph.edges.forEach(function(edge){size+=edge.weight});return size}function add_edge_to_graph(graph,edge){update_assoc_mat(graph,edge);var edge_index=graph.edges.map(function(d){return d.source+"_"+d.target}).indexOf(edge.source+"_"+edge.target);if(edge_index!=-1)graph.edges[edge_index].weight=edge.weight;else graph.edges.push(edge)}function make_assoc_mat(edge_list){var mat={};edge_list.forEach(function(edge,i){mat[edge.source]=mat[edge.source]||{};mat[edge.source][edge.target]=edge.weight;mat[edge.target]=mat[edge.target]||{};mat[edge.target][edge.source]=edge.weight});return mat}function update_assoc_mat(graph,edge){graph._assoc_mat[edge.source]=graph._assoc_mat[edge.source]||{};graph._assoc_mat[edge.source][edge.target]=edge.weight;graph._assoc_mat[edge.target]=graph._assoc_mat[edge.target]||{};graph._assoc_mat[edge.target][edge.source]=edge.weight}function clone(obj){if(obj==null||typeof obj!="object")return obj;var temp=obj.constructor();for(var key in obj)temp[key]=clone(obj[key]);return temp}function init_status(graph,status,part){status["nodes_to_com"]={};status["total_weight"]=0;status["internals"]={};status["degrees"]={};status["gdegrees"]={};status["loops"]={};status["total_weight"]=get_graph_size(graph);if(typeof part=="undefined"){graph.nodes.forEach(function(node,i){status.nodes_to_com[node]=i;var deg=get_degree_for_node(graph,node);if(deg<0)throw new Error("A node has a negative degree. Use positive weights.");status.degrees[i]=deg;status.gdegrees[node]=deg;status.loops[node]=get_edge_weight(graph,node,node)||0;status.internals[i]=status.loops[node]})}else{graph.nodes.forEach(function(node,i){var com=part[node];status.nodes_to_com[node]=com;var deg=get_degree_for_node(graph,node);status.degrees[com]=(status.degrees[com]||0)+deg;status.gdegrees[node]=deg;var inc=0;var neighbours=get_neighbours_of_node(graph,node);neighbours.forEach(function(neighbour,i){var weight=graph._assoc_mat[node][neighbour];if(weight<=0){throw new Error("A node has a negative degree. Use positive weights.")}if(part[neighbour]==com){if(neighbour==node){inc+=weight}else{inc+=weight/2}}});status.internals[com]=(status.internals[com]||0)+inc})}}function __modularity(status){var links=status.total_weight;var result=0;var communities=make_set(obj_values(status.nodes_to_com));communities.forEach(function(com,i){var in_degree=status.internals[com]||0;var degree=status.degrees[com]||0;if(links>0){result=result+in_degree/links-Math.pow(degree/(2*links),2)}});return result}function __neighcom(node,graph,status){var weights={};var neighboorhood=get_neighbours_of_node(graph,node);neighboorhood.forEach(function(neighbour,i){if(neighbour!=node){var weight=graph._assoc_mat[node][neighbour]||1;var neighbourcom=status.nodes_to_com[neighbour];weights[neighbourcom]=(weights[neighbourcom]||0)+weight}});return weights}function __insert(node,com,weight,status){status.nodes_to_com[node]=+com;status.degrees[com]=(status.degrees[com]||0)+(status.gdegrees[node]||0);status.internals[com]=(status.internals[com]||0)+weight+(status.loops[node]||0)}function __remove(node,com,weight,status){status.degrees[com]=(status.degrees[com]||0)-(status.gdegrees[node]||0);status.internals[com]=(status.internals[com]||0)-weight-(status.loops[node]||0);status.nodes_to_com[node]=-1}function __renumber(dict){var count=0;var ret=clone(dict);var new_values={};var dict_keys=Object.keys(dict);dict_keys.forEach(function(key){var value=dict[key];var new_value=typeof new_values[value]=="undefined"?-1:new_values[value];if(new_value==-1){new_values[value]=count;new_value=count;count=count+1}ret[key]=new_value});return ret}function __one_level(graph,status){var modif=true,nb_pass_done=0,cur_mod=__modularity(status),new_mod=cur_mod;while(modif&&nb_pass_done!=__PASS_MAX){cur_mod=new_mod;modif=false;nb_pass_done+=1;graph.nodes.forEach(function(node,i){var com_node=status.nodes_to_com[node];var degc_totw=(status.gdegrees[node]||0)/(status.total_weight*2);var neigh_communities=__neighcom(node,graph,status);__remove(node,com_node,neigh_communities[com_node]||0,status);var best_com=com_node;var best_increase=0;var neigh_communities_entries=Object.keys(neigh_communities);neigh_communities_entries.forEach(function(com,i){var incr=neigh_communities[com]-(status.degrees[com]||0)*degc_totw;if(incr>best_increase){best_increase=incr;best_com=com}});__insert(node,best_com,neigh_communities[best_com]||0,status);if(best_com!=com_node)modif=true});new_mod=__modularity(status);if(new_mod-cur_mod<__MIN)break}}function induced_graph(partition,graph){var ret={nodes:[],edges:[],_assoc_mat:{}};var w_prec,weight;var partition_values=obj_values(partition);ret.nodes=ret.nodes.concat(make_set(partition_values));graph.edges.forEach(function(edge,i){weight=edge.weight||1;var com1=partition[edge.source];
var com2=partition[edge.target];w_prec=get_edge_weight(ret,com1,com2)||0;var new_weight=w_prec+weight;add_edge_to_graph(ret,{source:com1,target:com2,weight:new_weight})});return ret}function partition_at_level(dendogram,level){var partition=clone(dendogram[0]);for(var i=1;i<level+1;i++){Object.keys(partition).forEach(function(key,j){var node=key;var com=partition[key];partition[node]=dendogram[i][com]})}return partition}function generate_dendogram(graph,part_init){if(graph.edges.length==0){var part={};graph.nodes.forEach(function(node,i){part[node]=node});return part}var status={};init_status(original_graph,status,part_init);var mod=__modularity(status);var status_list=[];__one_level(original_graph,status);var new_mod=__modularity(status);var partition=__renumber(status.nodes_to_com);status_list.push(partition);mod=new_mod;var current_graph=induced_graph(partition,original_graph);init_status(current_graph,status);while(true){__one_level(current_graph,status);new_mod=__modularity(status);if(new_mod-mod<__MIN)break;partition=__renumber(status.nodes_to_com);status_list.push(partition);mod=new_mod;current_graph=induced_graph(partition,current_graph);init_status(current_graph,status)}return status_list}var core={};core.run=function(partitions){partition_init=partitions||partition_init;status={};dendogram=generate_dendogram(original_graph,partition_init);return this};core.countLevels=function(){return dendogram.length-1};core.getPartitions=function(level){if(level!==undefined&&(level<1||level>dendogram.length-1))throw new RangeError('Invalid argument: "level" is not between 1 and '+dendogram.length-1+" included.");return partition_at_level(dendogram,level||dendogram.length-1)};core.countPartitions=function(partitions){return 1+Math.max.apply(null,Object.keys(partitions).map(function(key){return partitions[key]}))};core.setResults=function(options){var self=this,o=options||{},communities=this.getPartitions(o.level);graph.nodes().forEach(function(node){if(typeof o.setter==="function"){self.setter=o.setter;self.setter.call(node,communities[node.id])}else if(typeof self.setter==="function"){self.setter.call(node,communities[node.id])}else{node._louvain=communities[node.id]}});return this};return core};sigma.plugins.louvain=function(graph,params){var p=params||{};var instance=jLouvain(graph,p.partitions).run();instance.setResults({level:instance.countLevels(),setter:p.setter});return instance}}).call(this);